<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TuttleOFX: TuttleOFX/libraries/tuttle/src/tuttle/host/ImageEffectNode.cpp Source File</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">TuttleOFX
   &#160;<span id="projectnumber">1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d5/dcd/ImageEffectNode_8cpp.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">TuttleOFX/libraries/tuttle/src/tuttle/host/ImageEffectNode.cpp</div>  </div>
</div>
<div class="contents">
<a href="../../d5/dcd/ImageEffectNode_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d44/ImageEffectNode_8hpp.html">ImageEffectNode.hpp</a>&quot;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &quot;<a class="code" href="../../db/db1/HostDescriptor_8hpp.html">HostDescriptor.hpp</a>&quot;</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="comment">// ofx host</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;<a class="code" href="../../d7/d38/Core_8hpp.html">tuttle/host/Core.hpp</a>&gt;</span> <span class="comment">// for core().getMemoryCache()</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;<a class="code" href="../../de/d03/ClipImage_8hpp.html">tuttle/host/attribute/ClipImage.hpp</a>&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/d37/allParams_8hpp.html">tuttle/host/attribute/allParams.hpp</a>&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;<a class="code" href="../../d3/dd5/ProcessEdgeAtTime_8hpp.html">tuttle/host/graph/ProcessEdgeAtTime.hpp</a>&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;<a class="code" href="../../de/d56/ProcessVertexData_8hpp.html">tuttle/host/graph/ProcessVertexData.hpp</a>&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/d85/ProcessVertexAtTimeData_8hpp.html">tuttle/host/graph/ProcessVertexAtTimeData.hpp</a>&gt;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/dda/OfxhUtilities_8hpp.html">tuttle/host/ofx/OfxhUtilities.hpp</a>&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;<a class="code" href="../../de/d09/OfxhBinary_8hpp.html">tuttle/host/ofx/OfxhBinary.hpp</a>&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;<a class="code" href="../../d4/d4d/OfxhMemory_8hpp.html">tuttle/host/ofx/OfxhMemory.hpp</a>&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/db7/OfxhImageEffectNode_8hpp.html">tuttle/host/ofx/OfxhImageEffectNode.hpp</a>&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;<a class="code" href="../../d6/dc4/OfxhPluginAPICache_8hpp.html">tuttle/host/ofx/OfxhPluginAPICache.hpp</a>&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;<a class="code" href="../../d7/de6/OfxhPluginCache_8hpp.html">tuttle/host/ofx/OfxhPluginCache.hpp</a>&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;<a class="code" href="../../db/d9a/OfxhHost_8hpp.html">tuttle/host/ofx/OfxhHost.hpp</a>&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;<a class="code" href="../../d4/d7f/OfxhImageEffectPlugin_8hpp.html">tuttle/host/ofx/OfxhImageEffectPlugin.hpp</a>&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;<a class="code" href="../../d9/dd6/OfxhSet_8hpp.html">tuttle/host/ofx/property/OfxhSet.hpp</a>&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;<a class="code" href="../../df/d05/OfxhClip_8hpp.html">tuttle/host/ofx/attribute/OfxhClip.hpp</a>&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="code" href="../../d1/dda/OfxhParam_8hpp.html">tuttle/host/ofx/attribute/OfxhParam.hpp</a>&gt;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="comment">// ofx</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;ofxCore.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;ofxImageEffect.h&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;boost/functional/hash.hpp&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;boost/foreach.hpp&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;boost/lexical_cast.hpp&gt;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;iomanip&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;list&gt;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="keyword">namespace </span>tuttle {
<a name="l00038"></a>00038 <span class="keyword">namespace </span>host {
<a name="l00039"></a>00039 
<a name="l00040"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ae8b50c6abfd382841367bbdbe6b7a616">00040</a> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ae8b50c6abfd382841367bbdbe6b7a616">ImageEffectNode::ImageEffectNode</a>(
<a name="l00041"></a>00041                 <a class="code" href="../../df/d5d/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectPlugin.html">tuttle::host::ofx::imageEffect::OfxhImageEffectPlugin</a>&amp; plugin,
<a name="l00042"></a>00042                 <a class="code" href="../../de/de4/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeDescriptor.html">tuttle::host::ofx::imageEffect::OfxhImageEffectNodeDescriptor</a>&amp; desc,
<a name="l00043"></a>00043                 <span class="keyword">const</span> std::string&amp; context )
<a name="l00044"></a>00044         : tuttle::host::ofx::imageEffect::OfxhImageEffectNode( plugin, desc, context, false )
<a name="l00045"></a>00045         , _defaultOutputFielding( kOfxImageFieldNone )
<a name="l00046"></a>00046 {
<a name="l00047"></a>00047         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aae3d7cf597d81416835c4eec7644d590">populate</a>();
<a name="l00048"></a>00048         <span class="comment">//      createInstanceAction();</span>
<a name="l00049"></a>00049 }
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a2b3ab8654fc529b79f18e57cb0fbca19">00051</a> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ae8b50c6abfd382841367bbdbe6b7a616">ImageEffectNode::ImageEffectNode</a>( <span class="keyword">const</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html">ImageEffectNode</a>&amp; other )
<a name="l00052"></a>00052         : <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html">INode</a>( other )
<a name="l00053"></a>00053         , tuttle::host::ofx::imageEffect::OfxhImageEffectNode( other )
<a name="l00054"></a>00054         , _defaultOutputFielding( other._defaultOutputFielding )
<a name="l00055"></a>00055 {
<a name="l00056"></a>00056         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aae3d7cf597d81416835c4eec7644d590">populate</a>();
<a name="l00057"></a>00057         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a9fca3dbea095f78c5f2a82e8b5ee4655">copyAttributesValues</a>( other ); <span class="comment">// values need to be setted before the createInstanceAction !</span>
<a name="l00058"></a>00058         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a207bf711c3ef9e4ea05538c922b46adb">createInstanceAction</a>();
<a name="l00059"></a>00059 }
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ad09bd2daab20a80afe953a2ddc7caf9b">00061</a> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ad09bd2daab20a80afe953a2ddc7caf9b">ImageEffectNode::~ImageEffectNode</a>()
<a name="l00062"></a>00062 {}
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afaf3e35571029971f45d25740a2cdd33">00064</a> <span class="keywordtype">bool</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afaf3e35571029971f45d25740a2cdd33">ImageEffectNode::operator==</a>( <span class="keyword">const</span> <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html">INode</a>&amp; other )<span class="keyword"> const</span>
<a name="l00065"></a>00065 <span class="keyword"></span>{
<a name="l00066"></a>00066         <span class="keyword">const</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html">ImageEffectNode</a>* other_ptr = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html">ImageEffectNode</a>*<span class="keyword">&gt;</span>( &amp;other );
<a name="l00067"></a>00067         <span class="keywordflow">if</span>( other_ptr == NULL )
<a name="l00068"></a>00068                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00069"></a>00069         <span class="keywordflow">return</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afaf3e35571029971f45d25740a2cdd33">operator==</a>( *other_ptr );
<a name="l00070"></a>00070 }
<a name="l00071"></a>00071 <span class="comment"></span>
<a name="l00072"></a>00072 <span class="comment">/**</span>
<a name="l00073"></a>00073 <span class="comment"> * @warning do a deep comparison</span>
<a name="l00074"></a>00074 <span class="comment"> */</span>
<a name="l00075"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#abe62ed6b65c45add9b59d0882ac01fb2">00075</a> <span class="keywordtype">bool</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afaf3e35571029971f45d25740a2cdd33">ImageEffectNode::operator==</a>( <span class="keyword">const</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html">ImageEffectNode</a>&amp; other )<span class="keyword"> const</span>
<a name="l00076"></a>00076 <span class="keyword"></span>{
<a name="l00077"></a>00077         <span class="keywordflow">return</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afaf3e35571029971f45d25740a2cdd33">ofx::imageEffect::OfxhImageEffectNode::operator==</a>( other );
<a name="l00078"></a>00078 }
<a name="l00079"></a>00079 
<a name="l00080"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ad70eb0e30914ced1899638e0378d5e8e">00080</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ad70eb0e30914ced1899638e0378d5e8e">ImageEffectNode::connect</a>( <span class="keyword">const</span> <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html">INode</a>&amp; sourceEffect, <a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html">attribute::Attribute</a>&amp; attr )
<a name="l00081"></a>00081 {
<a name="l00082"></a>00082         <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; outputClip = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( sourceEffect.<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a688840599f8cc3a6caf29d9e387b64b2">getClip</a>( kOfxImageEffectOutputClipName ) );
<a name="l00083"></a>00083         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; inputClip        = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( attr ); <span class="comment">// throw an exception if not a ClipImage attribute</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085         inputClip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a1fd6100d73eb52b577d507355e140f91">setConnectedClip</a>( outputClip );
<a name="l00086"></a>00086 }
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a105ec27508b5f705a2d61b586c1002bf">00088</a> <a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html">attribute::Attribute</a>&amp; <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a105ec27508b5f705a2d61b586c1002bf">ImageEffectNode::getSingleInputAttribute</a>()
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090         <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a568683505429967437ad5e441332e112">ofx::attribute::OfxhClipImageSet::ClipImageVector</a>&amp; clips = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a05ac31b72edc080377c2cd70fd53af84">getClipsByOrder</a>();
<a name="l00091"></a>00091         <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#aed3fb8c00e9ff5d6692c68e6d52b0fc8">ofx::attribute::OfxhClipImageSet::ClipImageMap</a>&amp; clipsMap = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#afb862c256e1b0d40b3b339ed77cbc542">getClipsByName</a>();
<a name="l00092"></a>00092         <a class="code" href="../../d1/d9d/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttribute.html">ofx::attribute::OfxhAttribute</a>* inAttr                    = NULL;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094         <span class="keywordflow">if</span>( clips.size() == 1 )
<a name="l00095"></a>00095         {
<a name="l00096"></a>00096                 inAttr = &amp;clips[0];
<a name="l00097"></a>00097         }
<a name="l00098"></a>00098         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( clips.size() &gt; 1 )
<a name="l00099"></a>00099         {
<a name="l00100"></a>00100                 <span class="keyword">const</span> ofx::attribute::OfxhClipImageSet::ClipImageMap::iterator it( clipsMap.find( kOfxSimpleSourceAttributeName ) );
<a name="l00101"></a>00101                 <span class="keywordflow">if</span>( it != clipsMap.end() )
<a name="l00102"></a>00102                 {
<a name="l00103"></a>00103                         inAttr = it-&gt;second;
<a name="l00104"></a>00104                 }
<a name="l00105"></a>00105                 <span class="keywordflow">else</span>
<a name="l00106"></a>00106                 {
<a name="l00107"></a>00107                         inAttr = &amp;clips[0];
<a name="l00108"></a>00108                 }
<a name="l00109"></a>00109         }
<a name="l00110"></a>00110         <span class="keywordflow">else</span> <span class="comment">// if( inClips.empty() )</span>
<a name="l00111"></a>00111         {
<a name="l00112"></a>00112                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d6/d07/structtuttle_1_1exception_1_1Logic.html" title="Other exceptions.">exception::Logic</a>()
<a name="l00113"></a>00113                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#aeda7b771c5f326f3a5b8b2682ef7953d" title="Like a stringstream but using &quot;operator+&quot; instead of &quot;operator&lt;&lt;&quot;. Use a stringstream internally...">exception::user</a>( <span class="stringliteral">&quot;No source clip.&quot;</span> ) );
<a name="l00114"></a>00114         }
<a name="l00115"></a>00115         <span class="keywordflow">return</span> <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *inAttr );
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="comment">// get a new clip instance</span>
<a name="l00119"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#acc8c6f1b574b74adb44d551861b397a1">00119</a> <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">tuttle::host::ofx::attribute::OfxhClipImage</a>* <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#acc8c6f1b574b74adb44d551861b397a1" title="make a clip">ImageEffectNode::newClipImage</a>( <span class="keyword">const</span> <a class="code" href="../../d3/d24/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageDescriptor.html">tuttle::host::ofx::attribute::OfxhClipImageDescriptor</a>&amp; descriptor )
<a name="l00120"></a>00120 {
<a name="l00121"></a>00121         <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>( *<span class="keyword">this</span>, descriptor );
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#abc920f02b035f81b1c36e332b446844c">00124</a> std::size_t <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#abc920f02b035f81b1c36e332b446844c">ImageEffectNode::getLocalHashAtTime</a>( <span class="keyword">const</span> OfxTime <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> )<span class="keyword"> const</span>
<a name="l00125"></a>00125 <span class="keyword"></span>{
<a name="l00126"></a>00126         std::size_t seed = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a75e1d88efaa61e052b5201ff89d23d0c" title="return the plugin this instance was created with">getPlugin</a>().<a class="code" href="../../d3/d43/classtuttle_1_1host_1_1ofx_1_1OfxhPluginDesc.html#a566a23e6ed45620585a67d52e9ce285b">getHash</a>();
<a name="l00127"></a>00127 
<a name="l00128"></a>00128         <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#af43700e6d6a15807a5bb2a83cd78cbe7">isFrameVarying</a>() )
<a name="l00129"></a>00129         {
<a name="l00130"></a>00130                 boost::hash_combine( seed, time );
<a name="l00131"></a>00131         }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133         boost::hash_combine( seed, <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a86ee428261b8d482e7b8b00b4164923e">getParamSet</a>().<a class="code" href="../../d0/d5e/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSet.html#a90837d00a573fb479d5fb895a9f6baa8">getHashAtTime</a>(time) );
<a name="l00134"></a>00134 
<a name="l00135"></a>00135         <span class="keywordflow">return</span> seed;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 <span class="comment"></span>
<a name="l00138"></a>00138 <span class="comment">/**</span>
<a name="l00139"></a>00139 <span class="comment"> * @return 1 to abort processing</span>
<a name="l00140"></a>00140 <span class="comment"> */</span>
<a name="l00141"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a2dc7cf5bface19974b17521226fe53e1">00141</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a2dc7cf5bface19974b17521226fe53e1">ImageEffectNode::abort</a>()
<a name="l00142"></a>00142 {
<a name="l00143"></a>00143         <span class="keywordflow">return</span> 0;
<a name="l00144"></a>00144 }
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ad4392ec4abda9be19e7a9ee86d2f0424">00146</a> <a class="code" href="../../d1/da1/classtuttle_1_1host_1_1ofx_1_1OfxhMemory.html">ofx::OfxhMemory</a>* <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ad4392ec4abda9be19e7a9ee86d2f0424">ImageEffectNode::newMemoryInstance</a>( <span class="keywordtype">size_t</span> nBytes )
<a name="l00147"></a>00147 {
<a name="l00148"></a>00148         <a class="code" href="../../d1/da1/classtuttle_1_1host_1_1ofx_1_1OfxhMemory.html">ofx::OfxhMemory</a>* instance = <span class="keyword">new</span> <a class="code" href="../../d1/da1/classtuttle_1_1host_1_1ofx_1_1OfxhMemory.html">ofx::OfxhMemory</a>();
<a name="l00149"></a>00149 
<a name="l00150"></a>00150         instance-&gt;<a class="code" href="../../d1/da1/classtuttle_1_1host_1_1ofx_1_1OfxhMemory.html#a6a3f63e2dc620370a30d82b5af02b6aa">alloc</a>( nBytes );
<a name="l00151"></a>00151         <span class="keywordflow">return</span> instance;
<a name="l00152"></a>00152 }
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="comment">// vmessage</span>
<a name="l00155"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a7bd4fe4b85892c7eeef7278a3765834e">00155</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a7bd4fe4b85892c7eeef7278a3765834e" title="vmessage">ImageEffectNode::vmessage</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* type,
<a name="l00156"></a>00156                                 <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keywordtype">id</span>,
<a name="l00157"></a>00157                                 <span class="keyword">const</span> <span class="keywordtype">char</span>* format,
<a name="l00158"></a>00158                                 va_list     args ) <span class="keyword">const</span> <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00159"></a>00159 {
<a name="l00160"></a>00160         vprintf( format, args );
<a name="l00161"></a>00161 }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">// get the project size in CANONICAL pixels, so PAL SD return 768, 576</span>
<a name="l00164"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afb17f9e50392671aebc18be7d900242a">00164</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afb17f9e50392671aebc18be7d900242a">ImageEffectNode::getProjectSize</a>( <span class="keywordtype">double</span>&amp; xSize, <span class="keywordtype">double</span>&amp; ySize )<span class="keyword"> const</span>
<a name="l00165"></a>00165 <span class="keyword"></span>{
<a name="l00166"></a>00166         <span class="keywordflow">if</span> (<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a05519713512a15a7cb063b0042fd5b47" title="link to external datas at each time">_dataAtTime</a>.size() == 0 )
<a name="l00167"></a>00167         {
<a name="l00168"></a>00168                 xSize = 720;
<a name="l00169"></a>00169                 ySize = 576;
<a name="l00170"></a>00170         }
<a name="l00171"></a>00171         <span class="keywordflow">else</span>
<a name="l00172"></a>00172         {
<a name="l00173"></a>00173                 OfxRectD rod = <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a63a18d20ba69ba7350cbfb679f774695">getLastData</a>().<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a107638e0a40896890c1290e3c0d733aa">_renderRoD</a>;
<a name="l00174"></a>00174                 xSize = rod.x2 - rod.x1;
<a name="l00175"></a>00175                 ySize = rod.y2 - rod.y1;
<a name="l00176"></a>00176                 <span class="keywordflow">if</span> (xSize &lt; 1 || ySize &lt; 1)
<a name="l00177"></a>00177                 {
<a name="l00178"></a>00178                         xSize = 720;
<a name="l00179"></a>00179                         ySize = 576;
<a name="l00180"></a>00180                 }
<a name="l00181"></a>00181         }
<a name="l00182"></a>00182 }
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">// get the project offset in CANONICAL pixels, we are at 0,0</span>
<a name="l00185"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a405103d2e5c5a420bffc28d1580e1406">00185</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a405103d2e5c5a420bffc28d1580e1406">ImageEffectNode::getProjectOffset</a>( <span class="keywordtype">double</span>&amp; xOffset, <span class="keywordtype">double</span>&amp; yOffset )<span class="keyword"> const</span>
<a name="l00186"></a>00186 <span class="keyword"></span>{
<a name="l00187"></a>00187         xOffset = 0;
<a name="l00188"></a>00188         yOffset = 0;
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">// get the project extent in CANONICAL pixels, so PAL SD return 768, 576</span>
<a name="l00192"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a095ba80a28bbf33a8720f100b915973d">00192</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a095ba80a28bbf33a8720f100b915973d">ImageEffectNode::getProjectExtent</a>( <span class="keywordtype">double</span>&amp; xSize, <span class="keywordtype">double</span>&amp; ySize )<span class="keyword"> const</span>
<a name="l00193"></a>00193 <span class="keyword"></span>{
<a name="l00194"></a>00194         <span class="keywordflow">if</span> (<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a05519713512a15a7cb063b0042fd5b47" title="link to external datas at each time">_dataAtTime</a>.size() == 0 )
<a name="l00195"></a>00195         {
<a name="l00196"></a>00196                 xSize = 720;
<a name="l00197"></a>00197                 ySize = 576;
<a name="l00198"></a>00198         }
<a name="l00199"></a>00199         <span class="keywordflow">else</span>
<a name="l00200"></a>00200         {
<a name="l00201"></a>00201                 OfxRectD rod = <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a63a18d20ba69ba7350cbfb679f774695">getLastData</a>().<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a107638e0a40896890c1290e3c0d733aa">_renderRoD</a>;
<a name="l00202"></a>00202                 xSize = rod.x2 - rod.x1;
<a name="l00203"></a>00203                 ySize = rod.y2 - rod.y1;
<a name="l00204"></a>00204                 <span class="keywordflow">if</span> (xSize &lt; 1 || ySize &lt; 1)
<a name="l00205"></a>00205                 {
<a name="l00206"></a>00206                         xSize = 720;
<a name="l00207"></a>00207                         ySize = 576;
<a name="l00208"></a>00208                 }
<a name="l00209"></a>00209         }
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="comment">// get the PAR, SD PAL is 768/720=1.0666</span>
<a name="l00213"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a2b7428697276d78bb57b77c70a1f2677">00213</a> <span class="keywordtype">double</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a2b7428697276d78bb57b77c70a1f2677">ImageEffectNode::getProjectPixelAspectRatio</a>()<span class="keyword"> const</span>
<a name="l00214"></a>00214 <span class="keyword"></span>{
<a name="l00215"></a>00215         <span class="keywordflow">return</span> 1.0;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment">// we are only 25 frames</span>
<a name="l00219"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ac8c06592affb7bea832c9dd9c88f713a">00219</a> <span class="keywordtype">double</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ac8c06592affb7bea832c9dd9c88f713a">ImageEffectNode::getEffectDuration</a>()<span class="keyword"> const</span>
<a name="l00220"></a>00220 <span class="keyword"></span>{
<a name="l00221"></a>00221         <span class="keywordflow">return</span> 99999.0;
<a name="l00222"></a>00222 }
<a name="l00223"></a>00223 <span class="comment"></span>
<a name="l00224"></a>00224 <span class="comment">/// This is called whenever a param is changed by the plugin so that</span>
<a name="l00225"></a>00225 <span class="comment">/// the recursive instanceChangedAction will be fed the correct frame</span>
<a name="l00226"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aa2eb0c85a8e05d725d773cd1d0f9070e">00226</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aa2eb0c85a8e05d725d773cd1d0f9070e">ImageEffectNode::getFrameRecursive</a>()<span class="keyword"> const</span>
<a name="l00227"></a>00227 <span class="keyword"></span>{
<a name="l00228"></a>00228         <span class="keywordflow">return</span> 0.0;
<a name="l00229"></a>00229 }
<a name="l00230"></a>00230 <span class="comment"></span>
<a name="l00231"></a>00231 <span class="comment">/// This is called whenever a param is changed by the plugin so that</span>
<a name="l00232"></a>00232 <span class="comment">/// the recursive instanceChangedAction will be fed the correct</span>
<a name="l00233"></a>00233 <span class="comment">/// renderScale</span>
<a name="l00234"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a0cfd54a724da06bd10ad3968a1391e46">00234</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a0cfd54a724da06bd10ad3968a1391e46">ImageEffectNode::getRenderScaleRecursive</a>( <span class="keywordtype">double</span>&amp; x, <span class="keywordtype">double</span>&amp; y )<span class="keyword"> const</span>
<a name="l00235"></a>00235 <span class="keyword"></span>{
<a name="l00236"></a>00236         x = y = 1.0;
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 <span class="comment"></span>
<a name="l00239"></a>00239 <span class="comment">/**</span>
<a name="l00240"></a>00240 <span class="comment"> * The pixel components type of the current project</span>
<a name="l00241"></a>00241 <span class="comment"> * @todo tuttle: to remove in the future.... size, pixelType, BitDepth, etc... must be locally defined</span>
<a name="l00242"></a>00242 <span class="comment"> */</span>
<a name="l00243"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a4ce5d821aceef126351c3ccbea0343f5">00243</a> <span class="keyword">const</span> std::string <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a4ce5d821aceef126351c3ccbea0343f5">ImageEffectNode::getProjectPixelComponentsType</a>()<span class="keyword"> const</span>
<a name="l00244"></a>00244 <span class="keyword"></span>{
<a name="l00245"></a>00245         <span class="keywordflow">return</span> kOfxImageComponentRGBA;
<a name="l00246"></a>00246 }
<a name="l00247"></a>00247 <span class="comment"></span>
<a name="l00248"></a>00248 <span class="comment">/**</span>
<a name="l00249"></a>00249 <span class="comment"> * The pixel bit depth of the current project (host work in float)</span>
<a name="l00250"></a>00250 <span class="comment"> * @todo tuttle: to remove in the future.... size, pixelType, BitDepth, etc... must be locally defined</span>
<a name="l00251"></a>00251 <span class="comment"> */</span>
<a name="l00252"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ab39c20a85214b042e9d33bf5e931e55a">00252</a> <span class="keyword">const</span> std::string <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ab39c20a85214b042e9d33bf5e931e55a">ImageEffectNode::getProjectBitDepth</a>()<span class="keyword"> const</span>
<a name="l00253"></a>00253 <span class="keyword"></span>{
<a name="l00254"></a>00254         <span class="comment">//return kOfxBitDepthByte;</span>
<a name="l00255"></a>00255         <span class="keywordflow">return</span> kOfxBitDepthFloat;
<a name="l00256"></a>00256 }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 <span class="comment">// make a parameter instance</span>
<a name="l00259"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ac054a2715af245232d0597a8f1dcfb71">00259</a> <a class="code" href="../../d1/dfc/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParam.html" title="plugin parameter instance">ofx::attribute::OfxhParam</a>* <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ac054a2715af245232d0597a8f1dcfb71" title="Create a parameter instance.">ImageEffectNode::newParam</a>( <span class="keyword">const</span> <a class="code" href="../../dd/d39/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamDescriptor.html" title="the Descriptor of a plugin parameter">ofx::attribute::OfxhParamDescriptor</a>&amp; descriptor ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00260"></a>00260 {
<a name="l00261"></a>00261         <span class="keyword">const</span> std::string name = descriptor.getName();
<a name="l00262"></a>00262         <a class="code" href="../../d1/dfc/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParam.html" title="plugin parameter instance">ofx::attribute::OfxhParam</a>* param = NULL;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264         <span class="keywordflow">try</span>
<a name="l00265"></a>00265         {
<a name="l00266"></a>00266                 <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeString )
<a name="l00267"></a>00267                         param = <span class="keyword">new</span> <a class="code" href="../../d5/d24/classtuttle_1_1host_1_1attribute_1_1ParamString.html">attribute::ParamString</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00268"></a>00268                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeInteger )
<a name="l00269"></a>00269                         param = <span class="keyword">new</span> <a class="code" href="../../d7/d9e/classtuttle_1_1host_1_1attribute_1_1ParamInteger.html">attribute::ParamInteger</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00270"></a>00270                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeDouble )
<a name="l00271"></a>00271                         param = <span class="keyword">new</span> <a class="code" href="../../d7/d90/classtuttle_1_1host_1_1attribute_1_1ParamDouble.html">attribute::ParamDouble</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00272"></a>00272                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeBoolean )
<a name="l00273"></a>00273                         param = <span class="keyword">new</span> <a class="code" href="../../d9/d34/classtuttle_1_1host_1_1attribute_1_1ParamBoolean.html">attribute::ParamBoolean</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00274"></a>00274                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeChoice )
<a name="l00275"></a>00275                         param = <span class="keyword">new</span> <a class="code" href="../../d9/dc9/classtuttle_1_1host_1_1attribute_1_1ParamChoice.html">attribute::ParamChoice</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00276"></a>00276                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeRGBA )
<a name="l00277"></a>00277                         param = <span class="keyword">new</span> <a class="code" href="../../de/d25/classtuttle_1_1host_1_1attribute_1_1ParamRGBA.html">attribute::ParamRGBA</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00278"></a>00278                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeRGB )
<a name="l00279"></a>00279                         param = <span class="keyword">new</span> <a class="code" href="../../d2/d1d/classtuttle_1_1host_1_1attribute_1_1ParamRGB.html">attribute::ParamRGB</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00280"></a>00280                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeDouble2D )
<a name="l00281"></a>00281                         param = <span class="keyword">new</span> <a class="code" href="../../d2/df6/classtuttle_1_1host_1_1attribute_1_1ParamDouble2D.html">attribute::ParamDouble2D</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00282"></a>00282                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeDouble3D )
<a name="l00283"></a>00283                         param = <span class="keyword">new</span> <a class="code" href="../../d3/dda/classtuttle_1_1host_1_1attribute_1_1ParamDouble3D.html">attribute::ParamDouble3D</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00284"></a>00284                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeInteger2D )
<a name="l00285"></a>00285                         param = <span class="keyword">new</span> <a class="code" href="../../db/dc4/classtuttle_1_1host_1_1attribute_1_1ParamInteger2D.html">attribute::ParamInteger2D</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00286"></a>00286                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeInteger3D )
<a name="l00287"></a>00287                         param = <span class="keyword">new</span> <a class="code" href="../../d6/d09/classtuttle_1_1host_1_1attribute_1_1ParamInteger3D.html">attribute::ParamInteger3D</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00288"></a>00288                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypePushButton )
<a name="l00289"></a>00289                         param = <span class="keyword">new</span> <a class="code" href="../../d3/d00/classtuttle_1_1host_1_1attribute_1_1ParamPushButton.html">attribute::ParamPushButton</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00290"></a>00290                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeGroup )
<a name="l00291"></a>00291                         param = <span class="keyword">new</span> <a class="code" href="../../db/d8b/classtuttle_1_1host_1_1attribute_1_1ParamGroup.html">attribute::ParamGroup</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00292"></a>00292                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypePage )
<a name="l00293"></a>00293                         param = <span class="keyword">new</span> <a class="code" href="../../d3/d9f/classtuttle_1_1host_1_1attribute_1_1ParamPage.html">attribute::ParamPage</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00294"></a>00294                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( descriptor.getParamType() == kOfxParamTypeCustom )
<a name="l00295"></a>00295                         param = <span class="keyword">new</span> <a class="code" href="../../dc/d83/classtuttle_1_1host_1_1attribute_1_1ParamCustom.html">attribute::ParamCustom</a>( *<span class="keyword">this</span>, name,  descriptor );
<a name="l00296"></a>00296                 <span class="keywordflow">else</span>
<a name="l00297"></a>00297                 {
<a name="l00298"></a>00298                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/dcb/structtuttle_1_1exception_1_1Failed.html" title="Status error code for a failed operation.">exception::Failed</a>()
<a name="l00299"></a>00299                             &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#aeda7b771c5f326f3a5b8b2682ef7953d" title="Like a stringstream but using &quot;operator+&quot; instead of &quot;operator&lt;&lt;&quot;. Use a stringstream internally...">exception::user</a>() + <span class="stringliteral">&quot;Can&#39;t create param &quot;</span> + <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>( name ) + <span class="stringliteral">&quot; instance from param descriptor, type not recognized.&quot;</span> );
<a name="l00300"></a>00300                 }
<a name="l00301"></a>00301                 this-&gt;addParam( param );
<a name="l00302"></a>00302         }
<a name="l00303"></a>00303         <span class="keywordflow">catch</span>( <a class="code" href="../../de/dd4/structtuttle_1_1exception_1_1Common.html" title="Common exception for all tuttle plugin exceptions.">exception::Common</a>&amp; e )
<a name="l00304"></a>00304         {
<a name="l00305"></a>00305                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">ofx::OfxhException</a>( *boost::get_error_info&lt;exception::ofxStatus&gt;( e ),
<a name="l00306"></a>00306                                                            boost::diagnostic_information( e ) ) );
<a name="l00307"></a>00307         }
<a name="l00308"></a>00308         <span class="keywordflow">catch</span>(... )
<a name="l00309"></a>00309         {
<a name="l00310"></a>00310                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">ofx::OfxhException</a>( kOfxStatErrUnknown,
<a name="l00311"></a>00311                                                            boost::current_exception_diagnostic_information() ) );
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313         <span class="keywordflow">return</span> param;
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a742c4bc274f63531dcf210bd6faea418">00316</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a742c4bc274f63531dcf210bd6faea418">ImageEffectNode::editBegin</a>( <span class="keyword">const</span> std::string&amp; name ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00317"></a>00317 {
<a name="l00318"></a>00318         <span class="comment">//BOOST_THROW_EXCEPTION( ofx::OfxhException( kOfxStatErrMissingHostFeature ) );</span>
<a name="l00319"></a>00319 }
<a name="l00320"></a>00320 
<a name="l00321"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a464d83fd0c777df551eb8dface468ef1">00321</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a464d83fd0c777df551eb8dface468ef1">ImageEffectNode::editEnd</a>() <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00322"></a>00322 {
<a name="l00323"></a>00323         <span class="comment">//BOOST_THROW_EXCEPTION( ofx::OfxhException( kOfxStatErrMissingHostFeature ) );</span>
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 <span class="comment"></span>
<a name="l00326"></a>00326 <span class="comment">/// Start doing progress.</span>
<a name="l00327"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a893f577b1a85870db8aecc7f847a510b">00327</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a893f577b1a85870db8aecc7f847a510b" title="Start doing progress.">ImageEffectNode::progressStart</a>( <span class="keyword">const</span> std::string&amp; message )
<a name="l00328"></a>00328 {
<a name="l00329"></a>00329         <span class="comment">//TUTTLE_LOG_TRACE( message );</span>
<a name="l00330"></a>00330         <span class="keywordflow">if</span>( !( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aa03f8fc16178df3a44148844c2e91ed1" title="return the context this instance was created with">getContext</a>() == kOfxImageEffectContextReader ) &amp;&amp; !( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aa03f8fc16178df3a44148844c2e91ed1" title="return the context this instance was created with">getContext</a>() == kOfxImageEffectContextWriter ) )
<a name="l00331"></a>00331                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a9582d48e640a62b16695202914edcaaa">TUTTLE_LOG_INFO</a>( std::left &lt;&lt; <span class="stringliteral">&quot;       &quot;</span> &lt;&lt; <a class="code" href="../../da/d3b/classtuttle_1_1common_1_1Color.html#a63fe1071e7b4cbcdfe8822052f793ec5">common::Color::get</a>()-&gt;_green &lt;&lt; std::setw( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a2a92590f9a7748f3e2fcde5362efff9e">TUTTLE_LOG_PLUGIN_NAME_WIDTH</a> ) &lt;&lt; <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>() &lt;&lt; <a class="code" href="../../da/d3b/classtuttle_1_1common_1_1Color.html#a63fe1071e7b4cbcdfe8822052f793ec5">common::Color::get</a>()-&gt;_std );
<a name="l00332"></a>00332 }
<a name="l00333"></a>00333 <span class="comment"></span>
<a name="l00334"></a>00334 <span class="comment">/// finish yer progress</span>
<a name="l00335"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aadf46e5604d6dd9d8e56d4680d154b40">00335</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aadf46e5604d6dd9d8e56d4680d154b40" title="finish yer progress">ImageEffectNode::progressEnd</a>()
<a name="l00336"></a>00336 {
<a name="l00337"></a>00337         <span class="comment">//std::cout &lt;&lt; std::endl;</span>
<a name="l00338"></a>00338 }
<a name="l00339"></a>00339 <span class="comment"></span>
<a name="l00340"></a>00340 <span class="comment">/// set the progress to some level of completion,</span>
<a name="l00341"></a>00341 <span class="comment">/// returns true if you should abandon processing, false to continue</span>
<a name="l00342"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afa7514b52625468c01db1ffa10b45e6c">00342</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afa7514b52625468c01db1ffa10b45e6c">ImageEffectNode::progressUpdate</a>( <span class="keyword">const</span> <span class="keywordtype">double</span> progress )
<a name="l00343"></a>00343 {
<a name="l00344"></a>00344         <span class="comment">/*</span>
<a name="l00345"></a>00345 <span class="comment">        if( ( getContext() == kOfxImageEffectContextReader ) || ( getContext() == kOfxImageEffectContextWriter ) )</span>
<a name="l00346"></a>00346 <span class="comment">                TUTTLE_LOG_INFO( &quot;\r&quot; &lt;&lt; common::Color::get()-&gt;_std &lt;&lt; &quot;[&quot; &lt;&lt; std::right &lt;&lt; std::setw(3) &lt;&lt; int(progress * 100) &lt;&lt; &quot;%] &quot; &lt;&lt; &quot; &quot; &lt;&lt; std::left &lt;&lt; std::flush );</span>
<a name="l00347"></a>00347 <span class="comment">        else</span>
<a name="l00348"></a>00348 <span class="comment">                TUTTLE_LOG_INFO( &quot;\r&quot; &lt;&lt; common::Color::get()-&gt;_std &lt;&lt; &quot;[&quot; &lt;&lt; std::right &lt;&lt; std::setw(3) &lt;&lt; int(progress * 100) &lt;&lt; &quot;%] &quot; &lt;&lt; std::left &lt;&lt; common::Color::get()-&gt;_green &lt;&lt; getName() &lt;&lt; common::Color::get()-&gt;_std &lt;&lt; std::flush );</span>
<a name="l00349"></a>00349 <span class="comment">                */</span>
<a name="l00350"></a>00350         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 <span class="comment"></span>
<a name="l00353"></a>00353 <span class="comment">/// get the current time on the timeline. This is not necessarily the same</span>
<a name="l00354"></a>00354 <span class="comment">/// time as being passed to an action (eg render)</span>
<a name="l00355"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a1f48459ca4d1d24243434cb02e34fe41">00355</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a1f48459ca4d1d24243434cb02e34fe41">ImageEffectNode::timelineGetTime</a>()
<a name="l00356"></a>00356 {
<a name="l00357"></a>00357         <span class="keywordflow">return</span> 0;
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 <span class="comment"></span>
<a name="l00360"></a>00360 <span class="comment">/// set the timeline to a specific time</span>
<a name="l00361"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a1de6b6ed3dad79b35c7138668d57df07">00361</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a1de6b6ed3dad79b35c7138668d57df07" title="set the timeline to a specific time">ImageEffectNode::timelineGotoTime</a>( <span class="keywordtype">double</span> t )
<a name="l00362"></a>00362 {}
<a name="l00363"></a>00363 <span class="comment"></span>
<a name="l00364"></a>00364 <span class="comment">/// get the first and last times available on the effect&#39;s timeline</span>
<a name="l00365"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a4c5bd2fb39ce00745c3f6a1d28f8b5da">00365</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a4c5bd2fb39ce00745c3f6a1d28f8b5da" title="get the first and last times available on the effect&#39;s timeline">ImageEffectNode::timelineGetBounds</a>( <span class="keywordtype">double</span>&amp; t1, <span class="keywordtype">double</span>&amp; t2 )
<a name="l00366"></a>00366 {
<a name="l00367"></a>00367         t1 = 0;
<a name="l00368"></a>00368         t2 = 99999;
<a name="l00369"></a>00369 }
<a name="l00370"></a>00370 <span class="comment"></span>
<a name="l00371"></a>00371 <span class="comment">/// override to get frame range of the effect</span>
<a name="l00372"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a50b0928ab03852b0e4e071b8dab562f1">00372</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a50b0928ab03852b0e4e071b8dab562f1" title="override to get frame range of the effect">ImageEffectNode::beginSequenceRenderAction</a>( OfxTime   startFrame,
<a name="l00373"></a>00373                                          OfxTime   endFrame,
<a name="l00374"></a>00374                                          <span class="keywordtype">double</span>    step,
<a name="l00375"></a>00375                                          <span class="keywordtype">bool</span>      interactive,
<a name="l00376"></a>00376                                          OfxPointD renderScale ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00377"></a>00377 {
<a name="l00378"></a>00378         OfxhImageEffectNode::beginSequenceRenderAction( startFrame, endFrame, step, interactive, renderScale );
<a name="l00379"></a>00379 }
<a name="l00380"></a>00380 
<a name="l00381"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#acbd4eaad456719e0778d8e0537182e2b">00381</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#acbd4eaad456719e0778d8e0537182e2b">ImageEffectNode::checkClipsConnected</a>()<span class="keyword"> const</span>
<a name="l00382"></a>00382 <span class="keyword"></span>{
<a name="l00383"></a>00383         <span class="keywordflow">for</span>( ClipImageMap::const_iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00384"></a>00384              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00385"></a>00385              ++it )
<a name="l00386"></a>00386         {
<a name="l00387"></a>00387                 <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00388"></a>00388                 <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; !clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() &amp;&amp; !clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#ae2d0e1d324b04f67a5a47fda7fcc5e89" title="is the clip optional">isOptional</a>() ) <span class="comment">// one non optional input clip is unconnected</span>
<a name="l00389"></a>00389                 {
<a name="l00390"></a>00390                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d6/d07/structtuttle_1_1exception_1_1Logic.html" title="Other exceptions.">exception::Logic</a>()
<a name="l00391"></a>00391                             &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#aeda7b771c5f326f3a5b8b2682ef7953d" title="Like a stringstream but using &quot;operator+&quot; instead of &quot;operator&lt;&lt;&quot;. Use a stringstream internally...">exception::user</a>( <span class="stringliteral">&quot;A non optional clip is unconnected ! (&quot;</span> + clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() + <span class="stringliteral">&quot;)&quot;</span> ) );
<a name="l00392"></a>00392                 }
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394 }
<a name="l00395"></a>00395 
<a name="l00396"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#af893e51daad02d0c441f0dc9fcac0128">00396</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#af893e51daad02d0c441f0dc9fcac0128">ImageEffectNode::initComponents</a>()
<a name="l00397"></a>00397 {
<a name="l00398"></a>00398         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; outputClip    = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a30a35130c57b2ae9c59700a602e8af6d">getOutputClip</a>() );
<a name="l00399"></a>00399         <span class="comment">//bool inputClipsFound                = false;</span>
<a name="l00400"></a>00400         std::string mostChromaticComponents = kOfxImageComponentNone;
<a name="l00401"></a>00401 
<a name="l00402"></a>00402         <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00403"></a>00403              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00404"></a>00404              ++it )
<a name="l00405"></a>00405         {
<a name="l00406"></a>00406                 <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00407"></a>00407                 <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00408"></a>00408                 {
<a name="l00409"></a>00409                         <span class="comment">//inputClipsFound = true;</span>
<a name="l00410"></a>00410                         <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00411"></a>00411                         mostChromaticComponents = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#afc6a4857258c3423593779b3c7cc0a1b">findMostChromaticComponents</a>( linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a70eb90732a88e79264ba4db8967d1fe4">getComponentsString</a>(), mostChromaticComponents );
<a name="l00412"></a>00412                 }
<a name="l00413"></a>00413         }
<a name="l00414"></a>00414         <span class="comment">// components</span>
<a name="l00415"></a>00415         <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00416"></a>00416              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00417"></a>00417              ++it )
<a name="l00418"></a>00418         {
<a name="l00419"></a>00419                 <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00420"></a>00420                 <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00421"></a>00421                 {
<a name="l00422"></a>00422                         <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00423"></a>00423                         <span class="keywordflow">if</span>( clip.<a class="code" href="../../d6/df4/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageAccessor.html#aafb356368402b1f78f27c30ba8afb8a9" title="is the given component supported">isSupportedComponent</a>( mostChromaticComponents ) )
<a name="l00424"></a>00424                                 clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#accdfd234e2813de1255a64a65bccdb47">setComponentsStringIfNotModifiedByPlugin</a>( linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a70eb90732a88e79264ba4db8967d1fe4">getComponentsString</a>() );
<a name="l00425"></a>00425                 }
<a name="l00426"></a>00426         }
<a name="l00427"></a>00427         <span class="keywordflow">if</span>( outputClip.<a class="code" href="../../d6/df4/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageAccessor.html#aafb356368402b1f78f27c30ba8afb8a9" title="is the given component supported">isSupportedComponent</a>( mostChromaticComponents ) )
<a name="l00428"></a>00428                 outputClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#accdfd234e2813de1255a64a65bccdb47">setComponentsStringIfNotModifiedByPlugin</a>( mostChromaticComponents );
<a name="l00429"></a>00429 }
<a name="l00430"></a>00430 <span class="comment"></span>
<a name="l00431"></a>00431 <span class="comment">/// @todo multiple PAR</span>
<a name="l00432"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ad8e2edff3eb5e81ce61cb6c4cfb58515">00432</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ad8e2edff3eb5e81ce61cb6c4cfb58515">ImageEffectNode::initInputClipsPixelAspectRatio</a>()
<a name="l00433"></a>00433 {
<a name="l00434"></a>00434         std::set&lt;double&gt; inputPARs;
<a name="l00435"></a>00435 <span class="comment">//      if( supportsMultipleClipPARs() )</span>
<a name="l00436"></a>00436         {
<a name="l00437"></a>00437                 <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00438"></a>00438                          it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00439"></a>00439                          ++it )
<a name="l00440"></a>00440                 {
<a name="l00441"></a>00441                         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00442"></a>00442                         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Clip] &quot;</span> &lt;&lt; clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a114c73991a9ae0477e12f9ce096ee2db">getName</a>() );
<a name="l00443"></a>00443                         <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00444"></a>00444                         {
<a name="l00445"></a>00445                                 <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00446"></a>00446                                 <span class="keyword">const</span> <span class="keywordtype">double</span> par = linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa19baad5f5233a353400fb7b9a630d8e">getPixelAspectRatio</a>();
<a name="l00447"></a>00447                                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Clip] &quot;</span> &lt;&lt; linkClip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a114c73991a9ae0477e12f9ce096ee2db">getName</a>() &lt;&lt; <span class="stringliteral">&quot;, pixel aspect ratio = &quot;</span> &lt;&lt; par );
<a name="l00448"></a>00448                                 clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a287d29798be183b39be3257c6549cde0">setPixelAspectRatio</a>( par, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a68bf16e0306494ab1e18f077ebde33b4a9e91cea1eba8824616a9d9abd01d8100">ofx::property::eModifiedByHost</a> );
<a name="l00449"></a>00449                                 inputPARs.insert( par );
<a name="l00450"></a>00450                         }
<a name="l00451"></a>00451                 }
<a name="l00452"></a>00452         }
<a name="l00453"></a>00453 <span class="comment">//      else</span>
<a name="l00454"></a>00454 <span class="comment">//      {</span>
<a name="l00455"></a>00455 <span class="comment">//              // @todo The plugin doesn&#39;t support PAR, the host should do the conversions!</span>
<a name="l00456"></a>00456 <span class="comment">//              // http://openfx.sourceforge.net/Documentation/1.3/ofxProgrammingReference.html#ImageEffectsPixelAspectRatios</span>
<a name="l00457"></a>00457 <span class="comment">//              // If a plugin does not accept clips of differing PARs, then the host must resample all images fed to that effect to agree with the output&#39;s PAR.</span>
<a name="l00458"></a>00458 <span class="comment">//              // If a plugin does accept clips of differing PARs, it will need to specify the output clip&#39;s PAR in the kOfxImageEffectActionGetClipPreferences action.</span>
<a name="l00459"></a>00459 <span class="comment">//              </span>
<a name="l00460"></a>00460 <span class="comment">//              // Convert images here ? Or introduce convert nodes into the ProcessGraph?</span>
<a name="l00461"></a>00461 <span class="comment">//              BOOST_ASSERT(false);</span>
<a name="l00462"></a>00462 <span class="comment">//      }</span>
<a name="l00463"></a>00463         
<a name="l00464"></a>00464         <span class="comment">// Not supported yet. So fail in debug,</span>
<a name="l00465"></a>00465         <span class="comment">// and process with a wrong pixel aspect ratio in release.</span>
<a name="l00466"></a>00466         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Clip] support Multiple clip PAR = &quot;</span> &lt;&lt; <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a795a343b44b2d83e17862594db9a30aa" title="does the effect support multiple clip pixel aspect ratios">supportsMultipleClipPARs</a>() );
<a name="l00467"></a>00467         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Clip] number of clips = &quot;</span> &lt;&lt; <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#acc3b8b9873b6502026fa57dcc7c2c062">getNbClips</a>() );
<a name="l00468"></a>00468         BOOST_ASSERT( inputPARs.size() &lt;= 1 || <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a795a343b44b2d83e17862594db9a30aa" title="does the effect support multiple clip pixel aspect ratios">supportsMultipleClipPARs</a>() || <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#acc3b8b9873b6502026fa57dcc7c2c062">getNbClips</a>() &lt;= 2 );
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 
<a name="l00471"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ada343ab81342defb53a4a382e92c3c62">00471</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ada343ab81342defb53a4a382e92c3c62">ImageEffectNode::initInputClipsFps</a>()
<a name="l00472"></a>00472 {
<a name="l00473"></a>00473         <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00474"></a>00474              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00475"></a>00475              ++it )
<a name="l00476"></a>00476         {
<a name="l00477"></a>00477                 <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00478"></a>00478                 <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00479"></a>00479                 {
<a name="l00480"></a>00480                         <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00481"></a>00481                         clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a0e3ed972ba6a756e1e0ad450e21b8e43">setFrameRate</a>( linkClip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a9b17957ef086770514ad48e942940757" title="Frame Rate The frame rate of a clip or instance&#39;s project.">getFrameRate</a>() );
<a name="l00482"></a>00482                 }
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484 }
<a name="l00485"></a>00485 
<a name="l00486"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a5777490a04c83b59ff363e35c74d7a41">00486</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a5777490a04c83b59ff363e35c74d7a41">ImageEffectNode::initFps</a>()
<a name="l00487"></a>00487 {
<a name="l00488"></a>00488         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; outputClip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a30a35130c57b2ae9c59700a602e8af6d">getOutputClip</a>() );
<a name="l00489"></a>00489         outputClip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a0e3ed972ba6a756e1e0ad450e21b8e43">setFrameRate</a>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#af04e71e1e24b0936a0211470a74c3be1" title="get the output frame rate, as set in the clip prefences action.">getOutputFrameRate</a>() );
<a name="l00490"></a>00490 }
<a name="l00491"></a>00491 
<a name="l00492"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aa96b417cdbdb31566edf5ebbf3cc0d7f">00492</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aa96b417cdbdb31566edf5ebbf3cc0d7f">ImageEffectNode::initPixelAspectRatio</a>()
<a name="l00493"></a>00493 {
<a name="l00494"></a>00494         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; outputClip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a30a35130c57b2ae9c59700a602e8af6d">getOutputClip</a>() );
<a name="l00495"></a>00495         outputClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a287d29798be183b39be3257c6549cde0">setPixelAspectRatio</a>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a97ceba190322a5d1ee3834487970014c">getOutputPixelAspectRatio</a>(), <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a68bf16e0306494ab1e18f077ebde33b4a9e91cea1eba8824616a9d9abd01d8100">ofx::property::eModifiedByHost</a> );
<a name="l00496"></a>00496 }
<a name="l00497"></a>00497 
<a name="l00498"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8c9407b641f8781c2f731d89ea2172f6">00498</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8c9407b641f8781c2f731d89ea2172f6">ImageEffectNode::maximizeBitDepthFromReadsToWrites</a>()
<a name="l00499"></a>00499 {
<a name="l00500"></a>00500         std::string biggestBitDepth      = kOfxBitDepthNone;
<a name="l00501"></a>00501         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; outputClip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a30a35130c57b2ae9c59700a602e8af6d">getOutputClip</a>() );
<a name="l00502"></a>00502         <span class="keywordtype">bool</span> inputClipsFound             = <span class="keyword">false</span>;
<a name="l00503"></a>00503 
<a name="l00504"></a>00504         <span class="comment">// init variables</span>
<a name="l00505"></a>00505         <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00506"></a>00506              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00507"></a>00507              ++it )
<a name="l00508"></a>00508         {
<a name="l00509"></a>00509                 <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00510"></a>00510                 <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() ) <span class="comment">// filter for clip.isMask() and clip.isOptional() ?</span>
<a name="l00511"></a>00511                 {
<a name="l00512"></a>00512                         inputClipsFound = <span class="keyword">true</span>;
<a name="l00513"></a>00513                         <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00514"></a>00514                         biggestBitDepth = <a class="code" href="../../dd/d48/namespacetuttle_1_1ofx_1_1imageEffect.html#abf1fc85c8c7a5b066e29a43097a41291" title="turns a premultiplication string into and enum">ofx::imageEffect::findDeepestBitDepth</a>( linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#ac97ed9b44fdf6d037d688b61efce79f8" title="fetch depth of all chromatic component in this clip">getBitDepthString</a>(), biggestBitDepth );
<a name="l00515"></a>00515                 }
<a name="l00516"></a>00516         }
<a name="l00517"></a>00517         <span class="keyword">const</span> std::string validBitDepth = this-&gt;<a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a39911bc83d36bc074752b9e77753bfca">bestSupportedBitDepth</a>( biggestBitDepth );
<a name="l00518"></a>00518 
<a name="l00519"></a>00519         <span class="comment">// bit depth</span>
<a name="l00520"></a>00520         <span class="keywordflow">if</span>( <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a16c1882860a2d436b5715138f410c7fe" title="does the effect support multiple clip depths">supportsMultipleClipDepths</a>() )
<a name="l00521"></a>00521         {
<a name="l00522"></a>00522                 <span class="comment">// check if we support the bit depth of each input</span>
<a name="l00523"></a>00523                 <span class="comment">// and fill input clip with connected clips bit depth</span>
<a name="l00524"></a>00524                 <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00525"></a>00525                      it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00526"></a>00526                      ++it )
<a name="l00527"></a>00527                 {
<a name="l00528"></a>00528                         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00529"></a>00529                         <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00530"></a>00530                         {
<a name="l00531"></a>00531                                 <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00532"></a>00532                                 <span class="keyword">const</span> std::string&amp; linkClipBitDepth  = linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#ac97ed9b44fdf6d037d688b61efce79f8" title="fetch depth of all chromatic component in this clip">getBitDepthString</a>();
<a name="l00533"></a>00533                                 <span class="keywordflow">if</span>( this-&gt;<a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#accfeb1b5cc41afc399bbbdefe1ff3c0a">isSupportedBitDepth</a>( linkClipBitDepth ) )
<a name="l00534"></a>00534                                 {
<a name="l00535"></a>00535                                         clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a58dc2f6bc355c3bfc30660844023ac20">setBitDepthStringIfUpperAndNotModifiedByPlugin</a>( linkClipBitDepth );
<a name="l00536"></a>00536                                 }
<a name="l00537"></a>00537                         }
<a name="l00538"></a>00538                 }
<a name="l00539"></a>00539         }
<a name="l00540"></a>00540         <span class="keywordflow">else</span> <span class="comment">// multiple clip depth not supported (standard case)</span>
<a name="l00541"></a>00541         {
<a name="l00542"></a>00542                 <span class="keywordflow">if</span>( inputClipsFound &amp;&amp; <span class="comment">// if we have an input clip</span>
<a name="l00543"></a>00543                     validBitDepth == kOfxBitDepthNone ) <span class="comment">// if we didn&#39;t found a valid bit depth value</span>
<a name="l00544"></a>00544                 {
<a name="l00545"></a>00545                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d6/d07/structtuttle_1_1exception_1_1Logic.html" title="Other exceptions.">exception::Logic</a>()
<a name="l00546"></a>00546                             &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#aeda7b771c5f326f3a5b8b2682ef7953d" title="Like a stringstream but using &quot;operator+&quot; instead of &quot;operator&lt;&lt;&quot;. Use a stringstream internally...">exception::user</a>( <span class="stringliteral">&quot;Pixel depth &quot;</span> + biggestBitDepth + <span class="stringliteral">&quot; not supported on plugin : &quot;</span> + <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>() ) );
<a name="l00547"></a>00547                 }
<a name="l00548"></a>00548                 <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00549"></a>00549                      it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00550"></a>00550                      ++it )
<a name="l00551"></a>00551                 {
<a name="l00552"></a>00552                         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00553"></a>00553                         <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00554"></a>00554                         {
<a name="l00555"></a>00555                                 <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00556"></a>00556                                 <span class="keywordflow">if</span>( ( linkClip.<a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html#a3f70f88825447f81c5aa66c0bd3694e2">getNode</a>().<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a3fa48c8cb259c9db94d0978e75400c09">getNodeType</a>() == <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a3b7abbb9fff5aefe7dc472ca360ecbf5aaa66324b169fff793d6cba0b4b69f8d1">INode::eNodeTypeImageEffect</a> &amp;&amp;
<a name="l00557"></a>00557                                       linkClip.<a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html#a3f70f88825447f81c5aa66c0bd3694e2">getNode</a>().<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a3638640241342cae8098b5f69446aa30">asImageEffectNode</a>().<a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#accfeb1b5cc41afc399bbbdefe1ff3c0a">isSupportedBitDepth</a>( validBitDepth )
<a name="l00558"></a>00558                                     ) ||
<a name="l00559"></a>00559                                       linkClip.<a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html#a3f70f88825447f81c5aa66c0bd3694e2">getNode</a>().<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a3fa48c8cb259c9db94d0978e75400c09">getNodeType</a>() == <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a3b7abbb9fff5aefe7dc472ca360ecbf5a72f84d8c553a22c754b5dd34d3114943">INode::eNodeTypeBuffer</a>
<a name="l00560"></a>00560                                   )
<a name="l00561"></a>00561                                 {
<a name="l00562"></a>00562                                         clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a58dc2f6bc355c3bfc30660844023ac20">setBitDepthStringIfUpperAndNotModifiedByPlugin</a>( validBitDepth );
<a name="l00563"></a>00563                                 }
<a name="l00564"></a>00564                         }
<a name="l00565"></a>00565                 }
<a name="l00566"></a>00566         }
<a name="l00567"></a>00567         outputClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a58dc2f6bc355c3bfc30660844023ac20">setBitDepthStringIfUpperAndNotModifiedByPlugin</a>( validBitDepth );
<a name="l00568"></a>00568 }
<a name="l00569"></a>00569 
<a name="l00570"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a0d264134f1b8eb83351d4986369d3830">00570</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a0d264134f1b8eb83351d4986369d3830">ImageEffectNode::maximizeBitDepthFromWritesToReads</a>()
<a name="l00571"></a>00571 {
<a name="l00572"></a>00572         <span class="comment">//TUTTLE_TLOG( TUTTLE_INFO, &quot;maximizeBitDepthFromWritesToReads: &quot; &lt;&lt; getName() );</span>
<a name="l00573"></a>00573         <span class="keywordflow">if</span>( !<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a16c1882860a2d436b5715138f410c7fe" title="does the effect support multiple clip depths">supportsMultipleClipDepths</a>() )
<a name="l00574"></a>00574         {
<a name="l00575"></a>00575                 <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; outputClip         = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a30a35130c57b2ae9c59700a602e8af6d">getOutputClip</a>() );
<a name="l00576"></a>00576                 <span class="keyword">const</span> std::string&amp; outputClipBitDepthStr = outputClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#ac97ed9b44fdf6d037d688b61efce79f8" title="fetch depth of all chromatic component in this clip">getBitDepthString</a>();
<a name="l00577"></a>00577                 <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00578"></a>00578                      it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00579"></a>00579                      ++it )
<a name="l00580"></a>00580                 {
<a name="l00581"></a>00581                         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00582"></a>00582                         <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00583"></a>00583                         {<span class="comment"></span>
<a name="l00584"></a>00584 <span class="comment">                                /// @todo tuttle: what is the best way to access another node ?</span>
<a name="l00585"></a>00585 <span class="comment">                                /// through the graph ? through a graph inside ProcessOptions ?</span>
<a name="l00586"></a>00586 <span class="comment"></span>                                <span class="comment">/*const */</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00587"></a>00587 
<a name="l00588"></a>00588                                 <span class="comment">//TUTTLE_TLOG( TUTTLE_INFO, clip.getFullName() &lt;&lt; &quot;(&quot; &lt;&lt; clip.getBitDepth() &lt;&lt; &quot;)&quot; &lt;&lt; &quot;--&gt;&quot; &lt;&lt; linkClip.getFullName() &lt;&lt; &quot;(&quot; &lt;&lt; linkClip.getBitDepth() &lt;&lt; &quot;)&quot; );</span>
<a name="l00589"></a>00589                                 <span class="keywordflow">if</span>( linkClip.<a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html#a3f70f88825447f81c5aa66c0bd3694e2">getNode</a>().<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a3fa48c8cb259c9db94d0978e75400c09">getNodeType</a>() == <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a3b7abbb9fff5aefe7dc472ca360ecbf5aaa66324b169fff793d6cba0b4b69f8d1">INode::eNodeTypeImageEffect</a> &amp;&amp;
<a name="l00590"></a>00590                                     linkClip.<a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html#a3f70f88825447f81c5aa66c0bd3694e2">getNode</a>().<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a3638640241342cae8098b5f69446aa30">asImageEffectNode</a>().<a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#accfeb1b5cc41afc399bbbdefe1ff3c0a">isSupportedBitDepth</a>( outputClipBitDepthStr ) ) <span class="comment">// need to be supported by the other node</span>
<a name="l00591"></a>00591                                 {
<a name="l00592"></a>00592                                         <span class="keywordflow">if</span>( linkClip.<a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html#a3f70f88825447f81c5aa66c0bd3694e2">getNode</a>().<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a3638640241342cae8098b5f69446aa30">asImageEffectNode</a>().<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a16c1882860a2d436b5715138f410c7fe" title="does the effect support multiple clip depths">supportsMultipleClipDepths</a>() ) <span class="comment">/// @todo tuttle: is this test correct in all cases?</span>
<a name="l00593"></a>00593 <span class="comment"></span>                                        {
<a name="l00594"></a>00594                                                 linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aef6a33d1bd91a59f369db0c5e8ee93c9">setBitDepthStringIfUpper</a>( outputClipBitDepthStr );
<a name="l00595"></a>00595                                         }
<a name="l00596"></a>00596                                         <span class="keywordflow">else</span>
<a name="l00597"></a>00597                                         {
<a name="l00598"></a>00598                                                 linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a58dc2f6bc355c3bfc30660844023ac20">setBitDepthStringIfUpperAndNotModifiedByPlugin</a>( outputClipBitDepthStr );
<a name="l00599"></a>00599                                         }
<a name="l00600"></a>00600                                 }
<a name="l00601"></a>00601                                 <span class="comment">//TUTTLE_TLOG( TUTTLE_INFO, clip.getFullName() &lt;&lt; &quot;(&quot; &lt;&lt; clip.getBitDepth() &lt;&lt; &quot;)&quot; &lt;&lt; &quot;--&gt;&quot; &lt;&lt; linkClip.getFullName() &lt;&lt; &quot;(&quot; &lt;&lt; linkClip.getBitDepth() &lt;&lt; &quot;)&quot; );</span>
<a name="l00602"></a>00602                         }
<a name="l00603"></a>00603                         <span class="comment">//else</span>
<a name="l00604"></a>00604                         <span class="comment">//{</span>
<a name="l00605"></a>00605                         <span class="comment">//      TUTTLE_TLOG( TUTTLE_INFO, clip.getFullName() &lt;&lt; &quot;(&quot; &lt;&lt; clip.getBitDepth() &lt;&lt; &quot;)&quot; &lt;&lt; &quot;, unconnected ? &quot; &lt;&lt; clip.isConnected() &lt;&lt; &quot;, output ? &quot; &lt;&lt; clip.isOutput() );</span>
<a name="l00606"></a>00606                         <span class="comment">//}</span>
<a name="l00607"></a>00607                 }
<a name="l00608"></a>00608         }
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00611"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8657bd0627cbd924e668ff66b55808fd">00611</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8657bd0627cbd924e668ff66b55808fd">ImageEffectNode::coutBitDepthConnections</a>()<span class="keyword"> const</span>
<a name="l00612"></a>00612 <span class="keyword"></span>{
<a name="l00613"></a>00613 <span class="preprocessor">#ifdef TUTTLE_DEBUG</span>
<a name="l00614"></a>00614 <span class="preprocessor"></span>        <span class="comment">// validation</span>
<a name="l00615"></a>00615         <span class="keywordflow">for</span>( ClipImageMap::const_iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00616"></a>00616              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00617"></a>00617              ++it )
<a name="l00618"></a>00618         {
<a name="l00619"></a>00619                 <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00620"></a>00620 
<a name="l00621"></a>00621                 <span class="comment">//const ofx::property::String&amp; propPixelDepth       = clip.getProperties().fetchStringProperty( kOfxImageEffectPropPixelDepth );</span>
<a name="l00622"></a>00622                 <span class="comment">//const ofx::property::String&amp; propComponent        = clip.getProperties().fetchStringProperty( kOfxImageEffectPropComponents );</span>
<a name="l00623"></a>00623                 <span class="comment">//const ofx::property::Double&amp; propPixelAspectRatio = clip.getProperties().fetchDoubleProperty( kOfxImagePropPixelAspectRatio );</span>
<a name="l00624"></a>00624                 <span class="comment">/*</span>
<a name="l00625"></a>00625 <span class="comment">                TUTTLE_TLOG( TUTTLE_INFO, &quot;-- &quot; &lt;&lt; &quot;clip: &quot; &lt;&lt; &quot; = &quot; &lt;&lt; clip.getFullName() );</span>
<a name="l00626"></a>00626 <span class="comment">                TUTTLE_TLOG( TUTTLE_INFO, &quot;-- &quot; &lt;&lt; kOfxImageEffectPropPixelDepth &lt;&lt; &quot; = &quot; &lt;&lt; propPixelDepth.getValue()</span>
<a name="l00627"></a>00627 <span class="comment">                                                           &lt;&lt; &quot; : &quot; &lt;&lt; ( propPixelDepth.getModifiedBy() == ofx::property::eModifiedByPlugin ? &quot;(plugin)&quot; : &quot;(host)&quot; ) );</span>
<a name="l00628"></a>00628 <span class="comment">                TUTTLE_TLOG( TUTTLE_INFO, &quot;-- &quot; &lt;&lt; kOfxImageEffectPropComponents &lt;&lt; &quot; = &quot; &lt;&lt; propComponent.getValue()</span>
<a name="l00629"></a>00629 <span class="comment">                                                           &lt;&lt; &quot; : &quot; &lt;&lt; ( propComponent.getModifiedBy() == ofx::property::eModifiedByPlugin ? &quot;(plugin)&quot; : &quot;(host)&quot; ) );</span>
<a name="l00630"></a>00630 <span class="comment">                TUTTLE_TLOG( TUTTLE_INFO, &quot;-- &quot; &lt;&lt; kOfxImagePropPixelAspectRatio &lt;&lt; &quot; = &quot; &lt;&lt; propPixelAspectRatio.getValue()</span>
<a name="l00631"></a>00631 <span class="comment">                                                           &lt;&lt; &quot; : &quot; &lt;&lt; ( propPixelAspectRatio.getModifiedBy() == ofx::property::eModifiedByPlugin ? &quot;(plugin)&quot; : &quot;(host)&quot; ) );</span>
<a name="l00632"></a>00632 <span class="comment">                */</span>
<a name="l00633"></a>00633                 <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00634"></a>00634                 {
<a name="l00635"></a>00635                         <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00636"></a>00636                         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Bit Depth Connection] Connection between &quot;</span> &lt;&lt; clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a11dbc89b9f072be01b49e000bc9f1ad6" title="fetch depth of all chromatic component in this clip">getBitDepth</a>() &lt;&lt; <span class="stringliteral">&quot; bytes)&quot;</span> &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; linkClip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a11dbc89b9f072be01b49e000bc9f1ad6" title="fetch depth of all chromatic component in this clip">getBitDepth</a>() &lt;&lt; <span class="stringliteral">&quot; bytes).&quot;</span> );
<a name="l00637"></a>00637                 }
<a name="l00638"></a>00638         }
<a name="l00639"></a>00639 <span class="preprocessor">#endif</span>
<a name="l00640"></a>00640 <span class="preprocessor"></span>}
<a name="l00641"></a>00641 
<a name="l00642"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#af59a1085c35218ef61dd43dd0989f8f4">00642</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#af59a1085c35218ef61dd43dd0989f8f4">ImageEffectNode::validInputClipsConnections</a>()<span class="keyword"> const</span>
<a name="l00643"></a>00643 <span class="keyword"></span>{
<a name="l00644"></a>00644         <span class="comment">// validation</span>
<a name="l00645"></a>00645         <span class="keywordflow">for</span>( ClipImageMap::const_iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00646"></a>00646              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00647"></a>00647              ++it )
<a name="l00648"></a>00648         {
<a name="l00649"></a>00649                 <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00650"></a>00650                 <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00651"></a>00651                 {
<a name="l00652"></a>00652                         <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00653"></a>00653                         <span class="keywordflow">if</span>( clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a7ad2ec8166d155f3bd3c6d916027a78f">getComponents</a>() != linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a7ad2ec8166d155f3bd3c6d916027a78f">getComponents</a>() )
<a name="l00654"></a>00654                         {
<a name="l00655"></a>00655                                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d6/d07/structtuttle_1_1exception_1_1Logic.html" title="Other exceptions.">exception::Logic</a>()
<a name="l00656"></a>00656                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#ac85e278687d5002c0367a0b9a1d9326f" title="This is detailed informations for developpers. Not always a real human readable message :)...">exception::dev</a>() + <span class="stringliteral">&quot;Error in graph components propagation.\n&quot;</span>
<a name="l00657"></a>00657                                                               <span class="stringliteral">&quot;Connection \&quot;&quot;</span> + linkClip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() + <span class="stringliteral">&quot;\&quot; (&quot;</span> + linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a70eb90732a88e79264ba4db8967d1fe4">getComponentsString</a>() + <span class="stringliteral">&quot;)&quot;</span> + <span class="stringliteral">&quot; =&gt; \&quot;&quot;</span> + clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() + <span class="stringliteral">&quot;\&quot; (&quot;</span> + clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a70eb90732a88e79264ba4db8967d1fe4">getComponentsString</a>() + <span class="stringliteral">&quot;).&quot;</span>
<a name="l00658"></a>00658                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a364041c001d3e1b99392f62f254e5428" title="Plugin name.">exception::pluginName</a>( <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>() )
<a name="l00659"></a>00659                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a79af359ae6beb7ecdb5d6fa0c70e0acd" title="Plugin string identifier.">exception::pluginIdentifier</a>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a75e1d88efaa61e052b5201ff89d23d0c" title="return the plugin this instance was created with">getPlugin</a>().getIdentifier() ) );
<a name="l00660"></a>00660                         }
<a name="l00661"></a>00661                         <span class="keywordflow">if</span>( clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a11dbc89b9f072be01b49e000bc9f1ad6" title="fetch depth of all chromatic component in this clip">getBitDepth</a>() != linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a11dbc89b9f072be01b49e000bc9f1ad6" title="fetch depth of all chromatic component in this clip">getBitDepth</a>() )
<a name="l00662"></a>00662                         {
<a name="l00663"></a>00663                                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d6/d07/structtuttle_1_1exception_1_1Logic.html" title="Other exceptions.">exception::Logic</a>()
<a name="l00664"></a>00664                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#ac85e278687d5002c0367a0b9a1d9326f" title="This is detailed informations for developpers. Not always a real human readable message :)...">exception::dev</a>() + <span class="stringliteral">&quot;Error in graph bit depth propagation.\n&quot;</span>
<a name="l00665"></a>00665                                                               <span class="stringliteral">&quot;Connection \&quot;&quot;</span> + linkClip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() + <span class="stringliteral">&quot;\&quot; (&quot;</span> + linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a11dbc89b9f072be01b49e000bc9f1ad6" title="fetch depth of all chromatic component in this clip">getBitDepth</a>() + <span class="stringliteral">&quot; bytes)&quot;</span> + <span class="stringliteral">&quot; =&gt; \&quot;&quot;</span> + clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() + <span class="stringliteral">&quot;\&quot; (&quot;</span> + clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a11dbc89b9f072be01b49e000bc9f1ad6" title="fetch depth of all chromatic component in this clip">getBitDepth</a>() + <span class="stringliteral">&quot; bytes).&quot;</span>
<a name="l00666"></a>00666                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a364041c001d3e1b99392f62f254e5428" title="Plugin name.">exception::pluginName</a>( <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>() )
<a name="l00667"></a>00667                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a79af359ae6beb7ecdb5d6fa0c70e0acd" title="Plugin string identifier.">exception::pluginIdentifier</a>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a75e1d88efaa61e052b5201ff89d23d0c" title="return the plugin this instance was created with">getPlugin</a>().getIdentifier() ) );
<a name="l00668"></a>00668                         }
<a name="l00669"></a>00669                 }
<a name="l00670"></a>00670         }
<a name="l00671"></a>00671 }
<a name="l00672"></a>00672 
<a name="l00673"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a1dece05f83ecfbc0884158f4c08ae8b7">00673</a> OfxRangeD <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a1dece05f83ecfbc0884158f4c08ae8b7">ImageEffectNode::getDefaultTimeDomain</a>()<span class="keyword"> const</span>
<a name="l00674"></a>00674 <span class="keyword"></span>{
<a name="l00675"></a>00675         <span class="comment">//TUTTLE_TLOG( TUTTLE_INFO, &quot;- ImageEffectNode::getDefaultTimeDomain: &quot; &lt;&lt; getName() );</span>
<a name="l00676"></a>00676         OfxRangeD range;
<a name="l00677"></a>00677         range.min = kOfxFlagInfiniteMin;
<a name="l00678"></a>00678         range.max = kOfxFlagInfiniteMax;
<a name="l00679"></a>00679         <span class="comment">// if no answer, compute it from input clips</span>
<a name="l00680"></a>00680         <span class="keywordtype">bool</span> first = <span class="keyword">true</span>;
<a name="l00681"></a>00681         <span class="keywordflow">for</span>( ClipImageMap::const_iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00682"></a>00682                 it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00683"></a>00683                 ++it )
<a name="l00684"></a>00684         {
<a name="l00685"></a>00685                 <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00686"></a>00686                 <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00687"></a>00687                 {
<a name="l00688"></a>00688                         <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00689"></a>00689                         <span class="keyword">const</span> OfxRangeD clipRange = linkClip.<a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html#a3f70f88825447f81c5aa66c0bd3694e2">getNode</a>().<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a82cc859318eeb494a5d1f806018b9e68">getTimeDomain</a>();
<a name="l00690"></a>00690                         <span class="keywordflow">if</span>( first )
<a name="l00691"></a>00691                         {
<a name="l00692"></a>00692                                 first = <span class="keyword">false</span>;
<a name="l00693"></a>00693                                 range = clipRange;
<a name="l00694"></a>00694                         }
<a name="l00695"></a>00695                         <span class="keywordflow">else</span>
<a name="l00696"></a>00696                         {
<a name="l00697"></a>00697                                 <span class="comment">// maybe better to use intersection instead of union</span>
<a name="l00698"></a>00698                                 range.min = <a class="code" href="../../d2/d7f/namespacetuttle.html#afbd150ec02af9b6e21b9d758f8aae158">std::min</a>( range.min, clipRange.min );
<a name="l00699"></a>00699                                 range.max = <a class="code" href="../../d2/d7f/namespacetuttle.html#ae47d39ffbfd26c4920c2b25e8c0da3cc">std::max</a>( range.max, clipRange.max );
<a name="l00700"></a>00700                         }
<a name="l00701"></a>00701                 }
<a name="l00702"></a>00702         }
<a name="l00703"></a>00703         <span class="keywordflow">return</span> range;
<a name="l00704"></a>00704 }
<a name="l00705"></a>00705 
<a name="l00706"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a38f9a7c197cd0af800c4ca9d5feb0a05">00706</a> OfxRangeD <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a38f9a7c197cd0af800c4ca9d5feb0a05">ImageEffectNode::computeTimeDomain</a>()
<a name="l00707"></a>00707 {
<a name="l00708"></a>00708         <span class="comment">// Copy connected clips frameRange into each input clips</span>
<a name="l00709"></a>00709         <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l00710"></a>00710                 it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l00711"></a>00711                 ++it )
<a name="l00712"></a>00712         {
<a name="l00713"></a>00713                 <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l00714"></a>00714                 <span class="keywordflow">if</span>( !clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00715"></a>00715                 {
<a name="l00716"></a>00716                         <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; linkClip = clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a997dcd060a9bb17b616965c625236b5e">getConnectedClip</a>();
<a name="l00717"></a>00717                         <span class="keyword">const</span> OfxRangeD clipRange = linkClip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#af52bb75bcfc844d140c296cf54694a75">getFrameRange</a>();
<a name="l00718"></a>00718                         clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a07a0d8770004bc1328a21b8c2724c45b" title="Frame Range (startFrame, endFrame) The frame range over which a clip has images.">setFrameRange</a>( clipRange.min, clipRange.max );
<a name="l00719"></a>00719                 }
<a name="l00720"></a>00720         }
<a name="l00721"></a>00721         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Time domain] getTimeDomain &quot;</span> &lt;&lt; <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>(<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>()) &lt;&lt; <span class="stringliteral">&quot; computed by the host.&quot;</span> );
<a name="l00722"></a>00722         OfxRangeD defaultRange = <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a1dece05f83ecfbc0884158f4c08ae8b7">getDefaultTimeDomain</a>();
<a name="l00723"></a>00723         OfxRangeD range = defaultRange;
<a name="l00724"></a>00724 
<a name="l00725"></a>00725         <span class="comment">// ask to the plugin</span>
<a name="l00726"></a>00726         <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a90b0bed9f73b8938a4a0ef68c1ec4d7d">getTimeDomainAction</a>( range ) )
<a name="l00727"></a>00727         {
<a name="l00728"></a>00728                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Time domain] getTimeDomain &quot;</span> &lt;&lt; <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>(<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>()) &lt;&lt; <span class="stringliteral">&quot; computed by the plugin.&quot;</span> );
<a name="l00729"></a>00729         }
<a name="l00730"></a>00730         <span class="keywordflow">else</span>
<a name="l00731"></a>00731         {
<a name="l00732"></a>00732                 range = defaultRange;
<a name="l00733"></a>00733         }
<a name="l00734"></a>00734         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>* clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>[kOfxImageEffectOutputClipName]);
<a name="l00735"></a>00735         <span class="keywordflow">if</span>( clip )
<a name="l00736"></a>00736         {
<a name="l00737"></a>00737                 clip-&gt;<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a07a0d8770004bc1328a21b8c2724c45b" title="Frame Range (startFrame, endFrame) The frame range over which a clip has images.">setFrameRange</a>( range.min, range.max );
<a name="l00738"></a>00738                 clip-&gt;<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#aa28fb6ee757c0fd8383da36fc875f1af" title="Unmapped Frame Range - The unmaped frame range over which an output clip has images.">setUnmappedFrameRange</a>( range.min, range.max );
<a name="l00739"></a>00739         }
<a name="l00740"></a>00740         <span class="keywordflow">return</span> range;
<a name="l00741"></a>00741 }
<a name="l00742"></a>00742 
<a name="l00743"></a>00743 
<a name="l00744"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aeeae1c85869a03830ce6838872c5820a">00744</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aeeae1c85869a03830ce6838872c5820a">ImageEffectNode::setup1</a>()
<a name="l00745"></a>00745 {
<a name="l00746"></a>00746         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#acbd4eaad456719e0778d8e0537182e2b">checkClipsConnected</a>();
<a name="l00747"></a>00747         
<a name="l00748"></a>00748         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ada343ab81342defb53a4a382e92c3c62">initInputClipsFps</a>();
<a name="l00749"></a>00749         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ad8e2edff3eb5e81ce61cb6c4cfb58515">initInputClipsPixelAspectRatio</a>();
<a name="l00750"></a>00750 
<a name="l00751"></a>00751         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#abfda6e346e828bba376a072e9d66d075">getClipPreferencesAction</a>();
<a name="l00752"></a>00752         
<a name="l00753"></a>00753         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#af893e51daad02d0c441f0dc9fcac0128">initComponents</a>();
<a name="l00754"></a>00754         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aa96b417cdbdb31566edf5ebbf3cc0d7f">initPixelAspectRatio</a>();
<a name="l00755"></a>00755         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a5777490a04c83b59ff363e35c74d7a41">initFps</a>();
<a name="l00756"></a>00756         
<a name="l00757"></a>00757         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8c9407b641f8781c2f731d89ea2172f6">maximizeBitDepthFromReadsToWrites</a>();
<a name="l00758"></a>00758 }
<a name="l00759"></a>00759 
<a name="l00760"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a74df4e9886b1620cd709a388770cabfe">00760</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a74df4e9886b1620cd709a388770cabfe">ImageEffectNode::setup2_reverse</a>()
<a name="l00761"></a>00761 {
<a name="l00762"></a>00762         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a0d264134f1b8eb83351d4986369d3830">maximizeBitDepthFromWritesToReads</a>();
<a name="l00763"></a>00763 }
<a name="l00764"></a>00764 
<a name="l00765"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a683be1012f3cb56663b9814d22f54bca">00765</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a683be1012f3cb56663b9814d22f54bca">ImageEffectNode::setup3</a>()
<a name="l00766"></a>00766 {
<a name="l00767"></a>00767         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8c9407b641f8781c2f731d89ea2172f6">maximizeBitDepthFromReadsToWrites</a>();
<a name="l00768"></a>00768         <span class="comment">//coutBitDepthConnections();</span>
<a name="l00769"></a>00769         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#af59a1085c35218ef61dd43dd0989f8f4">validInputClipsConnections</a>();
<a name="l00770"></a>00770 }
<a name="l00771"></a>00771 
<a name="l00772"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a43df891bfab23c9c5a31e1bd90801db3">00772</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a43df891bfab23c9c5a31e1bd90801db3" title="Begin of the a new frame range to process. Initilize this node.">ImageEffectNode::beginSequence</a>( <a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html">graph::ProcessVertexData</a>&amp; vData )
<a name="l00773"></a>00773 {
<a name="l00774"></a>00774         <span class="comment">//TUTTLE_TLOG( TUTTLE_INFO, &quot;begin: &quot; &lt;&lt; getName() );</span>
<a name="l00775"></a>00775         <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a50b0928ab03852b0e4e071b8dab562f1" title="override to get frame range of the effect">beginSequenceRenderAction</a>(
<a name="l00776"></a>00776                         vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#ab7e9f970a294cfed8c4cd0e72a790d31">_renderTimeRange</a>.min,
<a name="l00777"></a>00777                         vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#ab7e9f970a294cfed8c4cd0e72a790d31">_renderTimeRange</a>.max,
<a name="l00778"></a>00778                         vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#a1e96387782ee03e68c44008de9b384d0">_step</a>,
<a name="l00779"></a>00779                         vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#ac64f7cec49b6c75a87497b28306e3c80">_interactive</a>,
<a name="l00780"></a>00780                         vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#a6f670f1f81314858bc869d74822c92c7">_renderScale</a>
<a name="l00781"></a>00781                 );
<a name="l00782"></a>00782 }
<a name="l00783"></a>00783 
<a name="l00784"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aa7ace2744b76cefb6239dd78e85c816a">00784</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#aa7ace2744b76cefb6239dd78e85c816a" title="Initialization pass to propagate informations from inputs to outputs.">ImageEffectNode::preProcess1</a>( <a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html">graph::ProcessVertexAtTimeData</a>&amp; vData )
<a name="l00785"></a>00785 {
<a name="l00786"></a>00786         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Pre Process 1] &quot;</span> &lt;&lt; <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>() &lt;&lt; <span class="stringliteral">&quot; at time: &quot;</span> &lt;&lt; vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a> );
<a name="l00787"></a>00787         <span class="comment">//setCurrentTime( vData._time );</span>
<a name="l00788"></a>00788 
<a name="l00789"></a>00789         OfxRectD rod;
<a name="l00790"></a>00790         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#acfaa12f87fef7ae2a4aff1aeeb4e5909">getRegionOfDefinitionAction</a>(
<a name="l00791"></a>00791                         vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a>,
<a name="l00792"></a>00792                         vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#ac0089ef8d4d9f83b70fc8bc353af4425">_nodeData</a>-&gt;_renderScale,
<a name="l00793"></a>00793                         rod );
<a name="l00794"></a>00794 <span class="comment">//      TUTTLE_TLOG_VAR3( TUTTLE_INFO, this-&gt;getName(), vData._time, rod );</span>
<a name="l00795"></a>00795 <span class="comment">//      TUTTLE_TLOG_VAR( TUTTLE_INFO, &amp;getData(vData._time) );</span>
<a name="l00796"></a>00796 <span class="comment">//      TUTTLE_TLOG_VAR( TUTTLE_INFO, &amp;vData );</span>
<a name="l00797"></a>00797         vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a107638e0a40896890c1290e3c0d733aa">_renderRoD</a> = rod;
<a name="l00798"></a>00798         vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a> = rod; <span class="comment">///&lt; @todo tuttle: tile supports</span>
<a name="l00799"></a>00799 <span class="comment"></span>
<a name="l00800"></a>00800         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Pre Process 1] rod: x1:&quot;</span> &lt;&lt; rod.x1 &lt;&lt; <span class="stringliteral">&quot; y1:&quot;</span> &lt;&lt; rod.y1 &lt;&lt; <span class="stringliteral">&quot; x2:&quot;</span> &lt;&lt; rod.x2 &lt;&lt; <span class="stringliteral">&quot; y2:&quot;</span> &lt;&lt; rod.y2 );
<a name="l00801"></a>00801 }
<a name="l00802"></a>00802 
<a name="l00803"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8fc2ee43df2b7e42148a5f2f796698e8">00803</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8fc2ee43df2b7e42148a5f2f796698e8" title="Initialization pass to propagate informations from outputs to inputs.">ImageEffectNode::preProcess2_reverse</a>( <a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html">graph::ProcessVertexAtTimeData</a>&amp; vData )
<a name="l00804"></a>00804 {
<a name="l00805"></a>00805 <span class="comment">//      TUTTLE_TLOG( TUTTLE_INFO, &quot;preProcess2_finish: &quot; &lt;&lt; getName() &lt;&lt; &quot; at time: &quot; &lt;&lt; vData._time );</span>
<a name="l00806"></a>00806 
<a name="l00807"></a>00807         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a9cffab0a13d0472ac95dbee76867fd51">getRegionOfInterestAction</a>( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a>,
<a name="l00808"></a>00808                                    vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#ac0089ef8d4d9f83b70fc8bc353af4425">_nodeData</a>-&gt;_renderScale,
<a name="l00809"></a>00809                                    vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>,
<a name="l00810"></a>00810                                    vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a18108913a92a79f46955b529d65d7bdb" title="&lt; in which the plugin set the RoI it needs for each input clip">_inputsRoI</a> );
<a name="l00811"></a>00811 <span class="comment">//      TUTTLE_TLOG_VAR( TUTTLE_INFO, vData._renderRoD );</span>
<a name="l00812"></a>00812 <span class="comment">//      TUTTLE_TLOG_VAR( TUTTLE_INFO, vData._renderRoI );</span>
<a name="l00813"></a>00813 }
<a name="l00814"></a>00814 
<a name="l00815"></a>00815 
<a name="l00816"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a4b8e633189f0c6a08699247aa149b29e">00816</a> <span class="keywordtype">bool</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a4b8e633189f0c6a08699247aa149b29e" title="The node can declare to be an identity operation. In this case, the node is not processed and the ren...">ImageEffectNode::isIdentity</a>( <span class="keyword">const</span> <a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html">graph::ProcessVertexAtTimeData</a>&amp; vData, std::string&amp; clip, OfxTime&amp; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> )<span class="keyword"> const</span>
<a name="l00817"></a>00817 <span class="keyword"></span>{
<a name="l00818"></a>00818         time = vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a>;
<a name="l00819"></a>00819         <span class="keywordtype">double</span> par = this-&gt;<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a30a35130c57b2ae9c59700a602e8af6d">getOutputClip</a>().<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa19baad5f5233a353400fb7b9a630d8e">getPixelAspectRatio</a>();
<a name="l00820"></a>00820         <span class="keywordflow">if</span>( par == 0.0 )
<a name="l00821"></a>00821                 par = 1.0;
<a name="l00822"></a>00822         OfxRectI renderWindow;
<a name="l00823"></a>00823         renderWindow.x1 = boost::numeric_cast&lt;<span class="keywordtype">int</span>&gt;( std::floor( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>.x1 / par ) );
<a name="l00824"></a>00824         renderWindow.x2 = boost::numeric_cast&lt;<span class="keywordtype">int</span>&gt;( std::ceil( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>.x2 / par ) );
<a name="l00825"></a>00825         renderWindow.y1 = boost::numeric_cast&lt;<span class="keywordtype">int</span>&gt;( std::floor( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>.y1 ) );
<a name="l00826"></a>00826         renderWindow.y2 = boost::numeric_cast&lt;<span class="keywordtype">int</span>&gt;( std::ceil( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>.y2 ) );
<a name="l00827"></a>00827         <span class="keywordflow">return</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aa71e5aaa4c384f1fd69dc75cd4c9ca3e">isIdentityAction</a>( time, vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a7701e3afa81f9c477df60ff13d0eac28">_field</a>, renderWindow, vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#ac0089ef8d4d9f83b70fc8bc353af4425">_nodeData</a>-&gt;_renderScale, clip );
<a name="l00828"></a>00828 }
<a name="l00829"></a>00829 
<a name="l00830"></a>00830 
<a name="l00831"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ac9f3aa39fde87536e0b917933c0d9d96">00831</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ac9f3aa39fde87536e0b917933c0d9d96" title="Fill ProcessInfo to compute statistics for the current process, like memory used by this node...">ImageEffectNode::preProcess_infos</a>( <span class="keyword">const</span> <a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html">graph::ProcessVertexAtTimeData</a>&amp; vData, <span class="keyword">const</span> OfxTime <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>, <a class="code" href="../../de/d8b/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeInfo.html">graph::ProcessVertexAtTimeInfo</a>&amp; nodeInfos )<span class="keyword"> const</span>
<a name="l00832"></a>00832 <span class="keyword"></span>{
<a name="l00833"></a>00833 <span class="comment">//      TUTTLE_TLOG( TUTTLE_INFO, &quot;preProcess_infos: &quot; &lt;&lt; getName() );</span>
<a name="l00834"></a>00834         <span class="keyword">const</span> OfxRectD rod             = vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a107638e0a40896890c1290e3c0d733aa">_renderRoD</a>;
<a name="l00835"></a>00835         <span class="keyword">const</span> std::size_t bitDepth     = this-&gt;<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a30a35130c57b2ae9c59700a602e8af6d">getOutputClip</a>().<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a11dbc89b9f072be01b49e000bc9f1ad6" title="fetch depth of all chromatic component in this clip">getBitDepth</a>(); <span class="comment">// value in bytes</span>
<a name="l00836"></a>00836         <span class="keyword">const</span> std::size_t nbComponents = <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a30a35130c57b2ae9c59700a602e8af6d">getOutputClip</a>().<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#af8dec23e64515c6d2373036319337d59">getNbComponents</a>();
<a name="l00837"></a>00837         nodeInfos.<a class="code" href="../../de/d8b/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeInfo.html#ae2bf8d316951287f16c232efa4431348">_memory</a> = std::ceil( ( rod.x2 - rod.x1 ) * ( rod.y2 - rod.y1 ) * nbComponents * bitDepth );
<a name="l00838"></a>00838 }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840 
<a name="l00841"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a7016becc116cc473afc4ac42ee90a58e">00841</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a7016becc116cc473afc4ac42ee90a58e" title="Process this node. All inputs are compute.">ImageEffectNode::process</a>( <a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html">graph::ProcessVertexAtTimeData</a>&amp; vData )
<a name="l00842"></a>00842 {
<a name="l00843"></a>00843         <span class="keywordflow">try</span>
<a name="l00844"></a>00844         {
<a name="l00845"></a>00845                 <a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html">memory::IMemoryCache</a>&amp; memoryCache = vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#ac0089ef8d4d9f83b70fc8bc353af4425">_nodeData</a>-&gt;getInternMemoryCache();
<a name="l00846"></a>00846                 <span class="comment">// keep the hand on all needed datas during the process function</span>
<a name="l00847"></a>00847                 std::list&lt;memory::CACHE_ELEMENT&gt; allNeededDatas;
<a name="l00848"></a>00848 
<a name="l00849"></a>00849                 <span class="keywordtype">double</span> par = this-&gt;<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a30a35130c57b2ae9c59700a602e8af6d">getOutputClip</a>().<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa19baad5f5233a353400fb7b9a630d8e">getPixelAspectRatio</a>();
<a name="l00850"></a>00850                 <span class="keywordflow">if</span>( par == 0.0 )
<a name="l00851"></a>00851                         par = 1.0;
<a name="l00852"></a>00852                 <span class="keyword">const</span> OfxRectI renderWindow = {
<a name="l00853"></a>00853                         boost::numeric_cast&lt;<span class="keywordtype">int</span>&gt;( std::floor( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>.x1 / par ) ),
<a name="l00854"></a>00854                         boost::numeric_cast&lt;int&gt;( std::floor( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>.y1 ) ),
<a name="l00855"></a>00855                         boost::numeric_cast&lt;int&gt;( std::ceil( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>.x2 / par ) ),
<a name="l00856"></a>00856                         boost::numeric_cast&lt;int&gt;( std::ceil( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>.y2 ) )
<a name="l00857"></a>00857                 };
<a name="l00858"></a>00858 <span class="comment">//              TUTTLE_TLOG_VAR( TUTTLE_INFO, roi );</span>
<a name="l00859"></a>00859 
<a name="l00860"></a>00860 <span class="comment">//              INode::ClipTimesSetMap timesSetMap = this-&gt;getFramesNeeded( vData._time );</span>
<a name="l00861"></a>00861 
<a name="l00862"></a>00862                 <span class="comment">// acquire needed clip images</span>
<a name="l00863"></a>00863                 <span class="comment">/*</span>
<a name="l00864"></a>00864 <span class="comment">                TUTTLE_TLOG( TUTTLE_INFO, &quot;acquire needed input clip images&quot; );</span>
<a name="l00865"></a>00865 <span class="comment">                TUTTLE_TLOG_VAR( TUTTLE_INFO, vData._inEdges.size() );</span>
<a name="l00866"></a>00866 <span class="comment">                TUTTLE_TLOG_VAR( TUTTLE_INFO, vData._outEdges.size() );</span>
<a name="l00867"></a>00867 <span class="comment">                BOOST_FOREACH( const graph::ProcessEdgeAtTime* o, vData._outEdges )</span>
<a name="l00868"></a>00868 <span class="comment">                {</span>
<a name="l00869"></a>00869 <span class="comment">                        TUTTLE_TLOG_VAR( TUTTLE_INFO, o );</span>
<a name="l00870"></a>00870 <span class="comment">                        TUTTLE_TLOG_VAR( TUTTLE_INFO, o-&gt;getInTime() );</span>
<a name="l00871"></a>00871 <span class="comment">                        TUTTLE_TLOG_VAR( TUTTLE_INFO, o-&gt;getInAttrName() );</span>
<a name="l00872"></a>00872 <span class="comment">                }</span>
<a name="l00873"></a>00873 <span class="comment">                BOOST_FOREACH( const graph::ProcessEdgeAtTime* i, vData._inEdges )</span>
<a name="l00874"></a>00874 <span class="comment">                {</span>
<a name="l00875"></a>00875 <span class="comment">                        TUTTLE_TLOG_VAR( TUTTLE_INFO, i );</span>
<a name="l00876"></a>00876 <span class="comment">                        TUTTLE_TLOG_VAR( TUTTLE_INFO, i-&gt;getInTime() );</span>
<a name="l00877"></a>00877 <span class="comment">                        TUTTLE_TLOG_VAR( TUTTLE_INFO, i-&gt;getInAttrName() );</span>
<a name="l00878"></a>00878 <span class="comment">                }</span>
<a name="l00879"></a>00879 <span class="comment">                */</span>
<a name="l00880"></a>00880                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Node Process] Acquire needed input clips images&quot;</span> );
<a name="l00881"></a>00881                 BOOST_FOREACH( <span class="keyword">const</span> graph::ProcessVertexAtTimeData::ProcessEdgeAtTimeByClipName::value_type&amp; inEdgePair, vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a40a9668fa596b1ba4a37c5ca2ad47dc3">_inEdges</a> )
<a name="l00882"></a>00882                 {
<a name="l00883"></a>00883                         <span class="keyword">const</span> <a class="code" href="../../d7/d8e/classtuttle_1_1host_1_1graph_1_1ProcessEdgeAtTime.html">graph::ProcessEdgeAtTime</a>* inEdge = inEdgePair.second;
<a name="l00884"></a>00884                         <span class="comment">//TUTTLE_TLOG_VAR( TUTTLE_INFO, i );</span>
<a name="l00885"></a>00885                         <span class="comment">//TUTTLE_TLOG_VAR( TUTTLE_INFO, i-&gt;getInTime() );</span>
<a name="l00886"></a>00886                         <span class="comment">//TUTTLE_TLOG_VAR( TUTTLE_INFO, i-&gt;getInAttrName() );</span>
<a name="l00887"></a>00887                         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8ebd9fbd445a09c4d186d609aa57a63b">getClip</a>( inEdge-&gt;<a class="code" href="../../d4/dc2/classtuttle_1_1host_1_1graph_1_1IEdge.html#ace143f1903651323ac1e444ebb92c942">getInAttrName</a>() );
<a name="l00888"></a>00888                         <span class="keyword">const</span> OfxTime outTime = inEdge-&gt;<a class="code" href="../../d7/d8e/classtuttle_1_1host_1_1graph_1_1ProcessEdgeAtTime.html#a787ab60296e0e1eebc7be065d48f40da">getOutTime</a>();
<a name="l00889"></a>00889 
<a name="l00890"></a>00890                         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Node Process] out: &quot;</span> &lt;&lt; inEdge-&gt;<a class="code" href="../../d4/dc2/classtuttle_1_1host_1_1graph_1_1IEdge.html#a86b12646cba207bd3bdc53f5d1486d55">getOut</a>() &lt;&lt; <span class="stringliteral">&quot; -&gt; in &quot;</span> &lt;&lt; inEdge-&gt;<a class="code" href="../../d4/dc2/classtuttle_1_1host_1_1graph_1_1IEdge.html#a4d838452e4c320c1203e72361c70a8fd">getIn</a>() );
<a name="l00891"></a>00891                         <a class="code" href="../../dd/df9/namespacetuttle_1_1host_1_1memory.html#a83a52ae53b31a1d624569267df52b9f2" title="configure the cache with this element CACHE_ELEMENT should be a smart_ptr of some kind pointer will b...">memory::CACHE_ELEMENT</a> imageCache( memoryCache.<a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html#abad1282d83b192b69887afbcddce2fd8">get</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a5e6d00d39d27d57bc586223cbd24d322">getClipIdentifier</a>(), outTime ) );
<a name="l00892"></a>00892                         <span class="keywordflow">if</span>( imageCache.get() == NULL )
<a name="l00893"></a>00893                         {
<a name="l00894"></a>00894                                 BOOST_THROW_EXCEPTION( <a class="code" href="../../da/dca/structtuttle_1_1exception_1_1Memory.html" title="Status error code indicating that something failed due to memory shortage.">exception::Memory</a>()
<a name="l00895"></a>00895                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#ac85e278687d5002c0367a0b9a1d9326f" title="This is detailed informations for developpers. Not always a real human readable message :)...">exception::dev</a>() + <span class="stringliteral">&quot;Input attribute &quot;</span> + <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() ) + <span class="stringliteral">&quot; at time &quot;</span> + vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a> + <span class="stringliteral">&quot; not in memory cache (identifier:&quot;</span> + <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a5e6d00d39d27d57bc586223cbd24d322">getClipIdentifier</a>() ) + <span class="stringliteral">&quot;).&quot;</span> );
<a name="l00896"></a>00896                         }
<a name="l00897"></a>00897                         allNeededDatas.push_back( imageCache );
<a name="l00898"></a>00898                 }
<a name="l00899"></a>00899 
<a name="l00900"></a>00900                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Node Process] Acquire needed output clip images&quot;</span> );
<a name="l00901"></a>00901                 BOOST_FOREACH( ClipImageMap::value_type&amp; i, <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a> )
<a name="l00902"></a>00902                 {
<a name="l00903"></a>00903                         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( i.second ) );
<a name="l00904"></a>00904                         <span class="keywordflow">if</span>( clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() )
<a name="l00905"></a>00905                         {
<a name="l00906"></a>00906                                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Node Process] &quot;</span> &lt;&lt; vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a> );
<a name="l00907"></a>00907                                 <a class="code" href="../../dd/df9/namespacetuttle_1_1host_1_1memory.html#a83a52ae53b31a1d624569267df52b9f2" title="configure the cache with this element CACHE_ELEMENT should be a smart_ptr of some kind pointer will b...">memory::CACHE_ELEMENT</a> imageCache( <span class="keyword">new</span> <a class="code" href="../../d8/d5b/classtuttle_1_1host_1_1attribute_1_1Image.html">attribute::Image</a>(
<a name="l00908"></a>00908                                                 clip,
<a name="l00909"></a>00909                                                 vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a>,
<a name="l00910"></a>00910                                                 vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a459e2a36b702c158fe39d50fced589ee">_renderRoI</a>,
<a name="l00911"></a>00911                                                 <a class="code" href="../../d8/d5b/classtuttle_1_1host_1_1attribute_1_1Image.html#aa4495cf144608f49390a639ab8b05493adf381229aba5e02a14ed61a82705f72e">attribute::Image::eImageOrientationFromBottomToTop</a>,
<a name="l00912"></a>00912                                                 0 )
<a name="l00913"></a>00913                                         );
<a name="l00914"></a>00914                                 imageCache-&gt;setPoolData( <a class="code" href="../../d0/d0f/namespacetuttle_1_1host.html#a746fb95bca42f3df0271cb413f04804e">core</a>().getMemoryPool().allocate( imageCache-&gt;getMemorySize() ) );
<a name="l00915"></a>00915                                 memoryCache.<a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html#ae1baab10f01324c1d68218a61fce4201">put</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a5e6d00d39d27d57bc586223cbd24d322">getClipIdentifier</a>(), vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a>, imageCache );
<a name="l00916"></a>00916 
<a name="l00917"></a>00917                                 allNeededDatas.push_back( imageCache );
<a name="l00918"></a>00918                         }
<a name="l00919"></a>00919                 }
<a name="l00920"></a>00920 
<a name="l00921"></a>00921                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a5352c1cf06dbeb11da79b136e9f84339" title="terminal display">TUTTLE_LOG_TRACE</a>( <span class="stringliteral">&quot;[Node Process] Plugin Render Action&quot;</span> );
<a name="l00922"></a>00922 
<a name="l00923"></a>00923                 <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a076e6190e81052d19b70660edaf50741">renderAction</a>( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a>,
<a name="l00924"></a>00924                                           vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a52d4c1dce643047be23dc3caa43be5ca">_apiImageEffect</a>.<a class="code" href="../../dc/df0/structtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData_1_1ImageEffect.html#a7701e3afa81f9c477df60ff13d0eac28">_field</a>,
<a name="l00925"></a>00925                                           renderWindow,
<a name="l00926"></a>00926                                           vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#ac0089ef8d4d9f83b70fc8bc353af4425">_nodeData</a>-&gt;_renderScale );
<a name="l00927"></a>00927 
<a name="l00928"></a>00928                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a5352c1cf06dbeb11da79b136e9f84339" title="terminal display">TUTTLE_LOG_TRACE</a>( <span class="stringliteral">&quot;[Node Process] Plugin Render Action - End&quot;</span> );
<a name="l00929"></a>00929 
<a name="l00930"></a>00930                 <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afbda4187dbfae1028563a5e04ced9fed">debugOutputImage</a>( vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a> );
<a name="l00931"></a>00931 
<a name="l00932"></a>00932                 <span class="comment">// release input images</span>
<a name="l00933"></a>00933                 BOOST_FOREACH( <span class="keyword">const</span> graph::ProcessVertexAtTimeData::ProcessEdgeAtTimeByClipName::value_type&amp; inEdgePair, vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a40a9668fa596b1ba4a37c5ca2ad47dc3">_inEdges</a> )
<a name="l00934"></a>00934                 {
<a name="l00935"></a>00935                         <span class="keyword">const</span> <a class="code" href="../../d7/d8e/classtuttle_1_1host_1_1graph_1_1ProcessEdgeAtTime.html">graph::ProcessEdgeAtTime</a>* inEdge = inEdgePair.second;
<a name="l00936"></a>00936                         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a8ebd9fbd445a09c4d186d609aa57a63b">getClip</a>( inEdge-&gt;<a class="code" href="../../d4/dc2/classtuttle_1_1host_1_1graph_1_1IEdge.html#ace143f1903651323ac1e444ebb92c942">getInAttrName</a>() );
<a name="l00937"></a>00937                         <span class="keyword">const</span> OfxTime outTime = inEdge-&gt;<a class="code" href="../../d7/d8e/classtuttle_1_1host_1_1graph_1_1ProcessEdgeAtTime.html#a787ab60296e0e1eebc7be065d48f40da">getOutTime</a>();
<a name="l00938"></a>00938 
<a name="l00939"></a>00939                         <span class="comment">// TUTTLE_LOG_VAR2( TUTTLE_INFO, clip.getClipIdentifier(), outTime );</span>
<a name="l00940"></a>00940                         <span class="comment">// TUTTLE_LOG_VAR2( TUTTLE_INFO, inEdge-&gt;getOut(), inEdge-&gt;getIn() );</span>
<a name="l00941"></a>00941                         <span class="comment">// TUTTLE_LOG_VAR2( TUTTLE_INFO, clip.getClipIdentifier(), clip.getFullName() );</span>
<a name="l00942"></a>00942 
<a name="l00943"></a>00943                         <a class="code" href="../../dd/df9/namespacetuttle_1_1host_1_1memory.html#a83a52ae53b31a1d624569267df52b9f2" title="configure the cache with this element CACHE_ELEMENT should be a smart_ptr of some kind pointer will b...">memory::CACHE_ELEMENT</a> imageCache = memoryCache.<a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html#abad1282d83b192b69887afbcddce2fd8">get</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a5e6d00d39d27d57bc586223cbd24d322">getClipIdentifier</a>(), outTime );
<a name="l00944"></a>00944                         <span class="keywordflow">if</span>( imageCache.get() == NULL )
<a name="l00945"></a>00945                         {
<a name="l00946"></a>00946                                 BOOST_THROW_EXCEPTION( <a class="code" href="../../da/dca/structtuttle_1_1exception_1_1Memory.html" title="Status error code indicating that something failed due to memory shortage.">exception::Memory</a>()
<a name="l00947"></a>00947                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#ac85e278687d5002c0367a0b9a1d9326f" title="This is detailed informations for developpers. Not always a real human readable message :)...">exception::dev</a>() + <span class="stringliteral">&quot;Clip &quot;</span> + <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() ) + <span class="stringliteral">&quot; not in memory cache (identifier: &quot;</span> + <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a5e6d00d39d27d57bc586223cbd24d322">getClipIdentifier</a>() ) + <span class="stringliteral">&quot;, time: &quot;</span> + outTime + <span class="stringliteral">&quot;).&quot;</span> );
<a name="l00948"></a>00948                         }
<a name="l00949"></a>00949                         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a5352c1cf06dbeb11da79b136e9f84339" title="terminal display">TUTTLE_LOG_TRACE</a>( <span class="stringliteral">&quot;[ImageEffectNode] releaseReference: &quot;</span> &lt;&lt; imageCache-&gt;getFullName() );
<a name="l00950"></a>00950                         <span class="comment">// TODO: use RAII technique for add/releaseReference...</span>
<a name="l00951"></a>00951                         imageCache-&gt;releaseReference( <a class="code" href="../../d6/d6a/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImage.html#a6bfce6e7a4eb3927d152a4ff179172ccafb5f10f2eb5b8477bdec047ba58b68f6">ofx::imageEffect::OfxhImage::eReferenceOwnerHost</a> );
<a name="l00952"></a>00952                 }
<a name="l00953"></a>00953 
<a name="l00954"></a>00954                 <span class="comment">// declare future usages of the output</span>
<a name="l00955"></a>00955                 BOOST_FOREACH( ClipImageMap::value_type&amp; item, <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a> )
<a name="l00956"></a>00956                 {
<a name="l00957"></a>00957                         <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( item.second ) );
<a name="l00958"></a>00958                         <span class="keywordflow">if</span>( ! clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; ! clip.<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00959"></a>00959                                 <span class="keywordflow">continue</span>;
<a name="l00960"></a>00960 
<a name="l00961"></a>00961                         <span class="keywordflow">if</span>( clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() )
<a name="l00962"></a>00962                         {
<a name="l00963"></a>00963                                 <a class="code" href="../../dd/df9/namespacetuttle_1_1host_1_1memory.html#a83a52ae53b31a1d624569267df52b9f2" title="configure the cache with this element CACHE_ELEMENT should be a smart_ptr of some kind pointer will b...">memory::CACHE_ELEMENT</a> imageCache = memoryCache.<a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html#abad1282d83b192b69887afbcddce2fd8">get</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a5e6d00d39d27d57bc586223cbd24d322">getClipIdentifier</a>(), vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a> );
<a name="l00964"></a>00964                                 <span class="keywordflow">if</span>( imageCache.get() == NULL )
<a name="l00965"></a>00965                                 {
<a name="l00966"></a>00966                                         BOOST_THROW_EXCEPTION( <a class="code" href="../../da/dca/structtuttle_1_1exception_1_1Memory.html" title="Status error code indicating that something failed due to memory shortage.">exception::Memory</a>()
<a name="l00967"></a>00967                                                 &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#ac85e278687d5002c0367a0b9a1d9326f" title="This is detailed informations for developpers. Not always a real human readable message :)...">exception::dev</a>() + <span class="stringliteral">&quot;Clip &quot;</span> + <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#acdea50ccb25efbabdb60d0add89372fc">getFullName</a>() ) + <span class="stringliteral">&quot; not in memory cache (identifier:&quot;</span> + <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>( clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a5e6d00d39d27d57bc586223cbd24d322">getClipIdentifier</a>() ) + <span class="stringliteral">&quot;).&quot;</span> );
<a name="l00968"></a>00968                                 }
<a name="l00969"></a>00969                                 <span class="keyword">const</span> std::size_t realOutDegree = vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#ab133775051f209ba676f3a0847bcd3fd" title="number of connected input clips">_outDegree</a> - vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#ac082fa3fcb268e6d4ca0b6d059726725">_isFinalNode</a>;  <span class="comment">// final nodes have a connection to the fake output node.</span>
<a name="l00970"></a>00970                                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a968ee57711553957b0d0d095114fa0b8">TUTTLE_INFO</a>, <span class="stringliteral">&quot;[Node Process] Declare future usages: &quot;</span> &lt;&lt; clip.<a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html#a5e6d00d39d27d57bc586223cbd24d322">getClipIdentifier</a>() &lt;&lt; <span class="stringliteral">&quot;, add reference: &quot;</span> &lt;&lt; realOutDegree );
<a name="l00971"></a>00971                                 <span class="keywordflow">if</span>( realOutDegree &gt; 0 )
<a name="l00972"></a>00972                                 {
<a name="l00973"></a>00973                                         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a5352c1cf06dbeb11da79b136e9f84339" title="terminal display">TUTTLE_LOG_TRACE</a>( <span class="stringliteral">&quot;[ImageEffectNode] addReference: &quot;</span> &lt;&lt; imageCache-&gt;getFullName() &lt;&lt; <span class="stringliteral">&quot;, degree=&quot;</span> &lt;&lt; realOutDegree );
<a name="l00974"></a>00974                                         <span class="comment">// TODO: use RAII technique for add/releaseReference...</span>
<a name="l00975"></a>00975                                         <span class="comment">//       to properly declare image unused when an error occured</span>
<a name="l00976"></a>00976                                         <span class="comment">//       during the computation.</span>
<a name="l00977"></a>00977                                         <span class="comment">// Add a reference on this node for each future usages</span>
<a name="l00978"></a>00978                                         imageCache-&gt;addReference( <a class="code" href="../../d6/d6a/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImage.html#a6bfce6e7a4eb3927d152a4ff179172ccafb5f10f2eb5b8477bdec047ba58b68f6">ofx::imageEffect::OfxhImage::eReferenceOwnerHost</a>, realOutDegree );
<a name="l00979"></a>00979                                 }
<a name="l00980"></a>00980                         }
<a name="l00981"></a>00981                 }
<a name="l00982"></a>00982         }
<a name="l00983"></a>00983         <span class="keywordflow">catch</span>(boost::exception&amp; e)
<a name="l00984"></a>00984         {
<a name="l00985"></a>00985                 e &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">exception::time</a>(vData.<a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html#a8fe4427df468e114269a5752b5fc62ce">_time</a>)
<a name="l00986"></a>00986                   &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a79af359ae6beb7ecdb5d6fa0c70e0acd" title="Plugin string identifier.">exception::pluginIdentifier</a>(this-&gt;<a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a75e1d88efaa61e052b5201ff89d23d0c" title="return the plugin this instance was created with">getPlugin</a>().getIdentifier())
<a name="l00987"></a>00987                   &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a4949ab8bfd6e7e076b31412f0fc77a70" title="Node name.">exception::nodeName</a>(this-&gt;<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>());
<a name="l00988"></a>00988                 <span class="keywordflow">throw</span>;
<a name="l00989"></a>00989         }
<a name="l00990"></a>00990 
<a name="l00991"></a>00991 }
<a name="l00992"></a>00992 
<a name="l00993"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ac2529d38188535ae2989bd44343d76b0">00993</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ac2529d38188535ae2989bd44343d76b0" title="The process of all nodes is done for one frame, now finalize this node.">ImageEffectNode::postProcess</a>( <a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html">graph::ProcessVertexAtTimeData</a>&amp; vData )
<a name="l00994"></a>00994 {
<a name="l00995"></a>00995 <span class="comment">//      TUTTLE_TLOG( TUTTLE_INFO, &quot;postProcess: &quot; &lt;&lt; getName() );</span>
<a name="l00996"></a>00996 }
<a name="l00997"></a>00997 
<a name="l00998"></a>00998 
<a name="l00999"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afd9850a6810875e6420df1d1e56ae130">00999</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afd9850a6810875e6420df1d1e56ae130" title="End of the whole frame range process, now finalize this node.">ImageEffectNode::endSequence</a>( <a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html">graph::ProcessVertexData</a>&amp; vData )
<a name="l01000"></a>01000 {
<a name="l01001"></a>01001 <span class="comment">//      TUTTLE_TLOG( TUTTLE_INFO, &quot;end: &quot; &lt;&lt; getName() );</span>
<a name="l01002"></a>01002         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a34da9089ab011870f133fb40d432eec7">endSequenceRenderAction</a>( vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#ab7e9f970a294cfed8c4cd0e72a790d31">_renderTimeRange</a>.min,
<a name="l01003"></a>01003                          vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#ab7e9f970a294cfed8c4cd0e72a790d31">_renderTimeRange</a>.max,
<a name="l01004"></a>01004                          vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#a1e96387782ee03e68c44008de9b384d0">_step</a>,
<a name="l01005"></a>01005                          vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#ac64f7cec49b6c75a87497b28306e3c80">_interactive</a>,
<a name="l01006"></a>01006                          vData.<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#a6f670f1f81314858bc869d74822c92c7">_renderScale</a> );
<a name="l01007"></a>01007 }
<a name="l01008"></a>01008 
<a name="l01009"></a>01009 
<a name="l01010"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a2e042ee844874fcf0adfc6433eff9846">01010</a> std::ostream&amp; <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a2e042ee844874fcf0adfc6433eff9846">ImageEffectNode::print</a>( std::ostream&amp; os )<span class="keyword"> const</span>
<a name="l01011"></a>01011 <span class="keyword"></span>{
<a name="l01012"></a>01012         <span class="keyword">const</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html">ImageEffectNode</a>&amp; v = *<span class="keyword">this</span>;
<a name="l01013"></a>01013         os &lt;&lt; <span class="stringliteral">&quot;________________________________________________________________________________&quot;</span> &lt;&lt; std::endl;
<a name="l01014"></a>01014         os &lt;&lt; <span class="stringliteral">&quot;Plug-in:&quot;</span> &lt;&lt; v.<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#ab5382ddba21f3df16d1efe2ccf43c3e3">getLabel</a>() &lt;&lt; std::endl;
<a name="l01015"></a>01015         os &lt;&lt; <span class="stringliteral">&quot;Description:&quot;</span> &lt;&lt; v.<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#aad8533428ed52bdbad7a059483460c9d" title="Description of the Node.">getLongLabel</a>() &lt;&lt; std::endl;
<a name="l01016"></a>01016         os &lt;&lt; <span class="stringliteral">&quot;Context:&quot;</span> &lt;&lt; v.<a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> &lt;&lt; std::endl;
<a name="l01017"></a>01017         os &lt;&lt; <span class="stringliteral">&quot;Clips:&quot;</span> &lt;&lt; std::endl;
<a name="l01018"></a>01018         <span class="keywordflow">for</span>( ImageEffectNode::ClipImageMap::const_iterator it = v.<a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin(), itEnd = v.<a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l01019"></a>01019              it != itEnd;
<a name="l01020"></a>01020              ++it )
<a name="l01021"></a>01021         {
<a name="l01022"></a>01022                 os &lt;&lt; <span class="stringliteral">&quot;  * &quot;</span> &lt;&lt; it-&gt;second-&gt;getName() &lt;&lt; std::endl;
<a name="l01023"></a>01023         }
<a name="l01024"></a>01024         os &lt;&lt; <span class="stringliteral">&quot;Params:&quot;</span> &lt;&lt; std::endl;
<a name="l01025"></a>01025         <span class="keywordflow">for</span>( ImageEffectNode::ParamVector::const_iterator it = v.<a class="code" href="../../d0/d5e/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSet.html#a0b5de5d5ccc8973ada9f4ad291d93701" title="params list">_paramVector</a>.begin(), itEnd = v.<a class="code" href="../../d0/d5e/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSet.html#a0b5de5d5ccc8973ada9f4ad291d93701" title="params list">_paramVector</a>.end();
<a name="l01026"></a>01026              it != itEnd;
<a name="l01027"></a>01027              ++it )
<a name="l01028"></a>01028         {
<a name="l01029"></a>01029                 os &lt;&lt; <span class="stringliteral">&quot;  * &quot;</span> &lt;&lt; it-&gt;getName() &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; it-&gt;getLabel() &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt;     it-&gt;displayValues(os) &lt;&lt; std::endl;
<a name="l01030"></a>01030         }
<a name="l01031"></a>01031         os &lt;&lt; <span class="stringliteral">&quot;________________________________________________________________________________&quot;</span> &lt;&lt; std::endl;
<a name="l01032"></a>01032         <span class="keywordflow">return</span> os;
<a name="l01033"></a>01033 }
<a name="l01034"></a>01034 
<a name="l01035"></a><a class="code" href="../../d0/d0f/namespacetuttle_1_1host.html#a48cc2e7755b01beba67d605331199975">01035</a> std::ostream&amp; <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a20f6fd995e1048f47fb8de8d0d0be895">operator&lt;&lt;</a>( std::ostream&amp; os, <span class="keyword">const</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html">ImageEffectNode</a>&amp; v )
<a name="l01036"></a>01036 {
<a name="l01037"></a>01037         <span class="keywordflow">return</span> v.<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a2e042ee844874fcf0adfc6433eff9846">print</a>(os);
<a name="l01038"></a>01038 }
<a name="l01039"></a>01039 
<a name="l01040"></a><a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afbda4187dbfae1028563a5e04ced9fed">01040</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#afbda4187dbfae1028563a5e04ced9fed">ImageEffectNode::debugOutputImage</a>( <span class="keyword">const</span> OfxTime <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> )<span class="keyword"> const</span>
<a name="l01041"></a>01041 <span class="keyword"></span>{
<a name="l01042"></a>01042 <span class="preprocessor">        #if(TUTTLE_PNG_EXPORT_BETWEEN_NODES)    </span>
<a name="l01043"></a>01043 <span class="preprocessor"></span>        <span class="keywordflow">for</span>( ClipImageMap::const_iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l01044"></a>01044              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l01045"></a>01045              ++it )
<a name="l01046"></a>01046         {
<a name="l01047"></a>01047                 <span class="keyword">const</span> <a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp; clip = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../db/dd3/classtuttle_1_1host_1_1attribute_1_1ClipImage.html">attribute::ClipImage</a>&amp;<span class="keyword">&gt;</span>( *( it-&gt;second ) );
<a name="l01048"></a>01048                 <span class="keywordflow">if</span>( clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() )
<a name="l01049"></a>01049                 {
<a name="l01050"></a>01050                         boost::shared_ptr&lt;attribute::Image&gt; image = clip.<a class="code" href="../../d7/d58/classtuttle_1_1host_1_1attribute_1_1Attribute.html#a3f70f88825447f81c5aa66c0bd3694e2">getNode</a>().<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#ac0acabcf812acfe4b00557bde062e5bd">getData</a>().<a class="code" href="../../dd/d19/classtuttle_1_1host_1_1graph_1_1ProcessVertexData.html#aee7a1aced6a51d3978f1c4743254b568">getInternMemoryCache</a>().<a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html#abad1282d83b192b69887afbcddce2fd8">get</a>( this-&gt;<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>() + <span class="stringliteral">&quot;.&quot;</span> kOfxOutputAttributeName, time );
<a name="l01051"></a>01051                         image-&gt;debugSaveAsPng( boost::lexical_cast&lt;std::string&gt;( time ) + <span class="stringliteral">&quot;_&quot;</span> + this-&gt;<a class="code" href="../../dc/df6/classtuttle_1_1host_1_1ImageEffectNode.html#a97b755b4cc770fb93adc3fd867965beb">getName</a>() + <span class="stringliteral">&quot;.png&quot;</span> );
<a name="l01052"></a>01052                 }
<a name="l01053"></a>01053         }
<a name="l01054"></a>01054 <span class="preprocessor">        #endif</span>
<a name="l01055"></a>01055 <span class="preprocessor"></span>}
<a name="l01056"></a>01056 
<a name="l01057"></a>01057 }
<a name="l01058"></a>01058 }
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../d5/dcd/ImageEffectNode_8cpp.html">ImageEffectNode.cpp</a>      </li>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
