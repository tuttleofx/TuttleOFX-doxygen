<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TuttleOFX: TuttleOFX/libraries/tuttle/src/tuttle/host/graph/ProcessVisitors.hpp Source File</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">TuttleOFX
   &#160;<span id="projectnumber">1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('dc/d0f/ProcessVisitors_8hpp.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">TuttleOFX/libraries/tuttle/src/tuttle/host/graph/ProcessVisitors.hpp</div>  </div>
</div>
<div class="contents">
<a href="../../dc/d0f/ProcessVisitors_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef _TUTTLE_HOST_PROCESSVISITORS_HPP_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define _TUTTLE_HOST_PROCESSVISITORS_HPP_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d56/ProcessVertexData_8hpp.html">ProcessVertexData.hpp</a>&quot;</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;<a class="code" href="../../db/da9/MemoryCache_8hpp.html">tuttle/host/memory/MemoryCache.hpp</a>&gt;</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;boost/graph/properties.hpp&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;boost/graph/visitors.hpp&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;boost/graph/depth_first_search.hpp&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;boost/graph/breadth_first_search.hpp&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;boost/foreach.hpp&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;boost/date_time/posix_time/posix_time.hpp&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;boost/unordered_map.hpp&gt;</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="keyword">namespace </span>tuttle {
<a name="l00021"></a>00021 <span class="keyword">namespace </span>host {
<a name="l00022"></a>00022 <span class="keyword">namespace </span>graph {
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00025"></a><a class="code" href="../../d9/d6b/namespacetuttle_1_1host_1_1graph.html#a200e2cc1caf7169c4e79ad7d20f26afe">00025</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/d6b/namespacetuttle_1_1host_1_1graph.html#a200e2cc1caf7169c4e79ad7d20f26afe">connectClips</a>( TGraph&amp; graph )
<a name="l00026"></a>00026 {
<a name="l00027"></a>00027         BOOST_FOREACH( <span class="keyword">typename</span> TGraph::edge_descriptor ed, graph.getEdges() )
<a name="l00028"></a>00028         {
<a name="l00029"></a>00029                 <span class="keyword">typename</span> TGraph::Edge&amp; edge           = graph.instance( ed );
<a name="l00030"></a>00030                 <span class="keyword">typename</span> TGraph::Vertex&amp; vertexOutput = graph.targetInstance( ed );
<a name="l00031"></a>00031                 <span class="keyword">typename</span> TGraph::Vertex&amp; vertexInput  = graph.sourceInstance( ed );
<a name="l00032"></a>00032 
<a name="l00033"></a>00033                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Connect Clips] &quot;</span> &lt;&lt; edge );
<a name="l00034"></a>00034                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Connect Clips] &quot;</span> &lt;&lt; vertexOutput &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; vertexInput );
<a name="l00035"></a>00035                 <span class="comment">//TUTTLE_TLOG_VAR( TUTTLE_TRACE, edge.getInAttrName() );</span>
<a name="l00036"></a>00036                 
<a name="l00037"></a>00037                 <span class="keywordflow">if</span>( ! vertexOutput.isFake() &amp;&amp; ! vertexInput.isFake() )
<a name="l00038"></a>00038                 {
<a name="l00039"></a>00039                         <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html">INode</a>&amp; outputNode = vertexOutput.getProcessNode();
<a name="l00040"></a>00040                         <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html">INode</a>&amp; inputNode = vertexInput.getProcessNode();
<a name="l00041"></a>00041                         inputNode.<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a799d49d97592efb7dbed4d13f6d6d2a7">connect</a>( outputNode, inputNode.<a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a4c07ac9bfae017bb2e86409ad37303d4">getAttribute</a>( edge.getInAttrName() ) );
<a name="l00042"></a>00042                 }
<a name="l00043"></a>00043         }
<a name="l00044"></a>00044 }
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="../../d8/d99/namespacetuttle_1_1host_1_1graph_1_1visitor.html">00047</a> <span class="keyword">namespace </span>visitor {
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00052"></a><a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html">00052</a> <span class="keyword">class </span><a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html">Setup1</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054 <span class="keyword">public</span>:
<a name="l00055"></a><a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a55ebf146b79175c24ff3c62a6a6f7762">00055</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a55ebf146b79175c24ff3c62a6a6f7762">GraphContainer</a>;
<a name="l00056"></a><a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a1ea3902d64cd6b58f2d53ad8e52b71a3">00056</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a1ea3902d64cd6b58f2d53ad8e52b71a3">Vertex</a>;
<a name="l00057"></a>00057 
<a name="l00058"></a><a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a431975339d2a82b347f503e83ed8db41">00058</a>         <a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a431975339d2a82b347f503e83ed8db41">Setup1</a>( TGraph&amp; graph )
<a name="l00059"></a>00059                 : <a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a68d5c63a514574769b44a3175cfe0729">_graph</a>( graph )
<a name="l00060"></a>00060         {}
<a name="l00061"></a>00061 
<a name="l00062"></a>00062         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00063"></a><a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a54f7a41fa5be62270526a3dfdbd44f04">00063</a>         <span class="keywordtype">void</span> <a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a54f7a41fa5be62270526a3dfdbd44f04">finish_vertex</a>( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00064"></a>00064         {
<a name="l00065"></a>00065                 <a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a1ea3902d64cd6b58f2d53ad8e52b71a3">Vertex</a>&amp; vertex = <a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a68d5c63a514574769b44a3175cfe0729">_graph</a>.instance( v );
<a name="l00066"></a>00066 
<a name="l00067"></a>00067                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Setup 1] finish vertex &quot;</span> &lt;&lt; vertex );
<a name="l00068"></a>00068                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00069"></a>00069                         <span class="keywordflow">return</span>;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071                 vertex.getProcessNode().setup1();
<a name="l00072"></a>00072         }
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="keyword">private</span>:
<a name="l00075"></a><a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a68d5c63a514574769b44a3175cfe0729">00075</a>         TGraph&amp; <a class="code" href="../../d3/d7d/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup1.html#a68d5c63a514574769b44a3175cfe0729">_graph</a>;
<a name="l00076"></a>00076 };
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00079"></a><a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html">00079</a> <span class="keyword">class </span><a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html">Setup2</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081 <span class="keyword">public</span>:
<a name="l00082"></a><a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#ae275ff92c10400df9b190f762ad5b5a4">00082</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#ae275ff92c10400df9b190f762ad5b5a4">GraphContainer</a>;
<a name="l00083"></a><a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#af3031255232263ed2d96984ae99fcfc1">00083</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#af3031255232263ed2d96984ae99fcfc1">Vertex</a>;
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#aad8307b273420ca237f34c69e90395eb">00085</a>         <a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#aad8307b273420ca237f34c69e90395eb">Setup2</a>( TGraph&amp; graph )
<a name="l00086"></a>00086                 : <a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#a3f5c2b9ae41faedad170bf87b6edafe2">_graph</a>( graph )
<a name="l00087"></a>00087         {}
<a name="l00088"></a>00088 
<a name="l00089"></a>00089         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00090"></a><a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#a4ed3d19dabf2fa489933ab1f0a768c26">00090</a>         <span class="keywordtype">void</span> <a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#a4ed3d19dabf2fa489933ab1f0a768c26">discover_vertex</a>( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00091"></a>00091         {
<a name="l00092"></a>00092                 <a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#af3031255232263ed2d96984ae99fcfc1">Vertex</a>&amp; vertex = <a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#a3f5c2b9ae41faedad170bf87b6edafe2">_graph</a>.instance( v );
<a name="l00093"></a>00093 
<a name="l00094"></a>00094                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Setup 2] discover vertex &quot;</span> &lt;&lt; vertex );
<a name="l00095"></a>00095                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00096"></a>00096                         <span class="keywordflow">return</span>;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098                 vertex.getProcessNode().setup2_reverse();
<a name="l00099"></a>00099         }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="keyword">private</span>:
<a name="l00102"></a><a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#a3f5c2b9ae41faedad170bf87b6edafe2">00102</a>         TGraph&amp; <a class="code" href="../../d3/d9a/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup2.html#a3f5c2b9ae41faedad170bf87b6edafe2">_graph</a>;
<a name="l00103"></a>00103 };
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00107"></a><a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html">00107</a> <span class="keyword">class </span><a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html">Setup3</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00108"></a>00108 {
<a name="l00109"></a>00109 <span class="keyword">public</span>:
<a name="l00110"></a><a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a368495a7940f4b0231cfe629f5d9ab43">00110</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a368495a7940f4b0231cfe629f5d9ab43">GraphContainer</a>;
<a name="l00111"></a><a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a4096e83bd693b58a62e9706bfa6e3afd">00111</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a4096e83bd693b58a62e9706bfa6e3afd">Vertex</a>;
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a7af08b46b4951477f066e735f8cf5b68">00113</a>         <a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a7af08b46b4951477f066e735f8cf5b68">Setup3</a>( TGraph&amp; graph )
<a name="l00114"></a>00114                 : <a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a0f2fff31185a25a88c9570ea6f7ea483">_graph</a>( graph )
<a name="l00115"></a>00115         {}
<a name="l00116"></a>00116         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00117"></a><a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a0f8fb6513c1f4ce8fcefd07cc6d3e297">00117</a>         <span class="keywordtype">void</span> <a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a0f8fb6513c1f4ce8fcefd07cc6d3e297">finish_vertex</a>( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00118"></a>00118         {
<a name="l00119"></a>00119                 <a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a4096e83bd693b58a62e9706bfa6e3afd">Vertex</a>&amp; vertex = <a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a0f2fff31185a25a88c9570ea6f7ea483">_graph</a>.instance( v );
<a name="l00120"></a>00120 
<a name="l00121"></a>00121                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Setup 3] finish vertex &quot;</span> &lt;&lt; vertex );
<a name="l00122"></a>00122                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00123"></a>00123                         <span class="keywordflow">return</span>;
<a name="l00124"></a>00124 
<a name="l00125"></a>00125                 vertex.getProcessNode().setup3();
<a name="l00126"></a>00126         }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="keyword">private</span>:
<a name="l00129"></a><a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a0f2fff31185a25a88c9570ea6f7ea483">00129</a>         TGraph&amp; <a class="code" href="../../d2/d68/classtuttle_1_1host_1_1graph_1_1visitor_1_1Setup3.html#a0f2fff31185a25a88c9570ea6f7ea483">_graph</a>;
<a name="l00130"></a>00130 };
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00133"></a><a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html">00133</a> <span class="keyword">class </span><a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html">TimeDomain</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135 <span class="keyword">public</span>:
<a name="l00136"></a><a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#ade83608d4989fa14d80dc6107ea0baa7">00136</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#ade83608d4989fa14d80dc6107ea0baa7">GraphContainer</a>;
<a name="l00137"></a><a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#a2f9b8b5bf3c2bedb8894199d1effdc97">00137</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#a2f9b8b5bf3c2bedb8894199d1effdc97">Vertex</a>;
<a name="l00138"></a>00138 
<a name="l00139"></a><a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#a7d55cc5ab4d882950231ca0c6431d9fa">00139</a>         <a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#a7d55cc5ab4d882950231ca0c6431d9fa">TimeDomain</a>( TGraph&amp; graph )
<a name="l00140"></a>00140                 : <a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#acc161a5e1e1fb27e9bed8f1b918198a0">_graph</a>( graph )
<a name="l00141"></a>00141         {}
<a name="l00142"></a>00142 
<a name="l00143"></a>00143         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00144"></a><a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#ad29d0c2b3ddeef3bbb68c80ff8a511bf">00144</a>         <span class="keywordtype">void</span> <a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#ad29d0c2b3ddeef3bbb68c80ff8a511bf">finish_vertex</a>( VertexDescriptor vd, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00145"></a>00145         {
<a name="l00146"></a>00146                 <a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#a2f9b8b5bf3c2bedb8894199d1effdc97">Vertex</a>&amp; vertex = <a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#acc161a5e1e1fb27e9bed8f1b918198a0">_graph</a>.instance( vd );
<a name="l00147"></a>00147 
<a name="l00148"></a>00148                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Time Domain] finish vertex &quot;</span> &lt;&lt; vertex );
<a name="l00149"></a>00149                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00150"></a>00150                         <span class="keywordflow">return</span>;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152                 vertex.getProcessData()._timeDomain = vertex.getProcessNode().computeTimeDomain();
<a name="l00153"></a>00153                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Time Domain] min: &quot;</span> &lt;&lt; vertex.getProcessData()._timeDomain.min &lt;&lt; <span class="stringliteral">&quot;, max: &quot;</span> &lt;&lt; vertex.getProcessData()._timeDomain.max );
<a name="l00154"></a>00154         }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 <span class="keyword">private</span>:
<a name="l00157"></a><a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#acc161a5e1e1fb27e9bed8f1b918198a0">00157</a>         TGraph&amp; <a class="code" href="../../df/db2/classtuttle_1_1host_1_1graph_1_1visitor_1_1TimeDomain.html#acc161a5e1e1fb27e9bed8f1b918198a0">_graph</a>;
<a name="l00158"></a>00158 };
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00161"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html">00161</a> <span class="keyword">class </span><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html">ComputeHashAtTime</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00162"></a>00162 {
<a name="l00163"></a>00163 <span class="keyword">public</span>:
<a name="l00164"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a7d70718fa6b550d8c7306917b57d744f">00164</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a7d70718fa6b550d8c7306917b57d744f">GraphContainer</a>;
<a name="l00165"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#ab339bf2638f5ed8942882cde9dd608a0">00165</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#ab339bf2638f5ed8942882cde9dd608a0">Vertex</a>;
<a name="l00166"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#acb7c048a11dae70a6174b3ecfa9a4dba">00166</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Edge <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#acb7c048a11dae70a6174b3ecfa9a4dba">Edge</a>;
<a name="l00167"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a74f217538fe07dfd6610cb6c3268877d">00167</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::vertex_descriptor <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a74f217538fe07dfd6610cb6c3268877d">vertex_descriptor</a>;
<a name="l00168"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a8f4cf2dcbee151a01758d1a7ffe4fb45">00168</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::edge_descriptor <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a8f4cf2dcbee151a01758d1a7ffe4fb45">edge_descriptor</a>;
<a name="l00169"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a63645010924630617f30d2ac3cfc982a">00169</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex::Key <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a63645010924630617f30d2ac3cfc982a">VertexKey</a>;
<a name="l00170"></a>00170 
<a name="l00171"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a6c1387f5d9132bca693285d00091ada5">00171</a>         <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a6c1387f5d9132bca693285d00091ada5">ComputeHashAtTime</a>( TGraph&amp; graph, <a class="code" href="../../d1/d65/classtuttle_1_1host_1_1NodeHashContainer.html">NodeHashContainer</a>&amp; outNodesHash, <span class="keyword">const</span> OfxTime <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> )
<a name="l00172"></a>00172                 : <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a830d3ebbaf0957042ab732b3a70dd3bf">_graph</a>( graph )
<a name="l00173"></a>00173                 , <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#ac3925007df77f8892efd200c1fc8d526">_outNodesHash</a>( outNodesHash )
<a name="l00174"></a>00174                 , <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a05ba4f5c67d684215e868782540db1db">_time</a>( time )
<a name="l00175"></a>00175         {
<a name="l00176"></a>00176                 <span class="comment">//TUTTLE_TLOG( TUTTLE_TRACE, &quot;[ComputeHashAtTime] constructor&quot; );</span>
<a name="l00177"></a>00177         }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00180"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a8a5f12be1ebdd220cd4402ef970bc3f2">00180</a>         <span class="keywordtype">void</span> <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a8a5f12be1ebdd220cd4402ef970bc3f2">finish_vertex</a>( VertexDescriptor vd, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00181"></a>00181         {
<a name="l00182"></a>00182                 <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#ab339bf2638f5ed8942882cde9dd608a0">Vertex</a>&amp; vertex = <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a830d3ebbaf0957042ab732b3a70dd3bf">_graph</a>.instance( vd );
<a name="l00183"></a>00183                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Compute Hash At Time] finish vertex &quot;</span> &lt;&lt; vertex );
<a name="l00184"></a>00184 
<a name="l00185"></a>00185                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00186"></a>00186                         <span class="keywordflow">return</span>;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188                 <span class="keyword">const</span> std::size_t localHash = vertex.getProcessNode().getLocalHashAtTime(<a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a05ba4f5c67d684215e868782540db1db">_time</a>);
<a name="l00189"></a>00189 
<a name="l00190"></a>00190                 <span class="keyword">typedef</span> std::map&lt;VertexKey, std::size_t&gt; InputsHash;
<a name="l00191"></a>00191                 InputsHash inputsGlobalHash;
<a name="l00192"></a>00192                 BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a8f4cf2dcbee151a01758d1a7ffe4fb45">edge_descriptor</a>&amp; ed, <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a830d3ebbaf0957042ab732b3a70dd3bf">_graph</a>.getOutEdges( vd ) )
<a name="l00193"></a>00193                 {
<a name="l00194"></a>00194                         <span class="keyword">const</span> <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#acb7c048a11dae70a6174b3ecfa9a4dba">Edge</a>&amp; edge = <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a830d3ebbaf0957042ab732b3a70dd3bf">_graph</a>.instance( ed );
<a name="l00195"></a>00195                         <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a74f217538fe07dfd6610cb6c3268877d">vertex_descriptor</a> inputVertexDesc = <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a830d3ebbaf0957042ab732b3a70dd3bf">_graph</a>.target( ed );
<a name="l00196"></a>00196                         <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#ab339bf2638f5ed8942882cde9dd608a0">Vertex</a>&amp; inputVertex = <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a830d3ebbaf0957042ab732b3a70dd3bf">_graph</a>.instance( inputVertexDesc );
<a name="l00197"></a>00197                         
<a name="l00198"></a>00198                         <span class="keyword">const</span> std::size_t inputGlobalHash = <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#ac3925007df77f8892efd200c1fc8d526">_outNodesHash</a>.<a class="code" href="../../d1/d65/classtuttle_1_1host_1_1NodeHashContainer.html#a7b981f7300bac38d0792033efd7e7266">getHash</a>(inputVertex.getKey());
<a name="l00199"></a>00199                         <span class="comment">// Key is: (clipName, time)</span>
<a name="l00200"></a>00200                         <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a63645010924630617f30d2ac3cfc982a">VertexKey</a> k( edge.getInAttrName(), edge.getOutTime() );
<a name="l00201"></a>00201                         inputsGlobalHash[k] = inputGlobalHash;
<a name="l00202"></a>00202                 }
<a name="l00203"></a>00203                 <span class="comment">// inputGlobalHashes is put into a map to be ordered by clip name</span>
<a name="l00204"></a>00204                 <span class="comment">// the clipName is unique for each time used</span>
<a name="l00205"></a>00205                 std::size_t seed = localHash;
<a name="l00206"></a>00206                 BOOST_FOREACH( <span class="keyword">const</span> <span class="keyword">typename</span> InputsHash::value_type&amp; inputGlobalHash, inputsGlobalHash )
<a name="l00207"></a>00207                 {
<a name="l00208"></a>00208                         <span class="comment">//TUTTLE_TLOG_VAR2( TUTTLE_TRACE, inputGlobalHash.first, inputGlobalHash.second );</span>
<a name="l00209"></a>00209                         boost::hash_combine( seed, inputGlobalHash.first.getName() ); <span class="comment">// name of the input clip connected</span>
<a name="l00210"></a>00210                         boost::hash_combine( seed, inputGlobalHash.second );
<a name="l00211"></a>00211                 }
<a name="l00212"></a>00212                 <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#ac3925007df77f8892efd200c1fc8d526">_outNodesHash</a>.<a class="code" href="../../d1/d65/classtuttle_1_1host_1_1NodeHashContainer.html#a9866625f9f9d6df497ae3ce9c41f9fe3">addHash</a>( vertex.getKey(), seed );
<a name="l00213"></a>00213                 <span class="comment">//TUTTLE_TLOG_VAR( TUTTLE_TRACE, localHash );</span>
<a name="l00214"></a>00214                 <span class="comment">//TUTTLE_TLOG_VAR2( TUTTLE_TRACE, vertex.getKey(), seed );</span>
<a name="l00215"></a>00215         }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <span class="keyword">private</span>:
<a name="l00218"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a830d3ebbaf0957042ab732b3a70dd3bf">00218</a>         TGraph&amp; <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a830d3ebbaf0957042ab732b3a70dd3bf">_graph</a>;
<a name="l00219"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#ac3925007df77f8892efd200c1fc8d526">00219</a>         <a class="code" href="../../d1/d65/classtuttle_1_1host_1_1NodeHashContainer.html">NodeHashContainer</a>&amp; <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#ac3925007df77f8892efd200c1fc8d526">_outNodesHash</a>;
<a name="l00220"></a><a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a05ba4f5c67d684215e868782540db1db">00220</a>         OfxTime <a class="code" href="../../d0/d4a/classtuttle_1_1host_1_1graph_1_1visitor_1_1ComputeHashAtTime.html#a05ba4f5c67d684215e868782540db1db">_time</a>;
<a name="l00221"></a>00221 };
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 <span class="comment"></span>
<a name="l00224"></a>00224 <span class="comment">/**</span>
<a name="l00225"></a>00225 <span class="comment"> * @brief Create a new version of a graph with nodes deployed over time.</span>
<a name="l00226"></a>00226 <span class="comment"> *</span>
<a name="l00227"></a>00227 <span class="comment"> * Compute kOfxImageEffectActionGetFramesNeeded for each node if kOfxImageEffectPropTemporalClipAccess is true.</span>
<a name="l00228"></a>00228 <span class="comment"> */</span>
<a name="l00229"></a>00229 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00230"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html">00230</a> <span class="keyword">class </span><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html" title="Create a new version of a graph with nodes deployed over time.">DeployTime</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00231"></a>00231 {
<a name="l00232"></a>00232 <span class="keyword">public</span>:
<a name="l00233"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ab17329496b7377a49ef91000a4e58883">00233</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ab17329496b7377a49ef91000a4e58883">GraphContainer</a>;
<a name="l00234"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a6c04900724e6a4ed77e631cb7886c65f">00234</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a6c04900724e6a4ed77e631cb7886c65f">Vertex</a>;
<a name="l00235"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#abad6a98da87c8402d65da2b568a5a9ad">00235</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Edge <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#abad6a98da87c8402d65da2b568a5a9ad">Edge</a>;
<a name="l00236"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a9045548bbdbc1d2a4c2dd8ac52573065">00236</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::vertex_descriptor <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a9045548bbdbc1d2a4c2dd8ac52573065">vertex_descriptor</a>;
<a name="l00237"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#aa77082908a297d8e430eab3470c70f0c">00237</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::edge_descriptor <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#aa77082908a297d8e430eab3470c70f0c">edge_descriptor</a>;
<a name="l00238"></a>00238 
<a name="l00239"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a1d19094fe9e1ceff688b46b70e09d283">00239</a>         <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a1d19094fe9e1ceff688b46b70e09d283">DeployTime</a>( TGraph&amp; graph, <span class="keyword">const</span> OfxTime <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> )
<a name="l00240"></a>00240                 : <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">_graph</a>( graph )
<a name="l00241"></a>00241                 , <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a06dfee1ea4955f4d4313d211162c880c">_time</a>( time )
<a name="l00242"></a>00242         {
<a name="l00243"></a>00243                 <span class="comment">// clear all time informations before to fill with new values</span>
<a name="l00244"></a>00244                 BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a9045548bbdbc1d2a4c2dd8ac52573065">vertex_descriptor</a> vd, graph.getVertices() )
<a name="l00245"></a>00245                 {
<a name="l00246"></a>00246                         <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a6c04900724e6a4ed77e631cb7886c65f">Vertex</a>&amp; v = graph.instance( vd );
<a name="l00247"></a>00247                         v.clearTimeInfo();
<a name="l00248"></a>00248                 }
<a name="l00249"></a>00249                 BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#aa77082908a297d8e430eab3470c70f0c">edge_descriptor</a> ed, graph.getEdges() )
<a name="l00250"></a>00250                 {
<a name="l00251"></a>00251                         <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#abad6a98da87c8402d65da2b568a5a9ad">Edge</a>&amp; e = graph.instance( ed );
<a name="l00252"></a>00252                         e.clearTimeInfo();
<a name="l00253"></a>00253                 }
<a name="l00254"></a>00254         }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00257"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a55e6a077f7ef9431f96ac8de01a03869">00257</a>         <span class="keywordtype">void</span> <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a55e6a077f7ef9431f96ac8de01a03869">discover_vertex</a>( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00258"></a>00258         {
<a name="l00259"></a>00259                 <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a6c04900724e6a4ed77e631cb7886c65f">Vertex</a>&amp; vertex = <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">_graph</a>.instance( v );
<a name="l00260"></a>00260             
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 
<a name="l00263"></a>00263                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Deploy Time] &quot;</span> &lt;&lt; vertex );
<a name="l00264"></a>00264                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00265"></a>00265                 {
<a name="l00266"></a>00266                         BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#aa77082908a297d8e430eab3470c70f0c">edge_descriptor</a>&amp; ed, <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">_graph</a>.getOutEdges( v ) )
<a name="l00267"></a>00267                         {
<a name="l00268"></a>00268                                 <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#abad6a98da87c8402d65da2b568a5a9ad">Edge</a>&amp; e = <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">_graph</a>.instance( ed );
<a name="l00269"></a>00269                                 e._timesNeeded[<a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a06dfee1ea4955f4d4313d211162c880c">_time</a>].insert( <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a06dfee1ea4955f4d4313d211162c880c">_time</a> );
<a name="l00270"></a>00270                                 <span class="comment">//TUTTLE_TLOG( TUTTLE_TRACE, &quot;--- insert edge: &quot; &lt;&lt; _time );</span>
<a name="l00271"></a>00271                         }
<a name="l00272"></a>00272                         vertex._data._times.insert( <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a06dfee1ea4955f4d4313d211162c880c">_time</a> );
<a name="l00273"></a>00273                         <span class="keywordflow">return</span>;
<a name="l00274"></a>00274                 }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276                 <span class="comment">// merge times nedded for all out edges</span>
<a name="l00277"></a>00277                 BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#aa77082908a297d8e430eab3470c70f0c">edge_descriptor</a>&amp; ed, <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">_graph</a>.getInEdges( v ) )
<a name="l00278"></a>00278                 {
<a name="l00279"></a>00279                         <span class="keyword">const</span> <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#abad6a98da87c8402d65da2b568a5a9ad">Edge</a>&amp; edge = <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">_graph</a>.instance( ed );
<a name="l00280"></a>00280                         <span class="comment">//TUTTLE_TLOG( TUTTLE_TRACE, &quot;-- outEdge: &quot; &lt;&lt; edge );</span>
<a name="l00281"></a>00281                         BOOST_FOREACH( <span class="keyword">const</span> <span class="keyword">typename</span> Edge::TimeMap::value_type&amp; timesNeeded, edge._timesNeeded )
<a name="l00282"></a>00282                         {
<a name="l00283"></a>00283                                 vertex._data._times.insert( timesNeeded.second.begin(), timesNeeded.second.end() );
<a name="l00284"></a>00284 <span class="comment">//                              std::cout &lt;&lt; &quot;--- insert vertex: &quot;;</span>
<a name="l00285"></a>00285 <span class="comment">//                              std::copy( (*timesNeeded).second.begin(),</span>
<a name="l00286"></a>00286 <span class="comment">//                                         (*timesNeeded).second.end(),</span>
<a name="l00287"></a>00287 <span class="comment">//                                                 std::ostream_iterator&lt;OfxTime&gt;(std::cout, &quot;,&quot;) );</span>
<a name="l00288"></a>00288 <span class="comment">//                              std::cout &lt;&lt; std::endl;</span>
<a name="l00289"></a>00289                         }
<a name="l00290"></a>00290                 }
<a name="l00291"></a>00291                 
<a name="l00292"></a>00292                 <span class="comment">// Set all times needed on each input edges</span>
<a name="l00293"></a>00293                 BOOST_FOREACH( <span class="keyword">const</span> OfxTime t, vertex._data._times )
<a name="l00294"></a>00294                 {
<a name="l00295"></a>00295                         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Deploy Time] time: &quot;</span> &lt;&lt; boost::lexical_cast&lt; std::string &gt;(t) );
<a name="l00296"></a>00296                         <a class="code" href="../../d6/dc0/classtuttle_1_1host_1_1INode.html#a20a5f3c6cba982718c53fb107a4f8492">INode::ClipTimesSetMap</a> mapInputsTimes = vertex.getProcessNode().getTimesNeeded( t );
<a name="l00297"></a>00297 <span class="comment">//                      BOOST_FOREACH( const INode::InputsTimeMap::value_type&amp; v, mapInputsTimes )</span>
<a name="l00298"></a>00298 <span class="comment">//                      {</span>
<a name="l00299"></a>00299 <span class="comment">//                              TUTTLE_TLOG_VAR( TUTTLE_TRACE, v.first );</span>
<a name="l00300"></a>00300 <span class="comment">//                      }</span>
<a name="l00301"></a>00301                         BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#aa77082908a297d8e430eab3470c70f0c">edge_descriptor</a>&amp; ed, <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">_graph</a>.getOutEdges( v ) )
<a name="l00302"></a>00302                         {
<a name="l00303"></a>00303                                 <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#abad6a98da87c8402d65da2b568a5a9ad">Edge</a>&amp; edge = <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">_graph</a>.instance( ed );
<a name="l00304"></a>00304 <span class="comment">//                              TUTTLE_TLOG( TUTTLE_INFO, &quot;-- inEdge &quot;&lt;&lt;t&lt;&lt;&quot;: &quot; &lt;&lt; edge );</span>
<a name="l00305"></a>00305 <span class="comment">//                              const Vertex&amp; input = _graph.targetInstance( ed );</span>
<a name="l00306"></a>00306 <span class="comment">//                              TUTTLE_TLOG_VAR( TUTTLE_TRACE, input.getName() );</span>
<a name="l00307"></a>00307 <span class="comment">//                              std::cout &lt;&lt; &quot;--- insert edges: &quot;;</span>
<a name="l00308"></a>00308 <span class="comment">//                              std::copy( mapInputsTimes[input.getName()+&quot;.&quot; kOfxOutputAttributeName].begin(),</span>
<a name="l00309"></a>00309 <span class="comment">//                                         mapInputsTimes[input.getName()+&quot;.&quot; kOfxOutputAttributeName].end(),</span>
<a name="l00310"></a>00310 <span class="comment">//                                                 std::ostream_iterator&lt;OfxTime&gt;(std::cout, &quot;,&quot;) );</span>
<a name="l00311"></a>00311                                 edge._timesNeeded[t] = mapInputsTimes[edge.getInAttrName()];
<a name="l00312"></a>00312                         }
<a name="l00313"></a>00313                 }
<a name="l00314"></a>00314         }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 <span class="keyword">private</span>:
<a name="l00317"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">00317</a>         TGraph&amp; <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#ad357847e9e14447319c6e29c7bd41e6a">_graph</a>;
<a name="l00318"></a><a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a06dfee1ea4955f4d4313d211162c880c">00318</a>         OfxTime <a class="code" href="../../dd/df2/classtuttle_1_1host_1_1graph_1_1visitor_1_1DeployTime.html#a06dfee1ea4955f4d4313d211162c880c">_time</a>;
<a name="l00319"></a>00319 };
<a name="l00320"></a>00320 
<a name="l00321"></a>00321 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00322"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html">00322</a> <span class="keyword">struct </span><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html">IdentityNodeConnection</a>
<a name="l00323"></a>00323 {
<a name="l00324"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#ac2b72e336b7f7e4e100728436f09b7a5">00324</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#ac2b72e336b7f7e4e100728436f09b7a5">GraphContainer</a>;
<a name="l00325"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#acc05258a75f517c11dd14605302a831c">00325</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#acc05258a75f517c11dd14605302a831c">Vertex</a>;
<a name="l00326"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a34ee7da0f8844c6f21761cd55de0c13e">00326</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> Vertex::Key <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a34ee7da0f8844c6f21761cd55de0c13e">VertexKey</a>;
<a name="l00327"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a86e66602ebce2ba163a54da22732154e">00327</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::vertex_descriptor <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a86e66602ebce2ba163a54da22732154e">vertex_descriptor</a>;
<a name="l00328"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a0333fc80180f1e45b00d2dae86c4effa">00328</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Edge <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a0333fc80180f1e45b00d2dae86c4effa">Edge</a>;
<a name="l00329"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a317a077703656c423ca5e82b88517a26">00329</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::edge_descriptor <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a317a077703656c423ca5e82b88517a26">edge_descriptor</a>;
<a name="l00330"></a>00330         
<a name="l00331"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#ae2372c86477429349431f5cdfec0c95f">00331</a>         <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a34ee7da0f8844c6f21761cd55de0c13e">VertexKey</a> <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#ae2372c86477429349431f5cdfec0c95f" title="the identity node to remove">_identityVertex</a>; <span class="comment">///&lt; the identity node to remove</span>
<a name="l00332"></a><a class="code" href="../../d2/d52/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1InputClipConnection.html">00332</a> <span class="comment"></span>        <span class="keyword">struct </span><a class="code" href="../../d2/d52/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1InputClipConnection.html">InputClipConnection</a>
<a name="l00333"></a>00333         {
<a name="l00334"></a><a class="code" href="../../d2/d52/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1InputClipConnection.html#a02abdfcd34278cb85fbcc31d8d89f09a">00334</a>                 <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a34ee7da0f8844c6f21761cd55de0c13e">VertexKey</a> <a class="code" href="../../d2/d52/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1InputClipConnection.html#a02abdfcd34278cb85fbcc31d8d89f09a">_srcNode</a>;
<a name="l00335"></a><a class="code" href="../../d2/d52/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1InputClipConnection.html#a3ee9cd79e46b871d1eb0d799cb01d956">00335</a>                 std::string <a class="code" href="../../d2/d52/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1InputClipConnection.html#a3ee9cd79e46b871d1eb0d799cb01d956">_inputClip</a>;
<a name="l00336"></a>00336         };
<a name="l00337"></a><a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html">00337</a>         <span class="keyword">struct </span><a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html">OutputClipConnection</a>
<a name="l00338"></a>00338         {
<a name="l00339"></a><a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html#ae637645ea9cfed4a1f09e70d309031d9">00339</a>                 <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#a34ee7da0f8844c6f21761cd55de0c13e">VertexKey</a> <a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html#ae637645ea9cfed4a1f09e70d309031d9">_dstNode</a>;
<a name="l00340"></a><a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html#aaf578e7cdb32c1ca9a4602de21405118">00340</a>                 std::string <a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html#aaf578e7cdb32c1ca9a4602de21405118">_dstNodeClip</a>;
<a name="l00341"></a>00341         };
<a name="l00342"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#adef48a8b680b3f51f194f00f4b348488">00342</a>         <a class="code" href="../../d2/d52/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1InputClipConnection.html">InputClipConnection</a> <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#adef48a8b680b3f51f194f00f4b348488">_input</a>;
<a name="l00343"></a><a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#afe45b82d68d71ea1f4e3114239903bc6">00343</a>         std::vector&lt; OutputClipConnection &gt; <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#afe45b82d68d71ea1f4e3114239903bc6">_outputs</a>;
<a name="l00344"></a>00344 };
<a name="l00345"></a>00345 <span class="comment"></span>
<a name="l00346"></a>00346 <span class="comment">/**</span>
<a name="l00347"></a>00347 <span class="comment"> * @warning in progress...</span>
<a name="l00348"></a>00348 <span class="comment"> */</span>
<a name="l00349"></a>00349 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00350"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html">00350</a> <span class="keyword">class </span><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html">RemoveIdentityNodes</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00351"></a>00351 {
<a name="l00352"></a>00352 <span class="keyword">public</span>:
<a name="l00353"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#ad0b1f955dc17dadbfd6d64f5989fa773">00353</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#ad0b1f955dc17dadbfd6d64f5989fa773">GraphContainer</a>;
<a name="l00354"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a1b0e7d0111683546415e39880f26eb75">00354</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a1b0e7d0111683546415e39880f26eb75">Vertex</a>;
<a name="l00355"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a66036533d1df4c226f338032eff85b2f">00355</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> Vertex::Key <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a66036533d1df4c226f338032eff85b2f">VertexKey</a>;
<a name="l00356"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#ac95615fdd5a65e783c89dfe81e21ada9">00356</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::vertex_descriptor <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#ac95615fdd5a65e783c89dfe81e21ada9">vertex_descriptor</a>;
<a name="l00357"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a67e5ffca432c4ba986ecf4b102eff047">00357</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Edge <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a67e5ffca432c4ba986ecf4b102eff047">Edge</a>;
<a name="l00358"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a12720e8a4224b5d142fbe7e22a609123">00358</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::edge_descriptor <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a12720e8a4224b5d142fbe7e22a609123">edge_descriptor</a>;
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 <span class="keyword">public</span>:
<a name="l00361"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a5ba6cf78d3d29de974c4611b3492a919">00361</a>         <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a5ba6cf78d3d29de974c4611b3492a919">RemoveIdentityNodes</a>( TGraph&amp; graph, std::vector&lt;<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html">IdentityNodeConnection&lt;TGraph&gt;</a> &gt;&amp; toRemove )
<a name="l00362"></a>00362                 : <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>( graph )
<a name="l00363"></a>00363                 , <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a46df2e6029745475d9dc0342c72bb1be">_toRemove</a>( toRemove )
<a name="l00364"></a>00364         {}
<a name="l00365"></a>00365         
<a name="l00366"></a>00366         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00367"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#ad0a3436c5c826dee82cf2bc0e590a4c4">00367</a>         <span class="keywordtype">void</span> <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#ad0a3436c5c826dee82cf2bc0e590a4c4">finish_vertex</a>( VertexDescriptor vd, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00368"></a>00368         {
<a name="l00369"></a>00369                 <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a1b0e7d0111683546415e39880f26eb75">Vertex</a>&amp; vertex = <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.instance( vd );
<a name="l00370"></a>00370 
<a name="l00371"></a>00371                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Remove identity nodes] finish vertex &quot;</span> &lt;&lt; vertex );
<a name="l00372"></a>00372                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00373"></a>00373                         <span class="keywordflow">return</span>;
<a name="l00374"></a>00374 
<a name="l00375"></a>00375                 std::string inputClip;
<a name="l00376"></a>00376                 OfxTime atTime;
<a name="l00377"></a>00377                 <span class="keywordflow">if</span>( vertex.getProcessNode().isIdentity( vertex.getProcessDataAtTime(), inputClip, atTime ) )
<a name="l00378"></a>00378                 {
<a name="l00379"></a>00379                         <span class="keywordflow">try</span>
<a name="l00380"></a>00380                         {
<a name="l00381"></a>00381                                 <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html">IdentityNodeConnection&lt;TGraph&gt;</a> reconnect;
<a name="l00382"></a>00382                                 reconnect.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#ae2372c86477429349431f5cdfec0c95f" title="the identity node to remove">_identityVertex</a> = vertex.getKey();
<a name="l00383"></a>00383                                 reconnect.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#adef48a8b680b3f51f194f00f4b348488">_input</a>._inputClip = inputClip;
<a name="l00384"></a>00384                                 
<a name="l00385"></a>00385                                 <span class="keywordflow">if</span>( ! inputClip.empty() )
<a name="l00386"></a>00386                                 {
<a name="l00387"></a>00387                                         <span class="comment">// The inputClip should not be empty in the OpenFX standard,</span>
<a name="l00388"></a>00388                                         <span class="comment">// but it&#39;s used in TuttleOFX to disable the process of the node</span>
<a name="l00389"></a>00389                                         <span class="comment">// and all the graph branch behind.</span>
<a name="l00390"></a>00390                                         
<a name="l00391"></a>00391                                         <span class="keywordtype">bool</span> clipFound = <span class="keyword">false</span>;
<a name="l00392"></a>00392                                         <span class="keywordtype">bool</span> clipFoundAtTime = <span class="keyword">false</span>;
<a name="l00393"></a>00393                                         BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a12720e8a4224b5d142fbe7e22a609123">edge_descriptor</a>&amp; ed, <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.getOutEdges( vd ) )
<a name="l00394"></a>00394                                         {
<a name="l00395"></a>00395                                                 <span class="keyword">const</span> <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a67e5ffca432c4ba986ecf4b102eff047">Edge</a>&amp; e = <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.instance( ed );
<a name="l00396"></a>00396                                                 <span class="keywordflow">if</span>( e.getInAttrName() == inputClip )
<a name="l00397"></a>00397                                                 {
<a name="l00398"></a>00398                                                         clipFound = <span class="keyword">true</span>;
<a name="l00399"></a>00399                                                         <span class="keywordflow">if</span>( e.getOutTime() == atTime )
<a name="l00400"></a>00400                                                         {
<a name="l00401"></a>00401                                                                 clipFoundAtTime = <span class="keyword">true</span>;
<a name="l00402"></a>00402                                                                 <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#ac95615fdd5a65e783c89dfe81e21ada9">vertex_descriptor</a> in = <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.target( ed );
<a name="l00403"></a>00403                                                                 reconnect.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#adef48a8b680b3f51f194f00f4b348488">_input</a>._srcNode = <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.instance(in).getKey();
<a name="l00404"></a>00404                                                         }
<a name="l00405"></a>00405                                                 }
<a name="l00406"></a>00406                                         }
<a name="l00407"></a>00407                                         <span class="keywordflow">if</span>( ! clipFound )
<a name="l00408"></a>00408                                         {
<a name="l00409"></a>00409                                                 std::stringstream existingClips;
<a name="l00410"></a>00410                                                 BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a12720e8a4224b5d142fbe7e22a609123">edge_descriptor</a>&amp; ed, <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.getOutEdges( vd ) )
<a name="l00411"></a>00411                                                 {
<a name="l00412"></a>00412                                                         <span class="keyword">const</span> <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a67e5ffca432c4ba986ecf4b102eff047">Edge</a>&amp; e = <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.instance( ed );
<a name="l00413"></a>00413                                                         existingClips &lt;&lt; e.getInAttrName() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;
<a name="l00414"></a>00414                                                 }
<a name="l00415"></a>00415                                                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d8/dff/structtuttle_1_1exception_1_1Bug.html" title="Something that should never appends. These exceptions may be replaced by assertions, but we prefer to keep a runtime check even in release (for the moment).">exception::Bug</a>()
<a name="l00416"></a>00416                                                                 &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#ac85e278687d5002c0367a0b9a1d9326f" title="This is detailed informations for developpers. Not always a real human readable message :)...">exception::dev</a>() + <span class="stringliteral">&quot;Plugin declares itself as identity, but gives a non existing input clip. &quot;</span>
<a name="l00417"></a>00417                                                                         <span class="stringliteral">&quot;(node: &quot;</span> + vertex.getName() + <span class="stringliteral">&quot;, input clip:&quot;</span> + inputClip + <span class="stringliteral">&quot;, existing clips: (&quot;</span> + existingClips.str() + <span class="stringliteral">&quot;))&quot;</span>
<a name="l00418"></a>00418                                                                 );
<a name="l00419"></a>00419                                         }
<a name="l00420"></a>00420                                         <span class="keywordflow">if</span>( ! clipFoundAtTime )
<a name="l00421"></a>00421                                         {
<a name="l00422"></a>00422                                                 std::stringstream framesNeeded;
<a name="l00423"></a>00423                                                 BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a12720e8a4224b5d142fbe7e22a609123">edge_descriptor</a>&amp; ed, <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.getOutEdges( vd ) )
<a name="l00424"></a>00424                                                 {
<a name="l00425"></a>00425                                                         <span class="keyword">const</span> <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a67e5ffca432c4ba986ecf4b102eff047">Edge</a>&amp; e = <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.instance( ed );
<a name="l00426"></a>00426                                                         <span class="keywordflow">if</span>( e.getInAttrName() == inputClip )
<a name="l00427"></a>00427                                                         {
<a name="l00428"></a>00428                                                                 framesNeeded &lt;&lt; e.getOutTime() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;
<a name="l00429"></a>00429                                                         }
<a name="l00430"></a>00430                                                 }
<a name="l00431"></a>00431                                                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d8/dff/structtuttle_1_1exception_1_1Bug.html" title="Something that should never appends. These exceptions may be replaced by assertions, but we prefer to keep a runtime check even in release (for the moment).">exception::Bug</a>()
<a name="l00432"></a>00432                                                                 &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#ac85e278687d5002c0367a0b9a1d9326f" title="This is detailed informations for developpers. Not always a real human readable message :)...">exception::dev</a>() + <span class="stringliteral">&quot;Plugin declares itself as identity, but gives a time on the input clip different from declared framesNeeded. &quot;</span>
<a name="l00433"></a>00433                                                                         <span class="stringliteral">&quot;(node: &quot;</span> + vertex.getName() + <span class="stringliteral">&quot;, input clip:&quot;</span> + inputClip + <span class="stringliteral">&quot;, time:&quot;</span> + atTime + <span class="stringliteral">&quot;, framesNeeded:(&quot;</span> + framesNeeded.str() + <span class="stringliteral">&quot;))&quot;</span>
<a name="l00434"></a>00434                                                                 );
<a name="l00435"></a>00435                                         }
<a name="l00436"></a>00436                                         
<a name="l00437"></a>00437                                         BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a12720e8a4224b5d142fbe7e22a609123">edge_descriptor</a>&amp; ed, <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.getInEdges( vd ) )
<a name="l00438"></a>00438                                         {
<a name="l00439"></a>00439                                                 <span class="keyword">const</span> <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a67e5ffca432c4ba986ecf4b102eff047">Edge</a>&amp; e = <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.instance( ed );
<a name="l00440"></a>00440                                                 <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#ac95615fdd5a65e783c89dfe81e21ada9">vertex_descriptor</a> out = <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.source( ed );
<a name="l00441"></a>00441                                                 <span class="keyword">typename</span> <a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html">IdentityNodeConnection&lt;TGraph&gt;::OutputClipConnection</a> c;
<a name="l00442"></a>00442                                                 c.<a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html#ae637645ea9cfed4a1f09e70d309031d9">_dstNode</a> = <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>.instance(out).getKey();
<a name="l00443"></a>00443                                                 c.<a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html#aaf578e7cdb32c1ca9a4602de21405118">_dstNodeClip</a> = e.getInAttrName();
<a name="l00444"></a>00444                                                 reconnect.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#afe45b82d68d71ea1f4e3114239903bc6">_outputs</a>.push_back(c);
<a name="l00445"></a>00445                                         }
<a name="l00446"></a>00446                                 }
<a name="l00447"></a>00447                                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;isIdentity =&gt; &quot;</span> &lt;&lt; vertex.getName() &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; inputClip &lt;&lt; <span class="stringliteral">&quot; at time &quot;</span> &lt;&lt; atTime );
<a name="l00448"></a>00448                                 <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a46df2e6029745475d9dc0342c72bb1be">_toRemove</a>.push_back( reconnect );
<a name="l00449"></a>00449                                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a115f0cacff4204109aad64b877714a02">TUTTLE_TLOG_VAR</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a46df2e6029745475d9dc0342c72bb1be">_toRemove</a>.size() );
<a name="l00450"></a>00450                         }
<a name="l00451"></a>00451                         <span class="keywordflow">catch</span>( boost::exception&amp; e )
<a name="l00452"></a>00452                         {
<a name="l00453"></a>00453                                 e &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#aeda7b771c5f326f3a5b8b2682ef7953d" title="Like a stringstream but using &quot;operator+&quot; instead of &quot;operator&lt;&lt;&quot;. Use a stringstream internally...">exception::user</a>() + <span class="stringliteral">&quot;Error on the node &quot;</span> + <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>(vertex.getName()) + <span class="stringliteral">&quot;. It fails to declare itself as an identity node.&quot;</span>
<a name="l00454"></a>00454                                   &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a4949ab8bfd6e7e076b31412f0fc77a70" title="Node name.">exception::nodeName</a>( vertex.getName() )
<a name="l00455"></a>00455                                   &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">exception::time</a>( vertex.getProcessDataAtTime()._time );
<a name="l00456"></a>00456                                 <span class="keywordflow">throw</span>;
<a name="l00457"></a>00457                         }
<a name="l00458"></a>00458                 }
<a name="l00459"></a>00459         }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461 <span class="keyword">private</span>:
<a name="l00462"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">00462</a>         TGraph&amp; <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a0af791c9f49eff668289b2845bfe69ca">_graph</a>;
<a name="l00463"></a><a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a46df2e6029745475d9dc0342c72bb1be">00463</a>         std::vector&lt;IdentityNodeConnection&lt;TGraph&gt; &gt;&amp; <a class="code" href="../../d2/dff/classtuttle_1_1host_1_1graph_1_1visitor_1_1RemoveIdentityNodes.html#a46df2e6029745475d9dc0342c72bb1be">_toRemove</a>;
<a name="l00464"></a>00464         
<a name="l00465"></a>00465 };
<a name="l00466"></a>00466 <span class="comment"></span>
<a name="l00467"></a>00467 <span class="comment">/**</span>
<a name="l00468"></a>00468 <span class="comment"> * @brief Unconnect identity nodes and re-connect neightbors nodes</span>
<a name="l00469"></a>00469 <span class="comment"> *</span>
<a name="l00470"></a>00470 <span class="comment"> * ////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00471"></a>00471 <span class="comment"> * //        Output at time 5</span>
<a name="l00472"></a>00472 <span class="comment"> * //          |</span>
<a name="l00473"></a>00473 <span class="comment"> * //        Retime time -2 &lt;-- identity node declare to use Merge at time 3</span>
<a name="l00474"></a>00474 <span class="comment"> * //          |</span>
<a name="l00475"></a>00475 <span class="comment"> * //        Merge at time 3 &lt;-- identity node declare to use ReadA at time 3</span>
<a name="l00476"></a>00476 <span class="comment"> * //        /    \</span>
<a name="l00477"></a>00477 <span class="comment"> * //      /        \</span>
<a name="l00478"></a>00478 <span class="comment"> * //    /            \</span>
<a name="l00479"></a>00479 <span class="comment"> * // ReadA time 3   ReadB time 3</span>
<a name="l00480"></a>00480 <span class="comment"> * //</span>
<a name="l00481"></a>00481 <span class="comment"> * ////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00482"></a>00482 <span class="comment"> * // After removing identity nodes:</span>
<a name="l00483"></a>00483 <span class="comment"> * //</span>
<a name="l00484"></a>00484 <span class="comment"> * // Output at time 5</span>
<a name="l00485"></a>00485 <span class="comment"> * //   |</span>
<a name="l00486"></a>00486 <span class="comment"> * // ReadA time 3</span>
<a name="l00487"></a>00487 <span class="comment"> * //</span>
<a name="l00488"></a>00488 <span class="comment"> * // Retime time -2 &lt;-- leave unconnected  </span>
<a name="l00489"></a>00489 <span class="comment"> * // Merge at time 3 &lt;-- leave unconnected  </span>
<a name="l00490"></a>00490 <span class="comment"> * // ReadB time 3 &lt;-- leave unconnected</span>
<a name="l00491"></a>00491 <span class="comment"> * ////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00492"></a>00492 <span class="comment"> */</span>
<a name="l00493"></a>00493 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00494"></a><a class="code" href="../../d8/d99/namespacetuttle_1_1host_1_1graph_1_1visitor.html#a1ad8bb1dfd5a8a4328891f07d89945d2">00494</a> <span class="keywordtype">void</span> <a class="code" href="../../d8/d99/namespacetuttle_1_1host_1_1graph_1_1visitor.html#a1ad8bb1dfd5a8a4328891f07d89945d2" title="Unconnect identity nodes and re-connect neightbors nodes.">removeIdentityNodes</a>( TGraph&amp; graph, <span class="keyword">const</span> std::vector&lt;<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html">IdentityNodeConnection&lt;TGraph&gt;</a> &gt;&amp; nodesToRemove )
<a name="l00495"></a>00495 {
<a name="l00496"></a>00496 <span class="comment">//      TUTTLE_IF_DEBUG(</span>
<a name="l00497"></a>00497 <span class="comment">//              TUTTLE_LOG_VAR( TUTTLE_TRACE, toRemove.size() );</span>
<a name="l00498"></a>00498 <span class="comment">//              BOOST_FOREACH( const IdentityNodeConnection&lt;TGraph&gt;&amp; connection, toRemove )</span>
<a name="l00499"></a>00499 <span class="comment">//              {</span>
<a name="l00500"></a>00500 <span class="comment">//                      TUTTLE_LOG( TUTTLE_TRACE, connection._identityVertex );</span>
<a name="l00501"></a>00501 <span class="comment">//                      TUTTLE_LOG( TUTTLE_TRACE, &quot;IN: &quot;</span>
<a name="l00502"></a>00502 <span class="comment">//                              &lt;&lt; connection._identityVertex &lt;&lt; &quot;::&quot; &lt;&lt; connection._input._inputClip</span>
<a name="l00503"></a>00503 <span class="comment">//                              &lt;&lt; &quot; &lt;&lt;-- &quot;</span>
<a name="l00504"></a>00504 <span class="comment">//                              &lt;&lt; connection._input._srcNode &lt;&lt; &quot;::&quot; kOfxOutputAttributeName );</span>
<a name="l00505"></a>00505 <span class="comment">//                      </span>
<a name="l00506"></a>00506 <span class="comment">//                      BOOST_FOREACH( const typename IdentityNodeConnection&lt;TGraph&gt;::OutputClipConnection&amp; outputClipConnection, connection._outputs )</span>
<a name="l00507"></a>00507 <span class="comment">//                      {</span>
<a name="l00508"></a>00508 <span class="comment">//                              TUTTLE_LOG( TUTTLE_TRACE, &quot;OUT: &quot;</span>
<a name="l00509"></a>00509 <span class="comment">//                                      &lt;&lt; connection._identityVertex &lt;&lt; &quot;::&quot; kOfxOutputAttributeName</span>
<a name="l00510"></a>00510 <span class="comment">//                                      &lt;&lt; &quot; --&gt;&gt; &quot;</span>
<a name="l00511"></a>00511 <span class="comment">//                                      &lt;&lt; outputClipConnection._dstNode &lt;&lt; &quot;::&quot; &lt;&lt; outputClipConnection._dstNodeClip );</span>
<a name="l00512"></a>00512 <span class="comment">//                      }</span>
<a name="l00513"></a>00513 <span class="comment">//              }</span>
<a name="l00514"></a>00514 <span class="comment">//      );</span>
<a name="l00515"></a>00515 <span class="comment">//      TUTTLE_LOG( TUTTLE_TRACE, &quot;-- removeIdentityNodes --&quot; );</span>
<a name="l00516"></a>00516         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex Vertex;
<a name="l00517"></a>00517         <span class="keyword">typedef</span> <span class="keyword">typename</span> Vertex::Key VertexKey;
<a name="l00518"></a>00518         
<a name="l00519"></a>00519         <span class="keyword">typedef</span> boost::unordered_map&lt;VertexKey, const IdentityNodeConnection&lt;TGraph&gt;*&gt; IdentityMap;
<a name="l00520"></a>00520         IdentityMap identityNodes;
<a name="l00521"></a>00521         
<a name="l00522"></a>00522         BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html">IdentityNodeConnection&lt;TGraph&gt;</a>&amp; connection, nodesToRemove )
<a name="l00523"></a>00523         {
<a name="l00524"></a>00524                 identityNodes[connection.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#ae2372c86477429349431f5cdfec0c95f" title="the identity node to remove">_identityVertex</a>] = &amp;connection;
<a name="l00525"></a>00525         }
<a name="l00526"></a>00526         
<a name="l00527"></a>00527         <span class="keywordtype">bool</span> disabledBranch = <span class="keyword">false</span>;
<a name="l00528"></a>00528         BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html">IdentityNodeConnection&lt;TGraph&gt;</a>&amp; connection, nodesToRemove )
<a name="l00529"></a>00529         {
<a name="l00530"></a>00530                 <span class="keywordflow">if</span>( connection.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#adef48a8b680b3f51f194f00f4b348488">_input</a>._inputClip.empty() )
<a name="l00531"></a>00531                 {
<a name="l00532"></a>00532                         <span class="comment">// The input clip is empty, this not in the OpenFX standard.</span>
<a name="l00533"></a>00533                         <span class="comment">// In Tuttle, it means that the branch is disabled.</span>
<a name="l00534"></a>00534                         disabledBranch = <span class="keyword">true</span>;
<a name="l00535"></a>00535                 }
<a name="l00536"></a>00536                 <span class="keywordflow">else</span>
<a name="l00537"></a>00537                 {
<a name="l00538"></a>00538                         <span class="comment">// Create new connections if the input clip name is not empty</span>
<a name="l00539"></a>00539                         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a008c05819b081f0ecdbf279761d69450">TUTTLE_TLOG_TRACE</a>( boost::lexical_cast&lt;std::string&gt;(connection.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#ae2372c86477429349431f5cdfec0c95f" title="the identity node to remove">_identityVertex</a>) );
<a name="l00540"></a>00540                         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a008c05819b081f0ecdbf279761d69450">TUTTLE_TLOG_TRACE</a>( <span class="stringliteral">&quot;IN: &quot;</span>
<a name="l00541"></a>00541                                 &lt;&lt; boost::lexical_cast&lt;std::string&gt;(connection.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#ae2372c86477429349431f5cdfec0c95f" title="the identity node to remove">_identityVertex</a>) &lt;&lt; <span class="stringliteral">&quot;::&quot;</span> &lt;&lt; boost::lexical_cast&lt;std::string&gt;(connection.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#adef48a8b680b3f51f194f00f4b348488">_input</a>._inputClip)
<a name="l00542"></a>00542                                 &lt;&lt; <span class="stringliteral">&quot; &lt;&lt;-- &quot;</span>
<a name="l00543"></a>00543                                 &lt;&lt; boost::lexical_cast&lt;std::string&gt;(connection.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#adef48a8b680b3f51f194f00f4b348488">_input</a>._srcNode) &lt;&lt; <span class="stringliteral">&quot;::&quot;</span> kOfxOutputAttributeName );
<a name="l00544"></a>00544                         <span class="keyword">const</span> <span class="keyword">typename</span> TGraph::VertexKey* searchIn = &amp;( connection.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#adef48a8b680b3f51f194f00f4b348488">_input</a>._srcNode );
<a name="l00545"></a>00545                         {
<a name="l00546"></a>00546                                 <span class="comment">// search a non-identity node to replace the connection</span>
<a name="l00547"></a>00547                                 <span class="keyword">typename</span> IdentityMap::const_iterator it = identityNodes.find( *searchIn );
<a name="l00548"></a>00548                                 <span class="keyword">typename</span> IdentityMap::const_iterator itEnd = identityNodes.end();
<a name="l00549"></a>00549                                 <span class="keywordflow">while</span>( it != itEnd )
<a name="l00550"></a>00550                                 {
<a name="l00551"></a>00551                                         searchIn = &amp;( it-&gt;second-&gt;_input._srcNode );
<a name="l00552"></a>00552                                         it = identityNodes.find( *searchIn );
<a name="l00553"></a>00553                                 }
<a name="l00554"></a>00554                         }
<a name="l00555"></a>00555                         <span class="keyword">const</span> <span class="keyword">typename</span> TGraph::VertexKey&amp; in = *searchIn;
<a name="l00556"></a>00556                         <span class="keyword">const</span> <span class="keyword">typename</span> TGraph::vertex_descriptor descIn  = graph.getVertexDescriptor( in );
<a name="l00557"></a>00557 
<a name="l00558"></a>00558                         <span class="comment">// replace all input/output connections of the identity node by one edge</span>
<a name="l00559"></a>00559                         BOOST_FOREACH( <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html">IdentityNodeConnection&lt;TGraph&gt;::OutputClipConnection</a>&amp; outputClipConnection, connection.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#afe45b82d68d71ea1f4e3114239903bc6">_outputs</a> )
<a name="l00560"></a>00560                         {
<a name="l00561"></a>00561                                 <span class="comment">//TUTTLE_TLOG_TRACE( &quot;OUT: &quot;</span>
<a name="l00562"></a>00562                                 <span class="comment">//      &lt;&lt; connection._identityVertex &lt;&lt; &quot;::&quot; kOfxOutputAttributeName</span>
<a name="l00563"></a>00563                                 <span class="comment">//      &lt;&lt; &quot; --&gt;&gt; &quot;</span>
<a name="l00564"></a>00564                                 <span class="comment">//      &lt;&lt; outputClipConnection._dstNode &lt;&lt; &quot;::&quot; &lt;&lt; outputClipConnection._dstNodeClip );</span>
<a name="l00565"></a>00565                                 <span class="keyword">const</span> <span class="keyword">typename</span> TGraph::VertexKey&amp; out = outputClipConnection.<a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html#ae637645ea9cfed4a1f09e70d309031d9">_dstNode</a>;
<a name="l00566"></a>00566                                 <span class="keyword">const</span> std::string inAttr = outputClipConnection.<a class="code" href="../../db/d97/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection_1_1OutputClipConnection.html#aaf578e7cdb32c1ca9a4602de21405118">_dstNodeClip</a>;
<a name="l00567"></a>00567 
<a name="l00568"></a>00568                                 <span class="keyword">const</span> <span class="keyword">typename</span> TGraph::vertex_descriptor descOut = graph.getVertexDescriptor( out );
<a name="l00569"></a>00569 
<a name="l00570"></a>00570                                 <span class="keyword">const</span> <span class="keyword">typename</span> TGraph::Edge e( in, out, inAttr );
<a name="l00571"></a>00571                                 graph.addEdge( descOut, descIn, e );
<a name="l00572"></a>00572                         }
<a name="l00573"></a>00573                 }
<a name="l00574"></a>00574                 <span class="comment">// Warning: We don&#39;t remove the vertex itself to not invalidate vertex_descriptors but only remove edges.</span>
<a name="l00575"></a>00575 <span class="comment">//              graph.removeVertex( graph.getVertexDescriptor(connection._identityVertex) );</span>
<a name="l00576"></a>00576                 <span class="comment">// remove all node connections</span>
<a name="l00577"></a>00577                 graph.clearVertex( graph.getVertexDescriptor(connection.<a class="code" href="../../de/d9d/structtuttle_1_1host_1_1graph_1_1visitor_1_1IdentityNodeConnection.html#ae2372c86477429349431f5cdfec0c95f" title="the identity node to remove">_identityVertex</a>) );
<a name="l00578"></a>00578         }
<a name="l00579"></a>00579         
<a name="l00580"></a>00580         <span class="keywordflow">if</span>( disabledBranch )
<a name="l00581"></a>00581         {
<a name="l00582"></a>00582                 <span class="comment">// @todo: Remove connections of all vertices not connected to the output.</span>
<a name="l00583"></a>00583                 <span class="comment">// These unconnected branches have been created by identity nodes without source clip.</span>
<a name="l00584"></a>00584         }
<a name="l00585"></a>00585 }
<a name="l00586"></a>00586 
<a name="l00587"></a>00587 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00588"></a><a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html">00588</a> <span class="keyword">class </span><a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html">PreProcess1</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00589"></a>00589 {
<a name="l00590"></a>00590 <span class="keyword">public</span>:
<a name="l00591"></a><a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a91aac3d1d19c9ad023cccd1a065de0f6">00591</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a91aac3d1d19c9ad023cccd1a065de0f6">GraphContainer</a>;
<a name="l00592"></a><a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a6945ea543168fb0924bc01363dbae50d">00592</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a6945ea543168fb0924bc01363dbae50d">Vertex</a>;
<a name="l00593"></a>00593 
<a name="l00594"></a><a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#ad78c5300492e746884bc5d73ff501294">00594</a>         <a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#ad78c5300492e746884bc5d73ff501294">PreProcess1</a>( TGraph&amp; graph )
<a name="l00595"></a>00595                 : <a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a3e707bfe547e3880fd4662be7b10cd27">_graph</a>( graph )
<a name="l00596"></a>00596         {}
<a name="l00597"></a>00597 
<a name="l00598"></a>00598         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00599"></a><a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a08b25d61ebfb8dd299b5fc27860156e5">00599</a>         <span class="keywordtype">void</span> <a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a08b25d61ebfb8dd299b5fc27860156e5">finish_vertex</a>( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00600"></a>00600         {
<a name="l00601"></a>00601                 <a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a6945ea543168fb0924bc01363dbae50d">Vertex</a>&amp; vertex = <a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a3e707bfe547e3880fd4662be7b10cd27">_graph</a>.instance( v );
<a name="l00602"></a>00602 
<a name="l00603"></a>00603                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Preprocess 1] finish vertex &quot;</span> &lt;&lt; vertex );
<a name="l00604"></a>00604                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00605"></a>00605                         <span class="keywordflow">return</span>;
<a name="l00606"></a>00606 
<a name="l00607"></a>00607                 <span class="comment">//TUTTLE_TLOG( TUTTLE_TRACE, vertex.getProcessDataAtTime()._time );</span>
<a name="l00608"></a>00608                 vertex.getProcessNode().preProcess1( vertex.getProcessDataAtTime() );
<a name="l00609"></a>00609         }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611 <span class="keyword">private</span>:
<a name="l00612"></a><a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a3e707bfe547e3880fd4662be7b10cd27">00612</a>         TGraph&amp; <a class="code" href="../../d3/dfc/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess1.html#a3e707bfe547e3880fd4662be7b10cd27">_graph</a>;
<a name="l00613"></a>00613 };
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00616"></a><a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html">00616</a> <span class="keyword">class </span><a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html">PreProcess2</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00617"></a>00617 {
<a name="l00618"></a>00618 <span class="keyword">public</span>:
<a name="l00619"></a><a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#aeb154c3e7a4acd600d235b59309ce282">00619</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#aeb154c3e7a4acd600d235b59309ce282">GraphContainer</a>;
<a name="l00620"></a><a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#a0544b2869a7789897313bc086243bb3a">00620</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#a0544b2869a7789897313bc086243bb3a">Vertex</a>;
<a name="l00621"></a>00621 
<a name="l00622"></a><a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#a00b046cfe89605e9e71891cbad76ce43">00622</a>         <a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#a00b046cfe89605e9e71891cbad76ce43">PreProcess2</a>( TGraph&amp; graph )
<a name="l00623"></a>00623                 : <a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#aaa29f9889d7f23e6ab2d015cc7e59437">_graph</a>( graph )
<a name="l00624"></a>00624         {}
<a name="l00625"></a>00625 
<a name="l00626"></a>00626         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00627"></a><a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#a3a782e017f83561a6defbdef612bc8ac">00627</a>         <span class="keywordtype">void</span> <a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#a3a782e017f83561a6defbdef612bc8ac">discover_vertex</a>( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00628"></a>00628         {
<a name="l00629"></a>00629                 <a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#a0544b2869a7789897313bc086243bb3a">Vertex</a>&amp; vertex = <a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#aaa29f9889d7f23e6ab2d015cc7e59437">_graph</a>.instance( v );
<a name="l00630"></a>00630 
<a name="l00631"></a>00631                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Preprocess 2] discover vertex &quot;</span> &lt;&lt; vertex );
<a name="l00632"></a>00632                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00633"></a>00633                         <span class="keywordflow">return</span>;
<a name="l00634"></a>00634 
<a name="l00635"></a>00635                 vertex.getProcessNode().preProcess2_reverse( vertex.getProcessDataAtTime() );
<a name="l00636"></a>00636         }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638 <span class="keyword">private</span>:
<a name="l00639"></a><a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#aaa29f9889d7f23e6ab2d015cc7e59437">00639</a>         TGraph&amp; <a class="code" href="../../d1/d45/classtuttle_1_1host_1_1graph_1_1visitor_1_1PreProcess2.html#aaa29f9889d7f23e6ab2d015cc7e59437">_graph</a>;
<a name="l00640"></a>00640 };
<a name="l00641"></a>00641 
<a name="l00642"></a>00642 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00643"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html">00643</a> <span class="keyword">class </span><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html">OptimizeGraph</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00644"></a>00644 {
<a name="l00645"></a>00645 <span class="keyword">public</span>:
<a name="l00646"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a422710d58ee695e9538a36d42f54cc9d">00646</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a422710d58ee695e9538a36d42f54cc9d">GraphContainer</a>;
<a name="l00647"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ae919a9b00f7c895439465213a23f6689">00647</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ae919a9b00f7c895439465213a23f6689">Vertex</a>;
<a name="l00648"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a4ff24ac1505ca02c0153a7e4d817b47d">00648</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Edge <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a4ff24ac1505ca02c0153a7e4d817b47d">Edge</a>;
<a name="l00649"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a7f15daf066285ac1e4b7c141a1c2986a">00649</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::vertex_descriptor <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a7f15daf066285ac1e4b7c141a1c2986a">vertex_descriptor</a>;
<a name="l00650"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a0044ce64610c923a977b42a629b2835e">00650</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::edge_descriptor <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a0044ce64610c923a977b42a629b2835e">edge_descriptor</a>;
<a name="l00651"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a6513da0aeedd171d47d3fb0320363887">00651</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::in_edge_iterator <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a6513da0aeedd171d47d3fb0320363887">in_edge_iterator</a>;
<a name="l00652"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#aaafa6faae322cf491db2a6c1e5b4ce9b">00652</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::out_edge_iterator <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#aaafa6faae322cf491db2a6c1e5b4ce9b">out_edge_iterator</a>;
<a name="l00653"></a>00653 
<a name="l00654"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ac6e9b721a8d292d0bf8a03d2acefab71">00654</a>         <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ac6e9b721a8d292d0bf8a03d2acefab71">OptimizeGraph</a>( TGraph&amp; graph )
<a name="l00655"></a>00655                 : <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>( graph )
<a name="l00656"></a>00656         {
<a name="l00657"></a>00657         }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659         <span class="keyword">template</span> &lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00660"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a93c186ddf364863c2783c0d4764fc1d3">00660</a>         <span class="keywordtype">void</span> <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a93c186ddf364863c2783c0d4764fc1d3">finish_vertex</a>( VertexDescriptor v, <span class="keyword">const</span> <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00661"></a>00661         {
<a name="l00662"></a>00662                 <span class="keyword">using namespace </span>boost;
<a name="l00663"></a>00663                 <span class="keyword">using namespace </span>boost::graph;
<a name="l00664"></a>00664                 <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ae919a9b00f7c895439465213a23f6689">Vertex</a>&amp; vertex = <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>.instance( v );
<a name="l00665"></a>00665 
<a name="l00666"></a>00666                 <a class="code" href="../../d5/ddb/classtuttle_1_1host_1_1graph_1_1ProcessVertexAtTimeData.html">ProcessVertexAtTimeData</a>&amp; procOptions = vertex.getProcessDataAtTime();
<a name="l00667"></a>00667                 <span class="keywordflow">if</span>( !vertex.isFake() )
<a name="l00668"></a>00668                 {
<a name="l00669"></a>00669                         <span class="comment">// compute local infos, need to be a real node !</span>
<a name="l00670"></a>00670                         vertex.getProcessNode().preProcess_infos( vertex.getProcessDataAtTime(), procOptions._time, procOptions._localInfos );
<a name="l00671"></a>00671                 }
<a name="l00672"></a>00672 
<a name="l00673"></a>00673                 <span class="comment">// compute global infos for inputs</span>
<a name="l00674"></a>00674 
<a name="l00675"></a>00675                 <span class="comment">// direct dependencies (originally the node inputs)</span>
<a name="l00676"></a>00676                 BOOST_FOREACH( <span class="keyword">const</span> <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a0044ce64610c923a977b42a629b2835e">edge_descriptor</a>&amp; oe, out_edges( v, <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>.getGraph() ) )
<a name="l00677"></a>00677                 {
<a name="l00678"></a>00678 <span class="comment">//                      Edge&amp; outEdge = _graph.instance(*oe);</span>
<a name="l00679"></a>00679                         <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ae919a9b00f7c895439465213a23f6689">Vertex</a>&amp; outVertex = <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>.targetInstance( oe );
<a name="l00680"></a>00680                         procOptions._inputsInfos += outVertex.getProcessDataAtTime()._localInfos;
<a name="l00681"></a>00681                         procOptions._globalInfos += outVertex.getProcessDataAtTime()._globalInfos;
<a name="l00682"></a>00682                 }
<a name="l00683"></a>00683                 procOptions._globalInfos += procOptions._localInfos;
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 <span class="comment">//              BOOST_FOREACH( const edge_descriptor&amp; ie, in_edges( v, _graph.getGraph() ) )</span>
<a name="l00686"></a>00686 <span class="comment">//              {</span>
<a name="l00687"></a>00687 <span class="comment">//                      Edge&amp; e = _graph.instance( ie );</span>
<a name="l00688"></a>00688 <span class="comment">//              }</span>
<a name="l00689"></a>00689 
<a name="l00690"></a>00690 
<a name="l00691"></a>00691 <span class="comment">//              TUTTLE_TLOG( TUTTLE_TRACE, vertex.getName() );</span>
<a name="l00692"></a>00692 <span class="comment">//              TUTTLE_TLOG( TUTTLE_TRACE, procOptions );</span>
<a name="l00693"></a>00693         }
<a name="l00694"></a>00694 
<a name="l00695"></a>00695 <span class="keyword">private</span>:
<a name="l00696"></a><a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">00696</a>         TGraph&amp; <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>;
<a name="l00697"></a>00697 };
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00700"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html">00700</a> <span class="keyword">class </span><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html">Process</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00701"></a>00701 {
<a name="l00702"></a>00702 <span class="keyword">public</span>:
<a name="l00703"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a7c1ef1171cab5c1ce5601791c7670ce9">00703</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a7c1ef1171cab5c1ce5601791c7670ce9">GraphContainer</a>;
<a name="l00704"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a25a959d5569dfc56a9772653b6aecf5e">00704</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a25a959d5569dfc56a9772653b6aecf5e">Vertex</a>;
<a name="l00705"></a>00705 
<a name="l00706"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#aafe6efe4cbf1b1e78ea22069a527dcca">00706</a>         <a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html">Process</a>( TGraph&amp; graph, <a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html">memory::IMemoryCache</a>&amp; cache )
<a name="l00707"></a>00707                 : <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>( graph )
<a name="l00708"></a>00708                 , _cache( cache )
<a name="l00709"></a>00709                 , _result( NULL )
<a name="l00710"></a>00710         {
<a name="l00711"></a>00711         }
<a name="l00712"></a>00712         
<a name="l00713"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a590ed8d8850c74f90c33c1615919f2ff">00713</a>         <a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html">Process</a>( TGraph&amp; graph, <a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html">memory::IMemoryCache</a>&amp; cache, <a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html">memory::IMemoryCache</a>&amp; result )
<a name="l00714"></a>00714                 : <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>( graph )
<a name="l00715"></a>00715                 , _cache( cache )
<a name="l00716"></a>00716                 , _result( &amp;result )
<a name="l00717"></a>00717         {
<a name="l00718"></a>00718         }
<a name="l00719"></a>00719         <span class="comment"></span>
<a name="l00720"></a>00720 <span class="comment">        /**</span>
<a name="l00721"></a>00721 <span class="comment">         * Set a MemoryCache object to accumulate output nodes buffers.</span>
<a name="l00722"></a>00722 <span class="comment">         */</span>
<a name="l00723"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a9c1c1337b61ee10e75b1464f858a0062">00723</a>         <span class="keywordtype">void</span> setOutputMemoryCache( <a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html">memory::IMemoryCache</a>&amp; result )
<a name="l00724"></a>00724         {
<a name="l00725"></a>00725                 _result = &amp;result;
<a name="l00726"></a>00726         }
<a name="l00727"></a>00727 
<a name="l00728"></a>00728         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00729"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#acbc0aac39fa803d54c63ab1494e4a021">00729</a>         <span class="keywordtype">void</span> <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a93c186ddf364863c2783c0d4764fc1d3">finish_vertex</a>( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00730"></a>00730         {
<a name="l00731"></a>00731                 <a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a25a959d5569dfc56a9772653b6aecf5e">Vertex</a>&amp; vertex = <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>.instance( v );
<a name="l00732"></a>00732                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Process] finish_vertex &quot;</span> &lt;&lt; vertex );
<a name="l00733"></a>00733 
<a name="l00734"></a>00734                 <span class="comment">// do nothing on the empty output node</span>
<a name="l00735"></a>00735                 <span class="comment">// it&#39;s just a link to final nodes</span>
<a name="l00736"></a>00736                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00737"></a>00737                         <span class="keywordflow">return</span>;
<a name="l00738"></a>00738 
<a name="l00739"></a>00739                 <span class="comment">// check if abort ?</span>
<a name="l00740"></a>00740 
<a name="l00741"></a>00741                 <span class="comment">// launch the process</span>
<a name="l00742"></a>00742                 boost::posix_time::ptime t1(boost::posix_time::microsec_clock::local_time());
<a name="l00743"></a>00743                 vertex.getProcessNode().process( vertex.getProcessDataAtTime() );
<a name="l00744"></a>00744                 boost::posix_time::ptime t2(boost::posix_time::microsec_clock::local_time());
<a name="l00745"></a>00745                 _cumulativeTime += t2 - t1;
<a name="l00746"></a>00746                 
<a name="l00747"></a>00747                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Process] &quot;</span> &lt;&lt; <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>(vertex._name) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vertex._data._time &lt;&lt; <span class="stringliteral">&quot; took: &quot;</span> &lt;&lt; t2 - t1 &lt;&lt; <span class="stringliteral">&quot; (cumul: &quot;</span> &lt;&lt; _cumulativeTime &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; vertex );
<a name="l00748"></a>00748                 
<a name="l00749"></a>00749                 <span class="keywordflow">if</span>( _result &amp;&amp; vertex.getProcessDataAtTime()._isFinalNode )
<a name="l00750"></a>00750                 {
<a name="l00751"></a>00751                         <a class="code" href="../../dd/df9/namespacetuttle_1_1host_1_1memory.html#a83a52ae53b31a1d624569267df52b9f2" title="configure the cache with this element CACHE_ELEMENT should be a smart_ptr of some kind pointer will b...">memory::CACHE_ELEMENT</a> img = _cache.get( vertex._clipName + <span class="stringliteral">&quot;.&quot;</span> kOfxOutputAttributeName, vertex._data._time );
<a name="l00752"></a>00752                         <span class="keywordflow">if</span>( ! img.get() )
<a name="l00753"></a>00753                         {
<a name="l00754"></a>00754                                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d6/d07/structtuttle_1_1exception_1_1Logic.html" title="Other exceptions.">exception::Logic</a>()
<a name="l00755"></a>00755                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#aeda7b771c5f326f3a5b8b2682ef7953d" title="Like a stringstream but using &quot;operator+&quot; instead of &quot;operator&lt;&lt;&quot;. Use a stringstream internally...">exception::user</a>() + <span class="stringliteral">&quot;Output buffer not found in memoryCache at the end of the node process.&quot;</span>
<a name="l00756"></a>00756                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#ac85e278687d5002c0367a0b9a1d9326f" title="This is detailed informations for developpers. Not always a real human readable message :)...">exception::dev</a>() + vertex._clipName + <span class="stringliteral">&quot;.&quot;</span> kOfxOutputAttributeName + <span class="stringliteral">&quot; at time &quot;</span> + vertex._data._time
<a name="l00757"></a>00757                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a4949ab8bfd6e7e076b31412f0fc77a70" title="Node name.">exception::nodeName</a>( vertex._name )
<a name="l00758"></a>00758                                         &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">exception::time</a>( vertex._data._time ) );
<a name="l00759"></a>00759                         }
<a name="l00760"></a>00760                         _result-&gt;put( vertex._clipName, vertex._data._time, img );
<a name="l00761"></a>00761                 }
<a name="l00762"></a>00762         }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764 <span class="keyword">private</span>:
<a name="l00765"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#aae1ea5fb5625a36c2e02f238d1f9d050">00765</a>         TGraph&amp; <a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#aae1ea5fb5625a36c2e02f238d1f9d050">_graph</a>;
<a name="l00766"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#acf17c646349c58d09ce272f576a44cc7">00766</a>         <a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html">memory::IMemoryCache</a>&amp; <a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#acf17c646349c58d09ce272f576a44cc7">_cache</a>;
<a name="l00767"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a25d0634b4f4f1990cfe830235ce0d136">00767</a>         <a class="code" href="../../d0/dfb/classtuttle_1_1host_1_1memory_1_1IMemoryCache.html">memory::IMemoryCache</a>* <a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a25d0634b4f4f1990cfe830235ce0d136">_result</a>;
<a name="l00768"></a><a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a41bef1c34b88085d954e1bcbc45f9ce4">00768</a>         boost::posix_time::time_duration <a class="code" href="../../d0/d56/classtuttle_1_1host_1_1graph_1_1visitor_1_1Process.html#a41bef1c34b88085d954e1bcbc45f9ce4">_cumulativeTime</a>;
<a name="l00769"></a>00769 };
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00772"></a><a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html">00772</a> <span class="keyword">class </span><a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html">PostProcess</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00773"></a>00773 {
<a name="l00774"></a>00774 <span class="keyword">public</span>:
<a name="l00775"></a><a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#aaa4f754d28d181fb0624cb56208b5569">00775</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::GraphContainer <a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#aaa4f754d28d181fb0624cb56208b5569">GraphContainer</a>;
<a name="l00776"></a><a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#a54c36e1505147f47b3b2f34dbe4bc8ba">00776</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#a54c36e1505147f47b3b2f34dbe4bc8ba">Vertex</a>;
<a name="l00777"></a>00777 
<a name="l00778"></a><a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#a09c4f253b08216c2824f446894ab2be8">00778</a>         <a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html">PostProcess</a>( TGraph&amp; graph )
<a name="l00779"></a>00779                 : <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>( graph )
<a name="l00780"></a>00780         {}
<a name="l00781"></a>00781 
<a name="l00782"></a>00782         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00783"></a><a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#a21899274be614a9b86fb88108caab377">00783</a>         <span class="keywordtype">void</span> initialize_vertex( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00784"></a>00784         {
<a name="l00785"></a>00785                 <a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#a54c36e1505147f47b3b2f34dbe4bc8ba">Vertex</a>&amp; vertex = <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>.instance( v );
<a name="l00786"></a>00786 
<a name="l00787"></a>00787                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>,<span class="stringliteral">&quot;[Post-process] initialize_vertex &quot;</span> &lt;&lt; vertex );
<a name="l00788"></a>00788                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00789"></a>00789                         <span class="keywordflow">return</span>;
<a name="l00790"></a>00790         }
<a name="l00791"></a>00791 
<a name="l00792"></a>00792         <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00793"></a><a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#ab3bf7e97b6e43f2d40f3a35126bd039e">00793</a>         <span class="keywordtype">void</span> <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a93c186ddf364863c2783c0d4764fc1d3">finish_vertex</a>( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00794"></a>00794         {
<a name="l00795"></a>00795                 <a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#a54c36e1505147f47b3b2f34dbe4bc8ba">Vertex</a>&amp; vertex = <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>.instance( v );
<a name="l00796"></a>00796 
<a name="l00797"></a>00797                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a691b7acfcc9541fdcafb799f6a4e1721">TUTTLE_TLOG</a>( <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#aeca14b63155317c001124f58def8af67">TUTTLE_TRACE</a>, <span class="stringliteral">&quot;[Post-process] finish_vertex &quot;</span> &lt;&lt; vertex );
<a name="l00798"></a>00798                 <span class="keywordflow">if</span>( vertex.isFake() )
<a name="l00799"></a>00799                         <span class="keywordflow">return</span>;
<a name="l00800"></a>00800 
<a name="l00801"></a>00801                 vertex.getProcessNode().postProcess( vertex.getProcessDataAtTime() );
<a name="l00802"></a>00802         }
<a name="l00803"></a>00803 
<a name="l00804"></a>00804 <span class="keyword">private</span>:
<a name="l00805"></a><a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#afa2ed3bcd3760e41fb06c576d773d47e">00805</a>         TGraph&amp; <a class="code" href="../../d3/dd7/classtuttle_1_1host_1_1graph_1_1visitor_1_1PostProcess.html#afa2ed3bcd3760e41fb06c576d773d47e">_graph</a>;
<a name="l00806"></a>00806 };
<a name="l00807"></a>00807 
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TGraph&gt;
<a name="l00810"></a><a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html">00810</a> <span class="keyword">class </span><a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html">BeforeRenderCallbackVisitor</a> : <span class="keyword">public</span> boost::default_dfs_visitor
<a name="l00811"></a>00811 {
<a name="l00812"></a>00812 <span class="keyword">public</span>:
<a name="l00813"></a><a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html#a345507bcfb0eea8c219e517c6a3d7d86">00813</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> TGraph::Vertex <a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html#a345507bcfb0eea8c219e517c6a3d7d86">Vertex</a>;
<a name="l00814"></a><a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html#ab525ce76449b5dbe201522f758cc83cb">00814</a>     <a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html">BeforeRenderCallbackVisitor</a>( TGraph&amp; graph )
<a name="l00815"></a>00815         : <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>( graph )
<a name="l00816"></a>00816     {}
<a name="l00817"></a>00817 
<a name="l00818"></a>00818     <span class="keyword">template</span>&lt;<span class="keyword">class</span> VertexDescriptor, <span class="keyword">class</span> Graph&gt;
<a name="l00819"></a><a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html#ae62742a9ea319d44a399b6ff7539f535">00819</a>     <span class="keywordtype">void</span> <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#a93c186ddf364863c2783c0d4764fc1d3">finish_vertex</a>( VertexDescriptor v, <a class="code" href="../../d8/d72/classtuttle_1_1host_1_1Graph.html" title="A user graph to manipulate OpenFX nodes.">Graph</a>&amp; g )
<a name="l00820"></a>00820     {
<a name="l00821"></a>00821         <a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html#a345507bcfb0eea8c219e517c6a3d7d86">Vertex</a>&amp; vertex = <a class="code" href="../../d5/d12/classtuttle_1_1host_1_1graph_1_1visitor_1_1OptimizeGraph.html#ab3aaee8deb11d6b8fea318dbab5e24f9">_graph</a>.instance( v );
<a name="l00822"></a>00822                 <span class="keywordflow">if</span>( !vertex.isFake() )
<a name="l00823"></a>00823                 {
<a name="l00824"></a>00824             vertex.getProcessNode().beforeRenderCallback( vertex.getProcessNode(), vertex.getProcessDataAtTime() );
<a name="l00825"></a>00825         }
<a name="l00826"></a>00826     }
<a name="l00827"></a>00827 
<a name="l00828"></a>00828 <span class="keyword">private</span>:
<a name="l00829"></a><a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html#a5528b0d2f8b5930ae7e4333a1205a024">00829</a>         TGraph&amp; <a class="code" href="../../d6/d33/classtuttle_1_1host_1_1graph_1_1visitor_1_1BeforeRenderCallbackVisitor.html#a5528b0d2f8b5930ae7e4333a1205a024">_graph</a>;
<a name="l00830"></a>00830 };
<a name="l00831"></a>00831 
<a name="l00832"></a>00832 
<a name="l00833"></a>00833 }
<a name="l00834"></a>00834 }
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 }
<a name="l00837"></a>00837 
<a name="l00838"></a>00838 <span class="preprocessor">#endif</span>
<a name="l00839"></a>00839 <span class="preprocessor"></span>
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../dc/d0f/ProcessVisitors_8hpp.html">ProcessVisitors.hpp</a>      </li>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
