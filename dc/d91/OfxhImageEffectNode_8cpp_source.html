<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TuttleOFX: TuttleOFX/libraries/tuttle/src/tuttle/host/ofx/OfxhImageEffectNode.cpp Source File</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">TuttleOFX
   &#160;<span id="projectnumber">1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('dc/d91/OfxhImageEffectNode_8cpp.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">TuttleOFX/libraries/tuttle/src/tuttle/host/ofx/OfxhImageEffectNode.cpp</div>  </div>
</div>
<div class="contents">
<a href="../../dc/d91/OfxhImageEffectNode_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Software License :</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright (c) 2007-2009, The Open Effects Association Ltd. All rights reserved.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00007"></a>00007 <span class="comment"> * modification, are permitted provided that the following conditions are met:</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * Redistributions of source code must retain the above copyright notice,</span>
<a name="l00010"></a>00010 <span class="comment"> *    this list of conditions and the following disclaimer.</span>
<a name="l00011"></a>00011 <span class="comment"> * Redistributions in binary form must reproduce the above copyright notice,</span>
<a name="l00012"></a>00012 <span class="comment"> *    this list of conditions and the following disclaimer in the documentation</span>
<a name="l00013"></a>00013 <span class="comment"> *    and/or other materials provided with the distribution.</span>
<a name="l00014"></a>00014 <span class="comment"> * Neither the name The Open Effects Association Ltd, nor the names of its</span>
<a name="l00015"></a>00015 <span class="comment"> *    contributors may be used to endorse or promote products derived from this</span>
<a name="l00016"></a>00016 <span class="comment"> *    software without specific prior written permission.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND</span>
<a name="l00019"></a>00019 <span class="comment"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<a name="l00020"></a>00020 <span class="comment"> * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a name="l00021"></a>00021 <span class="comment"> * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR</span>
<a name="l00022"></a>00022 <span class="comment"> * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<a name="l00023"></a>00023 <span class="comment"> * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<a name="l00024"></a>00024 <span class="comment"> * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON</span>
<a name="l00025"></a>00025 <span class="comment"> * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00026"></a>00026 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<a name="l00027"></a>00027 <span class="comment"> * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00028"></a>00028 <span class="comment"> */</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="comment">// ofx host</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d09/OfxhBinary_8hpp.html">OfxhBinary.hpp</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d4d/OfxhMemory_8hpp.html">OfxhMemory.hpp</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/db7/OfxhImageEffectNode_8hpp.html">OfxhImageEffectNode.hpp</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dc4/OfxhPluginAPICache_8hpp.html">OfxhPluginAPICache.hpp</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d7/de6/OfxhPluginCache_8hpp.html">OfxhPluginCache.hpp</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d9a/OfxhHost_8hpp.html">OfxhHost.hpp</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7f/OfxhImageEffectPlugin_8hpp.html">OfxhImageEffectPlugin.hpp</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/dda/OfxhUtilities_8hpp.html">OfxhUtilities.hpp</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d05/OfxhClip_8hpp.html">attribute/OfxhClip.hpp</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/dda/OfxhParam_8hpp.html">attribute/OfxhParam.hpp</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d25/OfxhParamGroup_8hpp.html">attribute/OfxhParamGroup.hpp</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="../../db/dd1/OfxhParamDouble_8hpp.html">attribute/OfxhParamDouble.hpp</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="../../d9/dd6/OfxhSet_8hpp.html">property/OfxhSet.hpp</a>&quot;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="../../d7/d38/Core_8hpp.html">tuttle/host/Core.hpp</a>&gt;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="comment">// ofx</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;ofxCore.h&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;ofxImageEffect.h&gt;</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;cstring&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;cstdarg&gt;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="keyword">namespace </span>tuttle {
<a name="l00056"></a>00056 <span class="keyword">namespace </span>host {
<a name="l00057"></a>00057 <span class="keyword">namespace </span>ofx {
<a name="l00058"></a>00058 <span class="keyword">namespace </span>imageEffect {
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="../../d3/d9f/namespacetuttle_1_1host_1_1ofx_1_1imageEffect.html#a8701cddc601eb497d23360cc43540fb0">00060</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> <a class="code" href="../../d3/d9f/namespacetuttle_1_1host_1_1ofx_1_1imageEffect.html#a8701cddc601eb497d23360cc43540fb0">effectInstanceStuff</a>[] = {
<a name="l00061"></a>00061         <span class="comment">/* name                                 type                   dim.   r/o    default value */</span>
<a name="l00062"></a>00062         { kOfxPropType, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, kOfxTypeImageEffectInstance },
<a name="l00063"></a>00063         { kOfxPropName, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;UNIQUE_NAME_NOT_SET&quot;</span> },
<a name="l00064"></a>00064         { kOfxImageEffectPropContext, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l00065"></a>00065         { kOfxPropInstanceData, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca3924e5113f71bf582c94cfda0ba7f187">property::ePropTypePointer</a>, 1, <span class="keyword">false</span>, NULL },
<a name="l00066"></a>00066         { kOfxImageEffectPropPluginHandle, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca3924e5113f71bf582c94cfda0ba7f187">property::ePropTypePointer</a>, 1, <span class="keyword">false</span>, NULL },
<a name="l00067"></a>00067         { kOfxImageEffectPropProjectSize, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00068"></a>00068         { kOfxImageEffectPropProjectOffset, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00069"></a>00069         { kOfxImageEffectPropProjectExtent, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00070"></a>00070         { kOfxImageEffectPropProjectPixelAspectRatio, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00071"></a>00071         { kOfxImageEffectInstancePropEffectDuration, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00072"></a>00072         { kOfxImageEffectInstancePropSequentialRender, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad11c9ca0c013713d6c2bcc029586c61c">property::ePropTypeInt</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00073"></a>00073         { kOfxImageEffectPropFrameRate, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00074"></a>00074         { kOfxPropIsInteractive, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad11c9ca0c013713d6c2bcc029586c61c">property::ePropTypeInt</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00075"></a>00075         { 0 }
<a name="l00076"></a>00076 };
<a name="l00077"></a>00077 
<a name="l00078"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5af1a90765350e4c9f6d14a7c88900f7">00078</a> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5af1a90765350e4c9f6d14a7c88900f7" title="constructor based on clip descriptor">OfxhImageEffectNode::OfxhImageEffectNode</a>( <span class="keyword">const</span> <a class="code" href="../../df/d5d/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectPlugin.html">OfxhImageEffectPlugin</a>&amp;         plugin,
<a name="l00079"></a>00079                                           <span class="keyword">const</span> <a class="code" href="../../de/de4/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeDescriptor.html">OfxhImageEffectNodeDescriptor</a>&amp; descriptor,
<a name="l00080"></a>00080                                           <span class="keyword">const</span> std::string&amp;                   context,
<a name="l00081"></a>00081                                           <span class="keywordtype">bool</span>                                 interactive )
<a name="l00082"></a>00082         : <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html">OfxhImageEffectNodeBase</a>( <a class="code" href="../../d3/d9f/namespacetuttle_1_1host_1_1ofx_1_1imageEffect.html#a8701cddc601eb497d23360cc43540fb0">effectInstanceStuff</a> )
<a name="l00083"></a>00083         , _plugin( plugin )
<a name="l00084"></a>00084         , _context( context )
<a name="l00085"></a>00085         , _descriptor( descriptor )
<a name="l00086"></a>00086         , _interactive( interactive )
<a name="l00087"></a>00087         , _created( false )
<a name="l00088"></a>00088         , _continuousSamples( false )
<a name="l00089"></a>00089         , _frameVarying( false )
<a name="l00090"></a>00090         , _outputFrameRate( 0 )
<a name="l00091"></a>00091 {
<a name="l00092"></a>00092         <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6780cf0108c92b9416a43c8e00e06c19">_properties</a>.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#ab1707488b9c87c786ae90a04c31bc5c5" title="set the chained property set">setChainedSet</a>( &amp;descriptor.<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ae5aece28ee4518c45899d38181a1008d">getProperties</a>() );
<a name="l00093"></a>00093 
<a name="l00094"></a>00094         <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6780cf0108c92b9416a43c8e00e06c19">_properties</a>.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a5e9bd143d801d10f9379dbf83b57340b" title="get a particular double property">setPointerProperty</a>( kOfxImageEffectPropPluginHandle, const_cast&lt;OfxPlugin*&gt;( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a55fdd9759a4f56ce4f9fa1753def426d">_plugin</a>.<a class="code" href="../../df/d5d/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectPlugin.html#a9cb2dbb8b6d6beb74f9fc7519e71e169">getPluginLoadGuardPtr</a>()-&gt;<a class="code" href="../../da/d09/classtuttle_1_1host_1_1ofx_1_1OfxhPluginLoadGuard.html#ae48367616acfdadf12cebbd25969462a">getOfxPlugin</a>() ) );
<a name="l00095"></a>00095 
<a name="l00096"></a>00096         <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6780cf0108c92b9416a43c8e00e06c19">_properties</a>.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a32654a6d0ff3bebe697b2836c255f940" title="set a particular string property without fetching via a get hook, useful for notifies">setStringProperty</a>( kOfxImageEffectPropContext, context );
<a name="l00097"></a>00097         <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6780cf0108c92b9416a43c8e00e06c19">_properties</a>.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2110c0e43429db10446b7fa0a7f62dd1" title="set a particular int property">setIntProperty</a>( kOfxPropIsInteractive, interactive );
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         <span class="comment">// copy is sequential over</span>
<a name="l00100"></a>00100         <span class="keywordtype">bool</span> sequential = descriptor.<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ae5aece28ee4518c45899d38181a1008d">getProperties</a>().<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a93aa0eb3c85c46638935cd97331ed87f" title="get the value of a particular int property">getIntProperty</a>( kOfxImageEffectInstancePropSequentialRender ) != 0;
<a name="l00101"></a>00101         <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6780cf0108c92b9416a43c8e00e06c19">_properties</a>.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2110c0e43429db10446b7fa0a7f62dd1" title="set a particular int property">setIntProperty</a>( kOfxImageEffectInstancePropSequentialRender, sequential );
<a name="l00102"></a>00102 
<a name="l00103"></a>00103         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a337321204b17bb56c6a4446c938525a5">initHook</a>();
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a337321204b17bb56c6a4446c938525a5">00106</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a337321204b17bb56c6a4446c938525a5">OfxhImageEffectNode::initHook</a>()
<a name="l00107"></a>00107 {
<a name="l00108"></a>00108         <span class="keywordtype">int</span> i = 0;
<a name="l00109"></a>00109         
<a name="l00110"></a>00110         <span class="keywordflow">while</span>( <a class="code" href="../../d3/d9f/namespacetuttle_1_1host_1_1ofx_1_1imageEffect.html#a8701cddc601eb497d23360cc43540fb0">effectInstanceStuff</a>[i].name )
<a name="l00111"></a>00111         {
<a name="l00112"></a>00112                 <span class="comment">// don&#39;t set hooks for context or isinteractive</span>
<a name="l00113"></a>00113                 <span class="keywordflow">if</span>( strcmp( <a class="code" href="../../d3/d9f/namespacetuttle_1_1host_1_1ofx_1_1imageEffect.html#a8701cddc601eb497d23360cc43540fb0">effectInstanceStuff</a>[i].name, kOfxImageEffectPropContext ) &amp;&amp;
<a name="l00114"></a>00114                     strcmp( <a class="code" href="../../d3/d9f/namespacetuttle_1_1host_1_1ofx_1_1imageEffect.html#a8701cddc601eb497d23360cc43540fb0">effectInstanceStuff</a>[i].name, kOfxPropIsInteractive ) &amp;&amp;
<a name="l00115"></a>00115                     strcmp( <a class="code" href="../../d3/d9f/namespacetuttle_1_1host_1_1ofx_1_1imageEffect.html#a8701cddc601eb497d23360cc43540fb0">effectInstanceStuff</a>[i].name, kOfxImageEffectInstancePropSequentialRender ) )
<a name="l00116"></a>00116                 {
<a name="l00117"></a>00117                         <span class="keyword">const</span> <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a>&amp; spec = <a class="code" href="../../d3/d9f/namespacetuttle_1_1host_1_1ofx_1_1imageEffect.html#a8701cddc601eb497d23360cc43540fb0">effectInstanceStuff</a>[i];
<a name="l00118"></a>00118 
<a name="l00119"></a>00119                         <span class="keywordflow">switch</span>( spec.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#aa3ed56d1968fd8856a78e922673077bc" title="type">type</a> )
<a name="l00120"></a>00120                         {
<a name="l00121"></a>00121                                 <span class="keywordflow">case</span> <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>:
<a name="l00122"></a>00122                                         <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6780cf0108c92b9416a43c8e00e06c19">_properties</a>.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a928825357ab919e941e4e2897c510ed4">setGetHook</a>( spec.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#a021c01e9ec9e82c88e122faca33575f6" title="name of the property">name</a>, <span class="keyword">this</span> );
<a name="l00123"></a>00123                                         <span class="keywordflow">break</span>;
<a name="l00124"></a>00124                                 <span class="keywordflow">default</span>:
<a name="l00125"></a>00125                                         <span class="keywordflow">break</span>;
<a name="l00126"></a>00126                         }
<a name="l00127"></a>00127                 }
<a name="l00128"></a>00128                 ++i;
<a name="l00129"></a>00129         }
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ad354eabb24cee5aaa91f225b79e868a0">00132</a> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5af1a90765350e4c9f6d14a7c88900f7" title="constructor based on clip descriptor">OfxhImageEffectNode::OfxhImageEffectNode</a>( <span class="keyword">const</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html">OfxhImageEffectNode</a>&amp; other )
<a name="l00133"></a>00133         : <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html">OfxhImageEffectNodeBase</a>( other.getProperties() )
<a name="l00134"></a>00134         <span class="comment">//, attribute::OfxhParamSet( other ) // done in populate function</span>
<a name="l00135"></a>00135         <span class="comment">//, attribute::OfxhClipImageSet( other ) // done in populate function</span>
<a name="l00136"></a>00136         , _plugin( other.getPlugin() )
<a name="l00137"></a>00137         , _context( other.getContext() )
<a name="l00138"></a>00138         , _descriptor( other.getDescriptor() )
<a name="l00139"></a>00139         , _interactive( other._interactive )
<a name="l00140"></a>00140         , _created( false )
<a name="l00141"></a>00141         , _continuousSamples( other._continuousSamples )
<a name="l00142"></a>00142         , _frameVarying( other._frameVarying )
<a name="l00143"></a>00143         , _outputFrameRate( other._outputFrameRate )
<a name="l00144"></a>00144 {
<a name="l00145"></a>00145         <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6780cf0108c92b9416a43c8e00e06c19">_properties</a>.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#ab1707488b9c87c786ae90a04c31bc5c5" title="set the chained property set">setChainedSet</a>( &amp;<a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a453d891adc8e0937b7920682ece735fa">_descriptor</a>.<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ae5aece28ee4518c45899d38181a1008d">getProperties</a>() );
<a name="l00146"></a>00146         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a337321204b17bb56c6a4446c938525a5">initHook</a>();
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 <span class="comment"></span>
<a name="l00149"></a>00149 <span class="comment">/**</span>
<a name="l00150"></a>00150 <span class="comment"> * called after construction to populate clips and params</span>
<a name="l00151"></a>00151 <span class="comment"> */</span>
<a name="l00152"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aae3d7cf597d81416835c4eec7644d590">00152</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aae3d7cf597d81416835c4eec7644d590">OfxhImageEffectNode::populate</a>()
<a name="l00153"></a>00153 {
<a name="l00154"></a>00154         <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a2e5e0e70410ecd18d78d8c9bb700af06">populateClips</a>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a453d891adc8e0937b7920682ece735fa">_descriptor</a> );
<a name="l00155"></a>00155         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aeed92c200e21762de2e94665f94e10ec">populateParams</a>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a453d891adc8e0937b7920682ece735fa">_descriptor</a> );
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 <span class="comment"></span>
<a name="l00158"></a>00158 <span class="comment">/**</span>
<a name="l00159"></a>00159 <span class="comment"> * @todo tuttle: move this in ParamSet !</span>
<a name="l00160"></a>00160 <span class="comment"> */</span>
<a name="l00161"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aeed92c200e21762de2e94665f94e10ec">00161</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aeed92c200e21762de2e94665f94e10ec">OfxhImageEffectNode::populateParams</a>( <span class="keyword">const</span> <a class="code" href="../../de/de4/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeDescriptor.html">imageEffect::OfxhImageEffectNodeDescriptor</a>&amp; descriptor )
<a name="l00162"></a>00162 {
<a name="l00163"></a>00163         <span class="keyword">const</span> <a class="code" href="../../dc/de0/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSetDescriptor.html#a0a7234c526cef88303cf78a003c695d7">attribute::OfxhParamSetDescriptor::ParamDescriptorList</a>&amp; paramDescriptors = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a453d891adc8e0937b7920682ece735fa">_descriptor</a>.<a class="code" href="../../dc/de0/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSetDescriptor.html#aa5e6aa9c95806fe220e12a21187591ab" title="get the list of params">getParamList</a>();
<a name="l00164"></a>00164 
<a name="l00165"></a>00165         this-&gt;<a class="code" href="../../d0/d5e/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSet.html#af779e2b6c217df7a7b3201a3b3e0dc73">reserveParameters</a>( paramDescriptors.size() );
<a name="l00166"></a>00166 
<a name="l00167"></a>00167         <span class="comment">// Create parameters on their own groups</span>
<a name="l00168"></a>00168         <span class="keywordflow">for</span>( attribute::OfxhParamSetDescriptor::ParamDescriptorList::const_iterator it = paramDescriptors.begin(), itEnd = paramDescriptors.end();
<a name="l00169"></a>00169              it != itEnd;
<a name="l00170"></a>00170              ++it )
<a name="l00171"></a>00171         {
<a name="l00172"></a>00172                 <span class="comment">// SetInstance where the childrens param instances will be added</span>
<a name="l00173"></a>00173                 <span class="keyword">const</span> <a class="code" href="../../dd/d39/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamDescriptor.html" title="the Descriptor of a plugin parameter">attribute::OfxhParamDescriptor</a>&amp; descriptor = *it;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175                 <span class="comment">// get a param instance from a param descriptor.</span>
<a name="l00176"></a>00176                 <a class="code" href="../../d1/dfc/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParam.html" title="plugin parameter instance">attribute::OfxhParam</a>* paramInstance = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ac72bb6e1e6baa2727bb5d38e9ae4f3b4">newParam</a>( descriptor );
<a name="l00177"></a>00177 
<a name="l00178"></a>00178                 <span class="comment">// This param instance is added into the right parent ParamSet.</span>
<a name="l00179"></a>00179                 <span class="keyword">const</span> std::string parentName = descriptor.<a class="code" href="../../d7/d9d/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamAccessor.html#a0a5063b0025f701ad531e73a986136b7">getParentName</a>();
<a name="l00180"></a>00180                 <a class="code" href="../../d0/d5e/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSet.html">attribute::OfxhParamSet</a>* parentParamSet = <span class="keyword">this</span>;
<a name="l00181"></a>00181                 <span class="comment">// Find the parent group, by default it&#39;s the node itself</span>
<a name="l00182"></a>00182                 <span class="keywordflow">if</span>( parentName != <span class="stringliteral">&quot;&quot;</span> )
<a name="l00183"></a>00183                 {
<a name="l00184"></a>00184                         <span class="keywordflow">try</span>
<a name="l00185"></a>00185                         {
<a name="l00186"></a>00186                                 <a class="code" href="../../dc/d44/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamGroup.html">attribute::OfxhParamGroup</a>&amp; parentGroup = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../dc/d44/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamGroup.html">attribute::OfxhParamGroup</a>&amp;<span class="keyword">&gt;</span>( <a class="code" href="../../d0/d5e/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSet.html#a625c8aa40ce2bacd36b64713beb32236">getParam</a>(parentName) );
<a name="l00187"></a>00187                                 parentParamSet = &amp;parentGroup;
<a name="l00188"></a>00188                         }
<a name="l00189"></a>00189                         <span class="keywordflow">catch</span>(...)
<a name="l00190"></a>00190                         {
<a name="l00191"></a>00191                                 <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a537f5ef82227ea4bd3fb08976c92eb02">TUTTLE_LOG_WARNING</a>(
<a name="l00192"></a>00192                                         <span class="stringliteral">&quot;The parameter &quot;</span> &lt;&lt; <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>(descriptor.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a5dd0b6a71e059db4f3eaa1bf23b208d8">getName</a>()) &lt;&lt;
<a name="l00193"></a>00193                                         <span class="stringliteral">&quot; is declared inside the group parameter &quot;</span> &lt;&lt; <a class="code" href="../../d2/d7f/namespacetuttle.html#a87ac1f9750141f52daffed18951b58be">quotes</a>(parentName) &lt;&lt;
<a name="l00194"></a>00194                                         <span class="stringliteral">&quot;, but this group parameter is not recognized. &quot;</span>
<a name="l00195"></a>00195                                         <span class="stringliteral">&quot;This is probably an error in the plugin.&quot;</span>
<a name="l00196"></a>00196                                         );
<a name="l00197"></a>00197                         }
<a name="l00198"></a>00198                 }
<a name="l00199"></a>00199                 <span class="comment">// declare the new param instance to the corresponding paramGroup.</span>
<a name="l00200"></a>00200                 parentParamSet-&gt;<a class="code" href="../../d0/d5e/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSet.html#a2a33dfad026b1c8374dcee9bc6c4adbb" title="reference a param">declareChildParam</a>( *paramInstance );
<a name="l00201"></a>00201         }
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 <span class="comment"></span>
<a name="l00204"></a>00204 <span class="comment">/**</span>
<a name="l00205"></a>00205 <span class="comment"> * @todo tuttle check clip ? check hash ? etc.</span>
<a name="l00206"></a>00206 <span class="comment"> */</span>
<a name="l00207"></a>00207 <span class="keywordtype">bool</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a0012d4dff891eeee7c31ef402dbd6c96">OfxhImageEffectNode::operator==</a>( <span class="keyword">const</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html">OfxhImageEffectNode</a>&amp; other )<span class="keyword"> const</span>
<a name="l00208"></a>00208 <span class="keyword"></span>{
<a name="l00209"></a>00209         <span class="keywordflow">if</span>( OfxhImageEffectNodeBase::operator!=( other ) )
<a name="l00210"></a>00210                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00211"></a>00211         <span class="keywordflow">if</span>( attribute::OfxhParamSet::operator!=( other ) )
<a name="l00212"></a>00212                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00213"></a>00213         <span class="keywordflow">if</span>( attribute::OfxhClipImageSet::operator!=( other ) )
<a name="l00214"></a>00214                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00215"></a>00215         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 <span class="comment"></span>
<a name="l00218"></a>00218 <span class="comment">/**</span>
<a name="l00219"></a>00219 <span class="comment"> * implemented for Param::SetDescriptor</span>
<a name="l00220"></a>00220 <span class="comment"> */</span>
<a name="l00221"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1f1cce5d10cca436e674b7174bcdbf1a">00221</a> <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a>&amp; <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1f1cce5d10cca436e674b7174bcdbf1a" title="implemented for Param::SetInstance">OfxhImageEffectNode::getParamSetProps</a>()
<a name="l00222"></a>00222 {
<a name="l00223"></a>00223         <span class="keywordflow">return</span> <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6780cf0108c92b9416a43c8e00e06c19">_properties</a>;
<a name="l00224"></a>00224 }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 <span class="comment">// do nothing</span>
<a name="l00227"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a0be31dbe585ccc4e05e6666b6730ada5">00227</a> <span class="keywordtype">size_t</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a0be31dbe585ccc4e05e6666b6730ada5" title="override this to fetch the dimension size.">OfxhImageEffectNode::getDimension</a>( <span class="keyword">const</span> std::string&amp; name ) <span class="keyword">const</span> <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a36567444f862fa5f19d4fcea81effce6">TUTTLE_LOG_ERROR</a>( <span class="stringliteral">&quot;failing in &quot;</span> &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; <span class="stringliteral">&quot; with name=&quot;</span> &lt;&lt; name );
<a name="l00230"></a>00230         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrMissingHostFeature ) );
<a name="l00231"></a>00231         <span class="keywordflow">return</span> 0;
<a name="l00232"></a>00232 }
<a name="l00233"></a>00233 
<a name="l00234"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a3be7789543c58ad8584cafb213e56e76">00234</a> <span class="keywordtype">size_t</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a3be7789543c58ad8584cafb213e56e76">OfxhImageEffectNode::upperGetDimension</a>( <span class="keyword">const</span> std::string&amp; name )
<a name="l00235"></a>00235 {
<a name="l00236"></a>00236         <span class="keywordflow">return</span> <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6780cf0108c92b9416a43c8e00e06c19">_properties</a>.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a28303829c305482437c8e12cb1b8c996" title="get the dimension of a particular property">getDimension</a>( name );
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 
<a name="l00239"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#adf4a452dddd4a0cfc8fb0399ff8a923a">00239</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#adf4a452dddd4a0cfc8fb0399ff8a923a" title="overridden from Property::Notify">OfxhImageEffectNode::notify</a>( <span class="keyword">const</span> std::string&amp; name, <span class="keywordtype">bool</span> singleValue, <span class="keywordtype">int</span> indexOrN ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00240"></a>00240 {
<a name="l00241"></a>00241         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a36567444f862fa5f19d4fcea81effce6">TUTTLE_LOG_ERROR</a>( <span class="stringliteral">&quot;failing in &quot;</span> &lt;&lt; __PRETTY_FUNCTION__ );
<a name="l00242"></a>00242 }
<a name="l00243"></a>00243 <span class="comment"></span>
<a name="l00244"></a>00244 <span class="comment">/**</span>
<a name="l00245"></a>00245 <span class="comment"> * don&#39;t know what to do</span>
<a name="l00246"></a>00246 <span class="comment"> */</span>
<a name="l00247"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aef8c55cb5b848216d44d4dff9ca3e12e">00247</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aef8c55cb5b848216d44d4dff9ca3e12e" title="overridden from gethook, don&#39;t know what to do">OfxhImageEffectNode::reset</a>( <span class="keyword">const</span> std::string&amp; name ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00248"></a>00248 {
<a name="l00249"></a>00249         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a36567444f862fa5f19d4fcea81effce6">TUTTLE_LOG_ERROR</a>( <span class="stringliteral">&quot;failing in &quot;</span> &lt;&lt; __PRETTY_FUNCTION__ );
<a name="l00250"></a>00250         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrMissingHostFeature ) );
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 <span class="comment"></span>
<a name="l00253"></a>00253 <span class="comment">/**</span>
<a name="l00254"></a>00254 <span class="comment"> * get the virtuals for viewport size, pixel scale, background colour</span>
<a name="l00255"></a>00255 <span class="comment"> */</span>
<a name="l00256"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#adb828a03e6f476243e0c997bb241ef1e">00256</a> <span class="keywordtype">double</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#adb828a03e6f476243e0c997bb241ef1e" title="overridden from gethook, get the virtuals for viewport size, pixel scale, background colour...">OfxhImageEffectNode::getDoubleProperty</a>( <span class="keyword">const</span> std::string&amp; name, <span class="keywordtype">int</span> index ) <span class="keyword">const</span> <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00257"></a>00257 {
<a name="l00258"></a>00258         <span class="keywordflow">if</span>( name == kOfxImageEffectPropProjectSize )
<a name="l00259"></a>00259         {
<a name="l00260"></a>00260                 <span class="keywordflow">if</span>( index &gt;= 2 )
<a name="l00261"></a>00261                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00262"></a>00262                 <span class="keywordtype">double</span> values[2];
<a name="l00263"></a>00263                 getProjectSize( values[0], values[1] );
<a name="l00264"></a>00264                 <span class="keywordflow">return</span> values[index];
<a name="l00265"></a>00265         }
<a name="l00266"></a>00266         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectPropProjectOffset )
<a name="l00267"></a>00267         {
<a name="l00268"></a>00268                 <span class="keywordflow">if</span>( index &gt;= 2 )
<a name="l00269"></a>00269                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00270"></a>00270                 <span class="keywordtype">double</span> values[2];
<a name="l00271"></a>00271                 getProjectOffset( values[0], values[1] );
<a name="l00272"></a>00272                 <span class="keywordflow">return</span> values[index];
<a name="l00273"></a>00273         }
<a name="l00274"></a>00274         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectPropProjectExtent )
<a name="l00275"></a>00275         {
<a name="l00276"></a>00276                 <span class="keywordflow">if</span>( index &gt;= 2 )
<a name="l00277"></a>00277                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00278"></a>00278                 <span class="keywordtype">double</span> values[2];
<a name="l00279"></a>00279                 getProjectExtent( values[0], values[1] );
<a name="l00280"></a>00280                 <span class="keywordflow">return</span> values[index];
<a name="l00281"></a>00281         }
<a name="l00282"></a>00282         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectPropProjectPixelAspectRatio )
<a name="l00283"></a>00283         {
<a name="l00284"></a>00284                 <span class="keywordflow">if</span>( index &gt;= 1 )
<a name="l00285"></a>00285                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00286"></a>00286                 <span class="keywordflow">return</span> getOutputPixelAspectRatio();
<a name="l00287"></a>00287         }
<a name="l00288"></a>00288         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectInstancePropEffectDuration )
<a name="l00289"></a>00289         {
<a name="l00290"></a>00290                 <span class="keywordflow">if</span>( index &gt;= 1 )
<a name="l00291"></a>00291                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00292"></a>00292                 <span class="keywordflow">return</span> getEffectDuration();
<a name="l00293"></a>00293         }
<a name="l00294"></a>00294         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectPropFrameRate )
<a name="l00295"></a>00295         {
<a name="l00296"></a>00296                 <span class="keywordflow">if</span>( index &gt;= 1 )
<a name="l00297"></a>00297                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00298"></a>00298                 <span class="keywordflow">return</span> getOutputFrameRate();
<a name="l00299"></a>00299         }
<a name="l00300"></a>00300         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrUnknown ) );
<a name="l00301"></a>00301         <span class="keywordflow">return</span> 0.0;
<a name="l00302"></a>00302 }
<a name="l00303"></a>00303 
<a name="l00304"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1015eca8dbc29cdb655a4c6db3a3ca9f">00304</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1015eca8dbc29cdb655a4c6db3a3ca9f" title="overridden from gethook, get the virtuals for viewport size, pixel scale, background colour...">OfxhImageEffectNode::getDoublePropertyN</a>( <span class="keyword">const</span> std::string&amp; name, <span class="keywordtype">double</span>* first, <span class="keywordtype">int</span> n ) <span class="keyword">const</span> <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00305"></a>00305 {
<a name="l00306"></a>00306         <span class="keywordflow">if</span>( name == kOfxImageEffectPropProjectSize )
<a name="l00307"></a>00307         {
<a name="l00308"></a>00308                 <span class="keywordflow">if</span>( n &gt; 2 )
<a name="l00309"></a>00309                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00310"></a>00310                 getProjectSize( first[0], first[1] );
<a name="l00311"></a>00311         }
<a name="l00312"></a>00312         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectPropProjectOffset )
<a name="l00313"></a>00313         {
<a name="l00314"></a>00314                 <span class="keywordflow">if</span>( n &gt; 2 )
<a name="l00315"></a>00315                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00316"></a>00316                 getProjectOffset( first[0], first[1] );
<a name="l00317"></a>00317         }
<a name="l00318"></a>00318         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectPropProjectExtent )
<a name="l00319"></a>00319         {
<a name="l00320"></a>00320                 <span class="keywordflow">if</span>( n &gt; 2 )
<a name="l00321"></a>00321                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00322"></a>00322                 getProjectExtent( first[0], first[1] );
<a name="l00323"></a>00323         }
<a name="l00324"></a>00324         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectPropProjectPixelAspectRatio )
<a name="l00325"></a>00325         {
<a name="l00326"></a>00326                 <span class="keywordflow">if</span>( n &gt; 1 )
<a name="l00327"></a>00327                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00328"></a>00328                 *first = getOutputPixelAspectRatio();
<a name="l00329"></a>00329         }
<a name="l00330"></a>00330         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectInstancePropEffectDuration )
<a name="l00331"></a>00331         {
<a name="l00332"></a>00332                 <span class="keywordflow">if</span>( n &gt; 1 )
<a name="l00333"></a>00333                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00334"></a>00334                 *first = getEffectDuration();
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( name == kOfxImageEffectPropFrameRate )
<a name="l00337"></a>00337         {
<a name="l00338"></a>00338                 <span class="keywordflow">if</span>( n &gt; 1 )
<a name="l00339"></a>00339                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrBadIndex ) );
<a name="l00340"></a>00340                 *first = getOutputFrameRate();
<a name="l00341"></a>00341         }
<a name="l00342"></a>00342         <span class="keywordflow">else</span>
<a name="l00343"></a>00343                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrUnknown ) );
<a name="l00344"></a>00344 }
<a name="l00345"></a>00345 
<a name="l00346"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ae5da1c91173c61ff95d9c9d8580f6d76">00346</a> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ae5da1c91173c61ff95d9c9d8580f6d76">OfxhImageEffectNode::~OfxhImageEffectNode</a>()
<a name="l00347"></a>00347 {
<a name="l00348"></a>00348         <span class="comment">// destroy the instance, only if succesfully created</span>
<a name="l00349"></a>00349         <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aadd3fb33dc1c7189c869c44d20e8d6dc">_created</a> )
<a name="l00350"></a>00350         {
<a name="l00351"></a>00351                 OfxStatus status = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a708164924c07c6be4497abf6a041d26e" title="call the effect entry point">mainEntry</a>( kOfxActionDestroyInstance, this-&gt;<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ad6367e1a19cd55a662af140aaadb1eff" title="obtain a handle on this for passing to the C api">getHandle</a>(), 0, 0 );
<a name="l00352"></a>00352                 <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp;
<a name="l00353"></a>00353                         status != kOfxStatReplyDefault )
<a name="l00354"></a>00354                 {
<a name="l00355"></a>00355                         <a class="code" href="../../df/df9/common_2utils_2global_8hpp.html#a5352c1cf06dbeb11da79b136e9f84339" title="terminal display">TUTTLE_LOG_TRACE</a>( <span class="stringliteral">&quot;OFXh: Failed to destroy the effect instance. Status is &quot;</span> &lt;&lt; <a class="code" href="../../d9/dec/namespacetuttle_1_1ofx.html#a0f09fc8d4c55a7df9b85f7a22921069f" title="maps status to a string">mapStatusToString</a>(status) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> );
<a name="l00356"></a>00356                 }
<a name="l00357"></a>00357         }
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 <span class="comment"></span>
<a name="l00360"></a>00360 <span class="comment">/**</span>
<a name="l00361"></a>00361 <span class="comment"> * this is used to populate with any extra action in arguments that may be needed</span>
<a name="l00362"></a>00362 <span class="comment"> */</span>
<a name="l00363"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ab00b11aa30735adf48123dfb53943463">00363</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ab00b11aa30735adf48123dfb53943463" title="this is used to populate with any extra action in arguments that may be needed">OfxhImageEffectNode::setCustomInArgs</a>( <span class="keyword">const</span> std::string&amp; action, <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a>&amp; inArgs )<span class="keyword"> const </span>{}
<a name="l00364"></a>00364 <span class="comment"></span>
<a name="l00365"></a>00365 <span class="comment">/**</span>
<a name="l00366"></a>00366 <span class="comment"> * this is used to populate with any extra action out arguments that may be needed</span>
<a name="l00367"></a>00367 <span class="comment"> */</span>
<a name="l00368"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a8b853be9fcbc5761a70f50c15d4e473f">00368</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a8b853be9fcbc5761a70f50c15d4e473f" title="this is used to populate with any extra action out arguments that may be needed">OfxhImageEffectNode::setCustomOutArgs</a>( <span class="keyword">const</span> std::string&amp; action, <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a>&amp; outArgs )<span class="keyword"> const </span>{}
<a name="l00369"></a>00369 <span class="comment"></span>
<a name="l00370"></a>00370 <span class="comment">/**</span>
<a name="l00371"></a>00371 <span class="comment"> * this is used to populate with any extra action out arguments that may be needed</span>
<a name="l00372"></a>00372 <span class="comment"> */</span>
<a name="l00373"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#afb6d9496a50a161d77742a18e161535a">00373</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#afb6d9496a50a161d77742a18e161535a" title="this is used retrieve any out args after the action was called in mainEntry">OfxhImageEffectNode::examineOutArgs</a>( <span class="keyword">const</span> std::string&amp; action, OfxStatus, <span class="keyword">const</span> <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a>&amp; outArgs )<span class="keyword"> const </span>{}
<a name="l00374"></a>00374 <span class="comment"></span>
<a name="l00375"></a>00375 <span class="comment">/**</span>
<a name="l00376"></a>00376 <span class="comment"> * check for connection</span>
<a name="l00377"></a>00377 <span class="comment"> */</span>
<a name="l00378"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a98e1af64b8905028307e91dea65bc0be">00378</a> <span class="keywordtype">bool</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a98e1af64b8905028307e91dea65bc0be" title="are all the non optional clips connected">OfxhImageEffectNode::checkClipConnectionStatus</a>()<span class="keyword"> const</span>
<a name="l00379"></a>00379 <span class="keyword"></span>{
<a name="l00380"></a>00380         std::map&lt;std::string, attribute::OfxhClipImage*&gt;::const_iterator i;
<a name="l00381"></a>00381         <span class="keywordflow">for</span>( i = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin(); i != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end(); ++i )
<a name="l00382"></a>00382         {
<a name="l00383"></a>00383                 <span class="keywordflow">if</span>( !i-&gt;second-&gt;isOptional() &amp;&amp; !i-&gt;second-&gt;isConnected() )
<a name="l00384"></a>00384                 {
<a name="l00385"></a>00385                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00386"></a>00386                 }
<a name="l00387"></a>00387         }
<a name="l00388"></a>00388         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00389"></a>00389 }
<a name="l00390"></a>00390 <span class="comment"></span>
<a name="l00391"></a>00391 <span class="comment">/**</span>
<a name="l00392"></a>00392 <span class="comment"> * override this to make processing abort, return 1 to abort processing</span>
<a name="l00393"></a>00393 <span class="comment"> *</span>
<a name="l00394"></a>00394 <span class="comment">   int OfxhImageEffectNode::abort()</span>
<a name="l00395"></a>00395 <span class="comment">   {</span>
<a name="l00396"></a>00396 <span class="comment">    return 0;</span>
<a name="l00397"></a>00397 <span class="comment">   }</span>
<a name="l00398"></a>00398 <span class="comment"> */</span>
<a name="l00399"></a>00399 <span class="comment"></span>
<a name="l00400"></a>00400 <span class="comment">/**</span>
<a name="l00401"></a>00401 <span class="comment"> * override this to use your own memory instance - must inherrit from memory::instance</span>
<a name="l00402"></a>00402 <span class="comment"> *</span>
<a name="l00403"></a>00403 <span class="comment">   OfxhMemory* OfxhImageEffectNode::newMemoryInstance( size_t nBytes )</span>
<a name="l00404"></a>00404 <span class="comment">   {</span>
<a name="l00405"></a>00405 <span class="comment">    OfxhMemory* instance = new OfxhMemory();</span>
<a name="l00406"></a>00406 <span class="comment">    instance-&gt;alloc( nBytes );</span>
<a name="l00407"></a>00407 <span class="comment">    return instance;</span>
<a name="l00408"></a>00408 <span class="comment">   }</span>
<a name="l00409"></a>00409 <span class="comment"> */</span>
<a name="l00410"></a>00410 <span class="comment"></span>
<a name="l00411"></a>00411 <span class="comment">/**</span>
<a name="l00412"></a>00412 <span class="comment"> * @return an memory::instance calls makeMemoryInstance that can be overriden</span>
<a name="l00413"></a>00413 <span class="comment"> */</span>
<a name="l00414"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a87e6653df15ae9b55de2416043b88dfa">00414</a> <a class="code" href="../../d1/da1/classtuttle_1_1host_1_1ofx_1_1OfxhMemory.html">OfxhMemory</a>* <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a87e6653df15ae9b55de2416043b88dfa">OfxhImageEffectNode::imageMemoryAlloc</a>( <span class="keywordtype">size_t</span> nBytes )
<a name="l00415"></a>00415 {
<a name="l00416"></a>00416         <span class="keywordflow">return</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a9af9ba51e92afb66bf024c9dd32f171b" title="override this to use your own memory instance - must inherrit from OfxhMemory">newMemoryInstance</a>( nBytes );
<a name="l00417"></a>00417 }
<a name="l00418"></a>00418 <span class="comment"></span>
<a name="l00419"></a>00419 <span class="comment">/**</span>
<a name="l00420"></a>00420 <span class="comment"> * call the effect entry point</span>
<a name="l00421"></a>00421 <span class="comment"> */</span>
<a name="l00422"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a708164924c07c6be4497abf6a041d26e">00422</a> OfxStatus <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a708164924c07c6be4497abf6a041d26e" title="call the effect entry point">OfxhImageEffectNode::mainEntry</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>*        action,
<a name="l00423"></a>00423                                           <span class="keyword">const</span> <span class="keywordtype">void</span>*        handle,
<a name="l00424"></a>00424                                           <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a>* inArgs,
<a name="l00425"></a>00425                                           <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a>* outArgs )<span class="keyword"> const</span>
<a name="l00426"></a>00426 <span class="keyword"></span>{
<a name="l00427"></a>00427         <span class="keyword">const</span> <a class="code" href="../../da/d09/classtuttle_1_1host_1_1ofx_1_1OfxhPluginLoadGuard.html">OfxhPluginLoadGuard</a>* pHandle = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a55fdd9759a4f56ce4f9fa1753def426d">_plugin</a>.<a class="code" href="../../df/d5d/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectPlugin.html#a9cb2dbb8b6d6beb74f9fc7519e71e169">getPluginLoadGuardPtr</a>();
<a name="l00428"></a>00428 
<a name="l00429"></a>00429         <span class="keywordflow">if</span>( !pHandle )
<a name="l00430"></a>00430                 <span class="keywordflow">return</span> kOfxStatFailed;
<a name="l00431"></a>00431 
<a name="l00432"></a>00432         <span class="keyword">const</span> OfxPlugin* ofxPlugin = pHandle-&gt;<a class="code" href="../../da/d09/classtuttle_1_1host_1_1ofx_1_1OfxhPluginLoadGuard.html#ae48367616acfdadf12cebbd25969462a">getOfxPlugin</a>();
<a name="l00433"></a>00433         <span class="keywordflow">if</span>( !ofxPlugin )
<a name="l00434"></a>00434                 <span class="keywordflow">return</span> kOfxStatFailed;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436         OfxPropertySetHandle inHandle = 0;
<a name="l00437"></a>00437         <span class="keywordflow">if</span>( inArgs )
<a name="l00438"></a>00438         {
<a name="l00439"></a>00439                 <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ab00b11aa30735adf48123dfb53943463" title="this is used to populate with any extra action in arguments that may be needed">setCustomInArgs</a>( action, *inArgs );
<a name="l00440"></a>00440                 inHandle = inArgs-&gt;<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a384feefa53e7c58419806e167007d3b8" title="get a handle on this object for passing to the C API">getHandle</a>();
<a name="l00441"></a>00441         }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443         OfxPropertySetHandle outHandle = 0;
<a name="l00444"></a>00444         <span class="keywordflow">if</span>( outArgs )
<a name="l00445"></a>00445         {
<a name="l00446"></a>00446                 <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a8b853be9fcbc5761a70f50c15d4e473f" title="this is used to populate with any extra action out arguments that may be needed">setCustomOutArgs</a>( action, *outArgs );
<a name="l00447"></a>00447                 outHandle = outArgs-&gt;<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a384feefa53e7c58419806e167007d3b8" title="get a handle on this object for passing to the C API">getHandle</a>();
<a name="l00448"></a>00448         }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450         OfxStatus stat = ofxPlugin-&gt;mainEntry( action, handle, inHandle, outHandle );
<a name="l00451"></a>00451 
<a name="l00452"></a>00452         <span class="keywordflow">if</span>( outArgs )
<a name="l00453"></a>00453                 <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#afb6d9496a50a161d77742a18e161535a" title="this is used retrieve any out args after the action was called in mainEntry">examineOutArgs</a>( action, stat, *outArgs );
<a name="l00454"></a>00454 
<a name="l00455"></a>00455         <span class="keywordflow">return</span> stat;
<a name="l00456"></a>00456 }
<a name="l00457"></a>00457 <span class="comment"></span>
<a name="l00458"></a>00458 <span class="comment">/**</span>
<a name="l00459"></a>00459 <span class="comment"> * create a clip instance</span>
<a name="l00460"></a>00460 <span class="comment"> */</span>
<a name="l00461"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a207bf711c3ef9e4ea05538c922b46adb">00461</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a207bf711c3ef9e4ea05538c922b46adb">OfxhImageEffectNode::createInstanceAction</a>() <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00462"></a>00462 {<span class="comment"></span>
<a name="l00463"></a>00463 <span class="comment">        /// we need to init the clips before we call create instance incase</span>
<a name="l00464"></a>00464 <span class="comment">        /// they try and fetch something in create instance, which they are allowed</span>
<a name="l00465"></a>00465 <span class="comment"></span>        <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a3ceb03aa1cda3f9bd6abef0a31a82f15" title="Setup the default clip preferences on the clips.">setDefaultClipPreferences</a>();
<a name="l00466"></a>00466 
<a name="l00467"></a>00467         <span class="comment">// now tell the plug-in to create instance</span>
<a name="l00468"></a>00468         OfxStatus status = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a708164924c07c6be4497abf6a041d26e" title="call the effect entry point">mainEntry</a>( kOfxActionCreateInstance, this-&gt;<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ad6367e1a19cd55a662af140aaadb1eff" title="obtain a handle on this for passing to the C api">getHandle</a>(), 0, 0 );
<a name="l00469"></a>00469 
<a name="l00470"></a>00470         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00471"></a>00471                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status, <span class="stringliteral">&quot;Create action failed on plugin &quot;</span> + <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a06f548cd6d597999add39ca2c4813931" title="name of the Node">getName</a>() ) );
<a name="l00472"></a>00472 
<a name="l00473"></a>00473         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aadd3fb33dc1c7189c869c44d20e8d6dc">_created</a> = <span class="keyword">true</span>;
<a name="l00474"></a>00474 }
<a name="l00475"></a>00475 <span class="comment"></span>
<a name="l00476"></a>00476 <span class="comment">/**</span>
<a name="l00477"></a>00477 <span class="comment"> * begin/change/end instance changed</span>
<a name="l00478"></a>00478 <span class="comment"> */</span>
<a name="l00479"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a0e74ac40373eebd8fdf70609836e9ab7">00479</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a0e74ac40373eebd8fdf70609836e9ab7">OfxhImageEffectNode::beginInstanceChangedAction</a>( <span class="keyword">const</span> std::string&amp; why ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00480"></a>00480 {
<a name="l00481"></a>00481         <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> stuff[] = {
<a name="l00482"></a>00482                 { kOfxPropChangeReason, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, why.c_str() },
<a name="l00483"></a>00483                 { 0 }
<a name="l00484"></a>00484         };
<a name="l00485"></a>00485 
<a name="l00486"></a>00486         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( stuff );
<a name="l00487"></a>00487 
<a name="l00488"></a>00488         OfxStatus status = mainEntry( kOfxActionBeginInstanceChanged, this-&gt;getHandle(), &amp;inArgs, 0 );
<a name="l00489"></a>00489 
<a name="l00490"></a>00490         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00491"></a>00491                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00492"></a>00492 }
<a name="l00493"></a>00493 
<a name="l00494"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a580416c50bf369c9a220a41010b64f40">00494</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a580416c50bf369c9a220a41010b64f40">OfxhImageEffectNode::paramInstanceChangedAction</a>( <span class="keyword">const</span> std::string&amp; paramName,
<a name="l00495"></a>00495                                                       <span class="keyword">const</span> std::string&amp; why,
<a name="l00496"></a>00496                                                       OfxTime            <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>,
<a name="l00497"></a>00497                                                       OfxPointD          renderScale ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00498"></a>00498 {
<a name="l00499"></a>00499         <span class="keywordflow">if</span>( getParamsByName()[paramName]-&gt;changedActionInProgress() )
<a name="l00500"></a>00500         {
<a name="l00501"></a>00501                 <span class="keywordflow">return</span>;
<a name="l00502"></a>00502         }
<a name="l00503"></a>00503         getParamsByName()[paramName]-&gt;changedActionBegin();
<a name="l00504"></a>00504         <span class="comment">/*attribute::OfxhParam&amp; param = */</span> getParam( paramName );
<a name="l00505"></a>00505 
<a name="l00506"></a>00506         <span class="keywordflow">if</span>( isClipPreferencesSlaveParam( paramName ) )
<a name="l00507"></a>00507                 _clipPrefsDirty = <span class="keyword">true</span>;
<a name="l00508"></a>00508 
<a name="l00509"></a>00509         <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> stuff[] = {
<a name="l00510"></a>00510                 { kOfxPropType, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, kOfxTypeParameter },
<a name="l00511"></a>00511                 { kOfxPropName, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, paramName.c_str() },
<a name="l00512"></a>00512                 { kOfxPropChangeReason, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, why.c_str() },
<a name="l00513"></a>00513                 { kOfxPropTime, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00514"></a>00514                 { kOfxImageEffectPropRenderScale, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00515"></a>00515                 { 0 }
<a name="l00516"></a>00516         };
<a name="l00517"></a>00517 
<a name="l00518"></a>00518         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( stuff );
<a name="l00519"></a>00519 
<a name="l00520"></a>00520         <span class="comment">// add the second dimension of the render scale</span>
<a name="l00521"></a>00521         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxPropTime, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l00522"></a>00522 
<a name="l00523"></a>00523         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( kOfxImageEffectPropRenderScale, &amp;renderScale.x, 2 );
<a name="l00524"></a>00524 
<a name="l00525"></a>00525         OfxStatus status = mainEntry( kOfxActionInstanceChanged, this-&gt;getHandle(), &amp;inArgs, 0 );
<a name="l00526"></a>00526 
<a name="l00527"></a>00527         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00528"></a>00528                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00529"></a>00529 
<a name="l00530"></a>00530         getParamsByName()[paramName]-&gt;changedActionEnd();
<a name="l00531"></a>00531 
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 
<a name="l00534"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a3036d56fd0075f2e80727a45be86215d">00534</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a3036d56fd0075f2e80727a45be86215d">OfxhImageEffectNode::clipInstanceChangedAction</a>( <span class="keyword">const</span> std::string&amp; clipName,
<a name="l00535"></a>00535                                                      <span class="keyword">const</span> std::string&amp; why,
<a name="l00536"></a>00536                                                      OfxTime            <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>,
<a name="l00537"></a>00537                                                      OfxPointD          renderScale ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00538"></a>00538 {
<a name="l00539"></a>00539         _clipPrefsDirty = <span class="keyword">true</span>;
<a name="l00540"></a>00540         ClipImageMap::iterator it = _clipImages.find( clipName );
<a name="l00541"></a>00541         <span class="keywordflow">if</span>( it == _clipImages.end() )
<a name="l00542"></a>00542                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatFailed ) );
<a name="l00543"></a>00543 
<a name="l00544"></a>00544         <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> stuff[] = {
<a name="l00545"></a>00545                 { kOfxPropType, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, kOfxTypeClip },
<a name="l00546"></a>00546                 { kOfxPropName, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, it-&gt;second-&gt;getName().c_str() },
<a name="l00547"></a>00547                 { kOfxPropChangeReason, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, why.c_str() },
<a name="l00548"></a>00548                 { kOfxPropTime, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00549"></a>00549                 { kOfxImageEffectPropRenderScale, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00550"></a>00550                 { 0 }
<a name="l00551"></a>00551         };
<a name="l00552"></a>00552 
<a name="l00553"></a>00553         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( stuff );
<a name="l00554"></a>00554 
<a name="l00555"></a>00555         <span class="comment">// add the second dimension of the render scale</span>
<a name="l00556"></a>00556         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxPropTime, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l00557"></a>00557         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( kOfxImageEffectPropRenderScale, &amp;renderScale.x, 2 );
<a name="l00558"></a>00558 
<a name="l00559"></a>00559         OfxStatus status = mainEntry( kOfxActionInstanceChanged, getHandle(), &amp;inArgs, 0 );
<a name="l00560"></a>00560 
<a name="l00561"></a>00561         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00562"></a>00562                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00563"></a>00563 }
<a name="l00564"></a>00564 
<a name="l00565"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5211ad5d7906840efc77a08908066f7d">00565</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5211ad5d7906840efc77a08908066f7d">OfxhImageEffectNode::endInstanceChangedAction</a>( <span class="keyword">const</span> std::string&amp; why ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00566"></a>00566 {
<a name="l00567"></a>00567         <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> whyStuff[] = {
<a name="l00568"></a>00568                 { kOfxPropChangeReason, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, why.c_str() },
<a name="l00569"></a>00569                 { 0 }
<a name="l00570"></a>00570         };
<a name="l00571"></a>00571 
<a name="l00572"></a>00572         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( whyStuff );
<a name="l00573"></a>00573 
<a name="l00574"></a>00574         OfxStatus status = mainEntry( kOfxActionEndInstanceChanged, this-&gt;getHandle(), &amp;inArgs, 0 );
<a name="l00575"></a>00575 
<a name="l00576"></a>00576         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00577"></a>00577                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00578"></a>00578 }
<a name="l00579"></a>00579 <span class="comment"></span>
<a name="l00580"></a>00580 <span class="comment">/**</span>
<a name="l00581"></a>00581 <span class="comment"> * purge plugin caches</span>
<a name="l00582"></a>00582 <span class="comment"> */</span>
<a name="l00583"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ac74f5469ea03d5ba563e3a6f60d9d4ef">00583</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ac74f5469ea03d5ba563e3a6f60d9d4ef">OfxhImageEffectNode::purgeCachesAction</a>() <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00584"></a>00584 {
<a name="l00585"></a>00585         OfxStatus status = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a708164924c07c6be4497abf6a041d26e" title="call the effect entry point">mainEntry</a>( kOfxActionPurgeCaches, this-&gt;<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ad6367e1a19cd55a662af140aaadb1eff" title="obtain a handle on this for passing to the C api">getHandle</a>(), 0, 0 );
<a name="l00586"></a>00586 
<a name="l00587"></a>00587         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00588"></a>00588                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00589"></a>00589 }
<a name="l00590"></a>00590 <span class="comment"></span>
<a name="l00591"></a>00591 <span class="comment">/**</span>
<a name="l00592"></a>00592 <span class="comment"> * sync plugin private data</span>
<a name="l00593"></a>00593 <span class="comment"> */</span>
<a name="l00594"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a68fcb3b7bdb3bc61d9e4513341053a8c">00594</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a68fcb3b7bdb3bc61d9e4513341053a8c">OfxhImageEffectNode::syncPrivateDataAction</a>() <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00595"></a>00595 {
<a name="l00596"></a>00596         OfxStatus status = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a708164924c07c6be4497abf6a041d26e" title="call the effect entry point">mainEntry</a>( kOfxActionSyncPrivateData, this-&gt;<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ad6367e1a19cd55a662af140aaadb1eff" title="obtain a handle on this for passing to the C api">getHandle</a>(), 0, 0 );
<a name="l00597"></a>00597 
<a name="l00598"></a>00598         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00599"></a>00599                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00600"></a>00600 }
<a name="l00601"></a>00601 <span class="comment"></span>
<a name="l00602"></a>00602 <span class="comment">/**</span>
<a name="l00603"></a>00603 <span class="comment"> * end edit instance</span>
<a name="l00604"></a>00604 <span class="comment"> */</span>
<a name="l00605"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a877e18211793973bdafb76222c91b586">00605</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a877e18211793973bdafb76222c91b586">OfxhImageEffectNode::beginInstanceEditAction</a>() <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00606"></a>00606 {
<a name="l00607"></a>00607         OfxStatus status = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a708164924c07c6be4497abf6a041d26e" title="call the effect entry point">mainEntry</a>( kOfxActionBeginInstanceEdit, this-&gt;<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ad6367e1a19cd55a662af140aaadb1eff" title="obtain a handle on this for passing to the C api">getHandle</a>(), 0, 0 );
<a name="l00608"></a>00608 
<a name="l00609"></a>00609         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00610"></a>00610                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00611"></a>00611 }
<a name="l00612"></a>00612 <span class="comment"></span>
<a name="l00613"></a>00613 <span class="comment">/**</span>
<a name="l00614"></a>00614 <span class="comment"> * end edit instance</span>
<a name="l00615"></a>00615 <span class="comment"> */</span>
<a name="l00616"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a18c6d28ad862325a5b4117d8f2e7b529">00616</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a18c6d28ad862325a5b4117d8f2e7b529">OfxhImageEffectNode::endInstanceEditAction</a>() <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00617"></a>00617 {
<a name="l00618"></a>00618         OfxStatus status = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a708164924c07c6be4497abf6a041d26e" title="call the effect entry point">mainEntry</a>( kOfxActionEndInstanceEdit, this-&gt;<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ad6367e1a19cd55a662af140aaadb1eff" title="obtain a handle on this for passing to the C api">getHandle</a>(), 0, 0 );
<a name="l00619"></a>00619 
<a name="l00620"></a>00620         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00621"></a>00621                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00622"></a>00622 }
<a name="l00623"></a>00623 
<a name="l00624"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a2d12f93c5a484ca311f97029d7770a55">00624</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a2d12f93c5a484ca311f97029d7770a55">OfxhImageEffectNode::beginSequenceRenderAction</a>( OfxTime   startFrame,
<a name="l00625"></a>00625                                              OfxTime   endFrame,
<a name="l00626"></a>00626                                              <span class="keywordtype">double</span>    step,
<a name="l00627"></a>00627                                              <span class="keywordtype">bool</span>      interactive,
<a name="l00628"></a>00628                                              OfxPointD renderScale ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00629"></a>00629 {
<a name="l00630"></a>00630         <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> stuff[] = {
<a name="l00631"></a>00631                 { kOfxImageEffectPropFrameRange, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00632"></a>00632                 { kOfxImageEffectPropFrameStep, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00633"></a>00633                 { kOfxPropIsInteractive, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad11c9ca0c013713d6c2bcc029586c61c">property::ePropTypeInt</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00634"></a>00634                 { kOfxImageEffectPropRenderScale, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00635"></a>00635                 { 0 }
<a name="l00636"></a>00636         };
<a name="l00637"></a>00637 
<a name="l00638"></a>00638         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( stuff );
<a name="l00639"></a>00639 
<a name="l00640"></a>00640         <span class="comment">// set up second dimension for frame range and render scale</span>
<a name="l00641"></a>00641         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxImageEffectPropFrameRange, startFrame, 0 );
<a name="l00642"></a>00642         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxImageEffectPropFrameRange, endFrame, 1 );
<a name="l00643"></a>00643 
<a name="l00644"></a>00644         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxImageEffectPropFrameStep, step );
<a name="l00645"></a>00645 
<a name="l00646"></a>00646         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2110c0e43429db10446b7fa0a7f62dd1" title="set a particular int property">setIntProperty</a>( kOfxPropIsInteractive, interactive );
<a name="l00647"></a>00647 
<a name="l00648"></a>00648         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( kOfxImageEffectPropRenderScale, &amp;renderScale.x, 2 );
<a name="l00649"></a>00649 
<a name="l00650"></a>00650         OfxStatus status = mainEntry( kOfxImageEffectActionBeginSequenceRender, this-&gt;getHandle(), &amp;inArgs, 0 );
<a name="l00651"></a>00651 
<a name="l00652"></a>00652         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00653"></a>00653                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00654"></a>00654 }
<a name="l00655"></a>00655 
<a name="l00656"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a076e6190e81052d19b70660edaf50741">00656</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a076e6190e81052d19b70660edaf50741">OfxhImageEffectNode::renderAction</a>( OfxTime            <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>,
<a name="l00657"></a>00657                                         <span class="keyword">const</span> std::string&amp; field,
<a name="l00658"></a>00658                                         <span class="keyword">const</span> OfxRectI&amp;    renderWindow,
<a name="l00659"></a>00659                                         OfxPointD          renderScale ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00660"></a>00660 {
<a name="l00661"></a>00661         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> stuff[] = {
<a name="l00662"></a>00662                 { kOfxPropTime, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00663"></a>00663                 { kOfxImageEffectPropFieldToRender, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l00664"></a>00664                 { kOfxImageEffectPropRenderWindow, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad11c9ca0c013713d6c2bcc029586c61c">property::ePropTypeInt</a>, 4, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00665"></a>00665                 { kOfxImageEffectPropRenderScale, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00666"></a>00666                 { 0 }
<a name="l00667"></a>00667         };
<a name="l00668"></a>00668 
<a name="l00669"></a>00669         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( stuff );
<a name="l00670"></a>00670 
<a name="l00671"></a>00671         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxPropTime, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l00672"></a>00672         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a32654a6d0ff3bebe697b2836c255f940" title="set a particular string property without fetching via a get hook, useful for notifies">setStringProperty</a>( kOfxImageEffectPropFieldToRender, field );
<a name="l00673"></a>00673         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a179cf4809adbc62771b7404e31ef69c9" title="set a particular double property">setIntPropertyN</a>( kOfxImageEffectPropRenderWindow, &amp;renderWindow.x1, 4 );
<a name="l00674"></a>00674         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( kOfxImageEffectPropRenderScale, &amp;renderScale.x, 2 );
<a name="l00675"></a>00675 
<a name="l00676"></a>00676         <span class="comment">//TUTTLE_TLOG( TUTTLE_INFO, &quot;OfxhImageEffect::renderAction inArgs=&quot; &lt;&lt; inArgs );</span>
<a name="l00677"></a>00677 
<a name="l00678"></a>00678         OfxStatus status = mainEntry( kOfxImageEffectActionRender, this-&gt;getHandle(), &amp;inArgs, 0 );
<a name="l00679"></a>00679 
<a name="l00680"></a>00680         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00681"></a>00681                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status, <span class="stringliteral">&quot;Error in ActionRender on node \&quot;&quot;</span> + this-&gt;getName() + <span class="stringliteral">&quot;\&quot; at time &quot;</span> + boost::lexical_cast&lt;std::string&gt;( <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> ) + <span class="stringliteral">&quot;.&quot;</span> ) );
<a name="l00682"></a>00682 }
<a name="l00683"></a>00683 
<a name="l00684"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a34da9089ab011870f133fb40d432eec7">00684</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a34da9089ab011870f133fb40d432eec7">OfxhImageEffectNode::endSequenceRenderAction</a>( OfxTime   startFrame,
<a name="l00685"></a>00685                                            OfxTime   endFrame,
<a name="l00686"></a>00686                                            <span class="keywordtype">double</span>    step,
<a name="l00687"></a>00687                                            <span class="keywordtype">bool</span>      interactive,
<a name="l00688"></a>00688                                            OfxPointD renderScale ) <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00689"></a>00689 {
<a name="l00690"></a>00690         <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> stuff[] = {
<a name="l00691"></a>00691                 { kOfxImageEffectPropFrameRange, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00692"></a>00692                 { kOfxImageEffectPropFrameStep, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00693"></a>00693                 { kOfxPropIsInteractive, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad11c9ca0c013713d6c2bcc029586c61c">property::ePropTypeInt</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00694"></a>00694                 { kOfxImageEffectPropRenderScale, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00695"></a>00695                 { 0 }
<a name="l00696"></a>00696         };
<a name="l00697"></a>00697 
<a name="l00698"></a>00698         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( stuff );
<a name="l00699"></a>00699 
<a name="l00700"></a>00700         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxImageEffectPropFrameStep, step );
<a name="l00701"></a>00701 
<a name="l00702"></a>00702         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxImageEffectPropFrameRange, startFrame, 0 );
<a name="l00703"></a>00703         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxImageEffectPropFrameRange, endFrame, 1 );
<a name="l00704"></a>00704         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2110c0e43429db10446b7fa0a7f62dd1" title="set a particular int property">setIntProperty</a>( kOfxPropIsInteractive, interactive );
<a name="l00705"></a>00705         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( kOfxImageEffectPropRenderScale, &amp;renderScale.x, 2 );
<a name="l00706"></a>00706 
<a name="l00707"></a>00707         OfxStatus status = mainEntry( kOfxImageEffectActionEndSequenceRender, this-&gt;getHandle(), &amp;inArgs, 0 );
<a name="l00708"></a>00708 
<a name="l00709"></a>00709         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00710"></a>00710                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00711"></a>00711 }
<a name="l00712"></a>00712 
<a name="l00713"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1eb07b526d1a8b3a4b606b8ddf38e308">00713</a> OfxRectD <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1eb07b526d1a8b3a4b606b8ddf38e308">OfxhImageEffectNode::computeClipRodUnionAtTimes</a>( <span class="keyword">const</span> <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>&amp; clip, <span class="keyword">const</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a0a189159e36c711a50dab80453ea1f4d">TimesSet</a>&amp; timesSet )<span class="keyword"> const</span>
<a name="l00714"></a>00714 <span class="keyword"></span>{       
<a name="l00715"></a>00715         OfxRectD rod = { 0, 0, 0, 0 };
<a name="l00716"></a>00716         <span class="keywordtype">bool</span> gotOne = <span class="keyword">false</span>;
<a name="l00717"></a>00717         BOOST_FOREACH( <span class="keyword">const</span> TimesSet::value_type&amp; inTime, timesSet )
<a name="l00718"></a>00718         {
<a name="l00719"></a>00719                 <span class="keyword">const</span> OfxRectD localRod = clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a3f240634472c30cfa47035bfa3b14d4b" title="override this to return the rod on the clip">fetchRegionOfDefinition</a>( inTime );
<a name="l00720"></a>00720                 <span class="keywordflow">if</span>( !gotOne )
<a name="l00721"></a>00721                 {
<a name="l00722"></a>00722                         rod = localRod;
<a name="l00723"></a>00723                         gotOne = <span class="keyword">true</span>;
<a name="l00724"></a>00724                 }
<a name="l00725"></a>00725                 <span class="keywordflow">else</span>
<a name="l00726"></a>00726                 {
<a name="l00727"></a>00727                         rod = <a class="code" href="../../d9/dec/namespacetuttle_1_1ofx.html#aa3b86f0cb2bdd64124df1c92723f0423" title="get the union of the two rects">rectUnion</a>( rod, localRod );
<a name="l00728"></a>00728                 }
<a name="l00729"></a>00729         }
<a name="l00730"></a>00730         <span class="keywordflow">return</span> rod;
<a name="l00731"></a>00731 }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 <span class="comment"></span>
<a name="l00734"></a>00734 <span class="comment">/**</span>
<a name="l00735"></a>00735 <span class="comment"> * calculate the default rod for this effect instance</span>
<a name="l00736"></a>00736 <span class="comment"> */</span>
<a name="l00737"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ab337eb8b500a785945d78fef789990b0">00737</a> OfxRectD <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ab337eb8b500a785945d78fef789990b0" title="calculate the default rod for this effect instance">OfxhImageEffectNode::calcDefaultRegionOfDefinition</a>( OfxTime   <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>,
<a name="l00738"></a>00738                                                              OfxPointD renderScale )<span class="keyword"> const</span>
<a name="l00739"></a>00739 <span class="keyword"></span>{
<a name="l00740"></a>00740         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aa2863bf5cb35df0529acb3f61f0f326c">ClipTimesSetMap</a> timesSetMap = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ab3c8e61ff84d18024f0f7f0aa3e2d8d4">getFramesNeeded</a>( time ); <span class="comment">/// @todo: do not recompute this here</span>
<a name="l00741"></a>00741 <span class="comment"></span>        
<a name="l00742"></a>00742 <span class="comment">//      TUTTLE_TLOG( TUTTLE_INFO, &quot;calcDefaultRegionOfDefinition&quot; );</span>
<a name="l00743"></a>00743 <span class="comment">//      TUTTLE_TLOG_VAR( TUTTLE_INFO, _context );</span>
<a name="l00744"></a>00744         OfxRectD rod = { 0, 0, 0, 0 };
<a name="l00745"></a>00745         <span class="keywordflow">try</span>
<a name="l00746"></a>00746         {
<a name="l00747"></a>00747                 <span class="comment">// figure out the default contexts</span>
<a name="l00748"></a>00748                 <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextGenerator ||
<a name="l00749"></a>00749                         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextReader )
<a name="l00750"></a>00750                 {
<a name="l00751"></a>00751                         <span class="comment">// generator is the extent</span>
<a name="l00752"></a>00752                         rod.x1 = rod.y1 = 0;
<a name="l00753"></a>00753                         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a65dbc2f1ef187ef2dc59903de6df101e">getProjectExtent</a>( rod.x2, rod.y2 );
<a name="l00754"></a>00754                         <span class="keyword">const</span> <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>&amp; clip = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#ac3bcdf38ea0762fd36f054ff68d247f4">getClip</a>( kOfxImageEffectOutputClipName );
<a name="l00755"></a>00755                         rod = clip.<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a3f240634472c30cfa47035bfa3b14d4b" title="override this to return the rod on the clip">fetchRegionOfDefinition</a>( time );<span class="comment"></span>
<a name="l00756"></a>00756 <span class="comment">                        /// @todo tuttle: maybe RoD problems with Generator and Read here... to check !</span>
<a name="l00757"></a>00757 <span class="comment"></span>                }
<a name="l00758"></a>00758                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextFilter ||
<a name="l00759"></a>00759                         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextPaint  ||
<a name="l00760"></a>00760                         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextWriter )
<a name="l00761"></a>00761                 {
<a name="l00762"></a>00762                         <span class="comment">// filter and paint default to the input clip</span>
<a name="l00763"></a>00763                         <span class="keyword">const</span> <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>&amp; clip = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#ac3bcdf38ea0762fd36f054ff68d247f4">getClip</a>( kOfxImageEffectSimpleSourceClipName );
<a name="l00764"></a>00764 
<a name="l00765"></a>00765                         <span class="comment">// depending on framesNeeded</span>
<a name="l00766"></a>00766                         rod = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1eb07b526d1a8b3a4b606b8ddf38e308">computeClipRodUnionAtTimes</a>( clip, timesSetMap[clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a5dd0b6a71e059db4f3eaa1bf23b208d8">getName</a>()] );
<a name="l00767"></a>00767                 }
<a name="l00768"></a>00768                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextTransition )
<a name="l00769"></a>00769                 {
<a name="l00770"></a>00770                         <span class="comment">// transition is the union of the two clips</span>
<a name="l00771"></a>00771                         <span class="keyword">const</span> <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>&amp; clipFrom = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#ac3bcdf38ea0762fd36f054ff68d247f4">getClip</a>( kOfxImageEffectTransitionSourceFromClipName );
<a name="l00772"></a>00772                         <span class="keyword">const</span> <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>&amp; clipTo   = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#ac3bcdf38ea0762fd36f054ff68d247f4">getClip</a>( kOfxImageEffectTransitionSourceToClipName );
<a name="l00773"></a>00773 
<a name="l00774"></a>00774                         rod = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1eb07b526d1a8b3a4b606b8ddf38e308">computeClipRodUnionAtTimes</a>( clipFrom, timesSetMap[clipFrom.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a5dd0b6a71e059db4f3eaa1bf23b208d8">getName</a>()] );
<a name="l00775"></a>00775                         rod = <a class="code" href="../../d9/dec/namespacetuttle_1_1ofx.html#aa3b86f0cb2bdd64124df1c92723f0423" title="get the union of the two rects">rectUnion</a>( rod, <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1eb07b526d1a8b3a4b606b8ddf38e308">computeClipRodUnionAtTimes</a>( clipTo, timesSetMap[clipTo.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a5dd0b6a71e059db4f3eaa1bf23b208d8">getName</a>()] ) );
<a name="l00776"></a>00776                 }
<a name="l00777"></a>00777                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextGeneral )
<a name="l00778"></a>00778                 {
<a name="l00779"></a>00779                         <span class="comment">// general context is the union of all the non optional clips</span>
<a name="l00780"></a>00780                         <span class="keywordtype">bool</span> gotOne = <span class="keyword">false</span>;
<a name="l00781"></a>00781                         BOOST_FOREACH( <span class="keyword">const</span> ClipImageMap::value_type&amp; clipPair, <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a> )
<a name="l00782"></a>00782                         {
<a name="l00783"></a>00783                                 <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>* clip = clipPair.second;
<a name="l00784"></a>00784                                 <span class="keywordflow">if</span>( ! clip-&gt;<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip-&gt;<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l00785"></a>00785                                 {
<a name="l00786"></a>00786                                         <span class="comment">// depending on framesNeeded</span>
<a name="l00787"></a>00787                                         <span class="keyword">const</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a0a189159e36c711a50dab80453ea1f4d">TimesSet</a>&amp; timesSet = timesSetMap[clip-&gt;<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a5dd0b6a71e059db4f3eaa1bf23b208d8">getName</a>()];
<a name="l00788"></a>00788                                         <span class="keywordflow">if</span>( timesSet.size() == 0 )
<a name="l00789"></a>00789                                                 <span class="keywordflow">continue</span>; <span class="comment">// the plugin don&#39;t use this input (is it allowed by the standard?)</span>
<a name="l00790"></a>00790                                         BOOST_FOREACH( <span class="keyword">const</span> TimesSet::value_type&amp; inTime, timesSet )
<a name="l00791"></a>00791                                         {
<a name="l00792"></a>00792                                                 <span class="keyword">const</span> OfxRectD localRod = clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a3f240634472c30cfa47035bfa3b14d4b" title="override this to return the rod on the clip">fetchRegionOfDefinition</a>( inTime );
<a name="l00793"></a>00793                                                 <span class="keywordflow">if</span>( !gotOne )
<a name="l00794"></a>00794                                                 {
<a name="l00795"></a>00795                                                         rod = localRod;
<a name="l00796"></a>00796                                                         gotOne = <span class="keyword">true</span>;
<a name="l00797"></a>00797                                                 }
<a name="l00798"></a>00798                                                 <span class="keywordflow">else</span>
<a name="l00799"></a>00799                                                 {
<a name="l00800"></a>00800                                                         rod = <a class="code" href="../../d9/dec/namespacetuttle_1_1ofx.html#aa3b86f0cb2bdd64124df1c92723f0423" title="get the union of the two rects">rectUnion</a>( rod, localRod );
<a name="l00801"></a>00801                                                 }
<a name="l00802"></a>00802                                         }
<a name="l00803"></a>00803                                 }
<a name="l00804"></a>00804                         }
<a name="l00805"></a>00805 
<a name="l00806"></a>00806                         <span class="keywordflow">if</span>( !gotOne )
<a name="l00807"></a>00807                         {
<a name="l00808"></a>00808                                 <span class="comment">// no non optionals? then be the extent</span>
<a name="l00809"></a>00809                                 rod.x1 = rod.y1 = 0;
<a name="l00810"></a>00810                                 <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a65dbc2f1ef187ef2dc59903de6df101e">getProjectExtent</a>( rod.x2, rod.y2 );
<a name="l00811"></a>00811                         }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813                 }
<a name="l00814"></a>00814                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextRetimer )
<a name="l00815"></a>00815                 {
<a name="l00816"></a>00816                         <span class="comment">// retimer</span>
<a name="l00817"></a>00817                         <span class="keyword">const</span> <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>&amp; clip = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#ac3bcdf38ea0762fd36f054ff68d247f4">getClip</a>( kOfxImageEffectSimpleSourceClipName );
<a name="l00818"></a>00818                         <span class="comment">/*attribute::ParamDoubleInstance&amp; retimerParam = */</span> <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../db/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamDouble.html">attribute::OfxhParamDouble</a>&amp;<span class="keyword">&gt;</span>( <a class="code" href="../../d0/d5e/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParamSet.html#a625c8aa40ce2bacd36b64713beb32236">getParam</a>( kOfxImageEffectRetimerParamName ) );
<a name="l00819"></a>00819                         rod = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a1eb07b526d1a8b3a4b606b8ddf38e308">computeClipRodUnionAtTimes</a>( clip, timesSetMap[clip.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a5dd0b6a71e059db4f3eaa1bf23b208d8">getName</a>()] );
<a name="l00820"></a>00820                 }
<a name="l00821"></a>00821         }
<a name="l00822"></a>00822         <span class="keywordflow">catch</span>( boost::exception&amp; e )
<a name="l00823"></a>00823         {
<a name="l00824"></a>00824                 <span class="keywordflow">if</span>( ! boost::get_error_info&lt;exception::dev&gt;( e ) )
<a name="l00825"></a>00825                         e &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#ac85e278687d5002c0367a0b9a1d9326f" title="This is detailed informations for developpers. Not always a real human readable message :)...">exception::dev</a>() + <span class="stringliteral">&quot;Error while computing the default ROD.&quot;</span>;
<a name="l00826"></a>00826                 e &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a656e46f54fda5782e2fd15e086184fda" title="The ofx context name. Each plugin can be instanciated in differents contexts (depending on the declar...">exception::ofxContext</a>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> );
<a name="l00827"></a>00827                 e &lt;&lt; <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a79af359ae6beb7ecdb5d6fa0c70e0acd" title="Plugin string identifier.">exception::pluginIdentifier</a>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a75e1d88efaa61e052b5201ff89d23d0c" title="return the plugin this instance was created with">getPlugin</a>().getIdentifier() );
<a name="l00828"></a>00828                 <span class="keywordflow">throw</span>;
<a name="l00829"></a>00829         }
<a name="l00830"></a>00830         <span class="keywordflow">return</span> rod;
<a name="l00831"></a>00831 }
<a name="l00832"></a>00832 <span class="comment"></span>
<a name="l00833"></a>00833 <span class="comment">/**</span>
<a name="l00834"></a>00834 <span class="comment"> * RoD call</span>
<a name="l00835"></a>00835 <span class="comment"> */</span>
<a name="l00836"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#acfaa12f87fef7ae2a4aff1aeeb4e5909">00836</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#acfaa12f87fef7ae2a4aff1aeeb4e5909">OfxhImageEffectNode::getRegionOfDefinitionAction</a>( OfxTime   <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>,
<a name="l00837"></a>00837                                                        OfxPointD renderScale,
<a name="l00838"></a>00838                                                        OfxRectD&amp; rod ) <span class="keyword">const</span> <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00839"></a>00839 {
<a name="l00840"></a>00840         <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> inStuff[] = {
<a name="l00841"></a>00841                 { kOfxPropTime, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00842"></a>00842                 { kOfxImageEffectPropRenderScale, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00843"></a>00843                 { 0 }
<a name="l00844"></a>00844         };
<a name="l00845"></a>00845 
<a name="l00846"></a>00846         <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> outStuff[] = {
<a name="l00847"></a>00847                 { kOfxImageEffectPropRegionOfDefinition, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 4, <span class="keyword">false</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00848"></a>00848                 { 0 }
<a name="l00849"></a>00849         };
<a name="l00850"></a>00850 
<a name="l00851"></a>00851         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( inStuff );
<a name="l00852"></a>00852         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> outArgs( outStuff );
<a name="l00853"></a>00853 
<a name="l00854"></a>00854         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxPropTime, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l00855"></a>00855 
<a name="l00856"></a>00856         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( kOfxImageEffectPropRenderScale, &amp;renderScale.x, 2 );
<a name="l00857"></a>00857 
<a name="l00858"></a>00858         OfxStatus stat = mainEntry( kOfxImageEffectActionGetRegionOfDefinition,
<a name="l00859"></a>00859                                     this-&gt;getHandle(),
<a name="l00860"></a>00860                                     &amp;inArgs,
<a name="l00861"></a>00861                                     &amp;outArgs );
<a name="l00862"></a>00862 
<a name="l00863"></a>00863         <span class="keywordflow">if</span>( stat == kOfxStatOK )
<a name="l00864"></a>00864         {
<a name="l00865"></a>00865                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#ac8d04a208d3c845845457c9fa4ad180b" title="get the value of a particular double property">getDoublePropertyN</a>( kOfxImageEffectPropRegionOfDefinition, &amp;rod.x1, 4 );
<a name="l00866"></a>00866         }
<a name="l00867"></a>00867         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( stat == kOfxStatReplyDefault )
<a name="l00868"></a>00868         {
<a name="l00869"></a>00869                 rod = calcDefaultRegionOfDefinition( <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>, renderScale );
<a name="l00870"></a>00870         }
<a name="l00871"></a>00871         <span class="keywordflow">else</span>
<a name="l00872"></a>00872         {
<a name="l00873"></a>00873                 <span class="comment">// defined to process sequences with hole</span>
<a name="l00874"></a>00874                 <span class="comment">// find a best way to do this ??</span>
<a name="l00875"></a>00875                 <span class="keywordflow">if</span>( _context == kOfxImageEffectContextReader )
<a name="l00876"></a>00876                         BOOST_THROW_EXCEPTION( <a class="code" href="../../db/d8b/structtuttle_1_1exception_1_1FileInSequenceNotExist.html" title="File in sequence doesn&#39;t exist.">tuttle::exception::FileInSequenceNotExist</a>() );
<a name="l00877"></a>00877                 
<a name="l00878"></a>00878                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( stat, <span class="stringliteral">&quot;getRegionOfDefinitionAction error.&quot;</span> ) );
<a name="l00879"></a>00879         }
<a name="l00880"></a>00880 }
<a name="l00881"></a>00881 <span class="comment"></span>
<a name="l00882"></a>00882 <span class="comment">/**</span>
<a name="l00883"></a>00883 <span class="comment"> * get the region of interest for each input and return it in the given std::map</span>
<a name="l00884"></a>00884 <span class="comment"> */</span>
<a name="l00885"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a9cffab0a13d0472ac95dbee76867fd51">00885</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a9cffab0a13d0472ac95dbee76867fd51">OfxhImageEffectNode::getRegionOfInterestAction</a>( OfxTime <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>,
<a name="l00886"></a>00886                                                      OfxPointD renderScale,
<a name="l00887"></a>00887                                                      <span class="keyword">const</span> OfxRectD&amp; roi,
<a name="l00888"></a>00888                                                      std::map&lt;attribute::OfxhClipImage*, OfxRectD&gt;&amp; rois ) <span class="keyword">const</span> <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l00889"></a>00889 {
<a name="l00890"></a>00890         <span class="comment">// reset the map</span>
<a name="l00891"></a>00891         rois.clear();
<a name="l00892"></a>00892 
<a name="l00893"></a>00893         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aa2863bf5cb35df0529acb3f61f0f326c">ClipTimesSetMap</a> timesSetMap = getFramesNeeded( <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l00894"></a>00894         
<a name="l00895"></a>00895         <span class="keywordflow">if</span>( !supportsTiles() )
<a name="l00896"></a>00896         {<span class="comment"></span>
<a name="l00897"></a>00897 <span class="comment">                /// No tiling support on the effect at all. So set the roi of each input clip to be the RoD of that clip.</span>
<a name="l00898"></a>00898 <span class="comment"></span>                BOOST_FOREACH( <span class="keyword">const</span> ClipImageMap::value_type&amp; clip, _clipImages )
<a name="l00899"></a>00899                 {
<a name="l00900"></a>00900                         <span class="keywordflow">if</span>( ! clip.second-&gt;isOutput() ||
<a name="l00901"></a>00901                             getContext() == kOfxImageEffectContextGenerator ||
<a name="l00902"></a>00902                             getContext() == kOfxImageEffectContextReader )
<a name="l00903"></a>00903                         {
<a name="l00904"></a>00904                                 <span class="keywordflow">if</span>( clip.second-&gt;isOutput() || clip.second-&gt;isConnected() ) <span class="comment">// needed to be able to fetch the RoD</span>
<a name="l00905"></a>00905                                 {<span class="comment"></span>
<a name="l00906"></a>00906 <span class="comment">                                        /// @todo tuttle: how to support size on generators... check if this is correct in all cases.</span>
<a name="l00907"></a>00907 <span class="comment"></span>                                        OfxRectD roi = clip.second-&gt;fetchRegionOfDefinition( <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l00908"></a>00908                                         rois[clip.second] = roi;
<a name="l00909"></a>00909                                 }
<a name="l00910"></a>00910                         }
<a name="l00911"></a>00911                 }
<a name="l00912"></a>00912         }
<a name="l00913"></a>00913         <span class="keywordflow">else</span>
<a name="l00914"></a>00914         {<span class="comment"></span>
<a name="l00915"></a>00915 <span class="comment">                /// set up the in args</span>
<a name="l00916"></a>00916 <span class="comment"></span>                <span class="keyword">static</span> <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> inStuff[] = {
<a name="l00917"></a>00917                         { kOfxPropTime, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00918"></a>00918                         { kOfxImageEffectPropRenderScale, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l00919"></a>00919                         { kOfxImageEffectPropRegionOfInterest, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 4, <span class="keyword">true</span>, 0 },
<a name="l00920"></a>00920                         { 0 }
<a name="l00921"></a>00921                 };
<a name="l00922"></a>00922                 <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( inStuff );
<a name="l00923"></a>00923 
<a name="l00924"></a>00924                 inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( kOfxImageEffectPropRenderScale, &amp;renderScale.x, 2 );
<a name="l00925"></a>00925                 inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxPropTime, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l00926"></a>00926                 inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( kOfxImageEffectPropRegionOfInterest, &amp;roi.x1, 4 );
<a name="l00927"></a>00927 
<a name="l00928"></a>00928                 <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> outArgs;
<a name="l00929"></a>00929                 std::list&lt;std::string&gt; keepPropNamesOwnership;
<a name="l00930"></a>00930                 
<a name="l00931"></a>00931                 BOOST_FOREACH( <span class="keyword">const</span> ClipImageMap::value_type&amp; clip, _clipImages )
<a name="l00932"></a>00932                 {
<a name="l00933"></a>00933                         <span class="keywordflow">if</span>( ! clip.second-&gt;isOutput() ||
<a name="l00934"></a>00934                             getContext() == kOfxImageEffectContextGenerator ||
<a name="l00935"></a>00935                             getContext() == kOfxImageEffectContextReader )
<a name="l00936"></a>00936                         {
<a name="l00937"></a>00937                                 keepPropNamesOwnership.push_back( <span class="stringliteral">&quot;OfxImageClipPropRoI_&quot;</span> + clip.first );
<a name="l00938"></a>00938                                 <span class="keyword">const</span> std::string&amp; name = keepPropNamesOwnership.back();
<a name="l00939"></a>00939 
<a name="l00940"></a>00940                                 <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> s;
<a name="l00941"></a>00941                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#a021c01e9ec9e82c88e122faca33575f6" title="name of the property">name</a>         = name.c_str();
<a name="l00942"></a>00942                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#aa3ed56d1968fd8856a78e922673077bc" title="type">type</a>         = <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>;
<a name="l00943"></a>00943                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#a0750e526585dbf32975d56933488a970" title="fixed dimension of the property, set to zero if variable dimension">dimension</a>    = 4;
<a name="l00944"></a>00944                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#a3d9c9bda001f8bfbb5f77acd2837eefc" title="is the property plug-in read only">readonly</a>     = <span class="keyword">false</span>;
<a name="l00945"></a>00945                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#aa92c1446638d36666ff4aaef7a6058df" title="Default value as a string. Pointers are ignored and always null.">defaultValue</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00946"></a>00946                                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a6c87c959bb4175ec30daadfe0d44da11" title="add one new property">createProperty</a>( s );
<a name="l00947"></a>00947 <span class="comment"></span>
<a name="l00948"></a>00948 <span class="comment">                                /// initialise to the default</span>
<a name="l00949"></a>00949 <span class="comment"></span>                                outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#a021c01e9ec9e82c88e122faca33575f6" title="name of the property">name</a>, &amp;roi.x1, 4 );
<a name="l00950"></a>00950                         }
<a name="l00951"></a>00951                 }
<a name="l00952"></a>00952 <span class="comment"></span>
<a name="l00953"></a>00953 <span class="comment">                /// call the action</span>
<a name="l00954"></a>00954 <span class="comment"></span>                <span class="keyword">const</span> OfxStatus status = mainEntry( kOfxImageEffectActionGetRegionsOfInterest,
<a name="l00955"></a>00955                                               this-&gt;getHandle(),
<a name="l00956"></a>00956                                               &amp;inArgs,
<a name="l00957"></a>00957                                               &amp;outArgs );
<a name="l00958"></a>00958 
<a name="l00959"></a>00959                 <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l00960"></a>00960                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l00961"></a>00961 <span class="comment"></span>
<a name="l00962"></a>00962 <span class="comment">                /// set the thing up</span>
<a name="l00963"></a>00963 <span class="comment"></span>                BOOST_FOREACH( <span class="keyword">const</span> ClipImageMap::value_type&amp; clip, _clipImages )
<a name="l00964"></a>00964                 {
<a name="l00965"></a>00965                         <span class="keywordflow">if</span>( ! clip.second-&gt;isOutput() ||
<a name="l00966"></a>00966                             getContext() == kOfxImageEffectContextGenerator ||
<a name="l00967"></a>00967                             getContext() == kOfxImageEffectContextReader )
<a name="l00968"></a>00968                         {
<a name="l00969"></a>00969                                 <span class="keywordflow">if</span>( clip.second-&gt;isOutput() || clip.second-&gt;isConnected() ) <span class="comment">// needed to be able to fetch the RoD</span>
<a name="l00970"></a>00970                                 {
<a name="l00971"></a>00971                                         <span class="comment">// depending on framesNeeded !</span>
<a name="l00972"></a>00972                                         <span class="keyword">const</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a0a189159e36c711a50dab80453ea1f4d">TimesSet</a>&amp; timesSet = timesSetMap[clip.second-&gt;getName()];
<a name="l00973"></a>00973                                         <span class="keywordflow">if</span>( timesSet.size() == 0 )
<a name="l00974"></a>00974                                                 <span class="keywordflow">continue</span>; <span class="comment">// the plugin don&#39;t use this input (is it allowed by the standard?)</span>
<a name="l00975"></a>00975                                         <span class="comment">// use intersection?</span>
<a name="l00976"></a>00976                                         OfxRectD inputsRodIntersection = clip.second-&gt;fetchRegionOfDefinition( *(timesSet.begin()) );
<a name="l00977"></a>00977                                         BOOST_FOREACH( <span class="keyword">const</span> TimesSet::value_type&amp; inTime, timesSet )
<a name="l00978"></a>00978                                         {
<a name="l00979"></a>00979                                                 <span class="keyword">const</span> OfxRectD timeRod = clip.second-&gt;fetchRegionOfDefinition( inTime );
<a name="l00980"></a>00980                                                 inputsRodIntersection = <a class="code" href="../../d9/dec/namespacetuttle_1_1ofx.html#add5dd38c00eb82cd1dfed32e022af1cb" title="clamp the value">clamp</a>( timeRod, inputsRodIntersection );
<a name="l00981"></a>00981                                         }
<a name="l00982"></a>00982                                         <span class="keywordflow">if</span>( clip.second-&gt;supportsTiles() )
<a name="l00983"></a>00983                                         {
<a name="l00984"></a>00984                                                 <span class="keyword">const</span> std::string name = <span class="stringliteral">&quot;OfxImageClipPropRoI_&quot;</span> + clip.first;
<a name="l00985"></a>00985                                                 OfxRectD thisRoi;
<a name="l00986"></a>00986                                                 thisRoi.x1 = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( name, 0 );
<a name="l00987"></a>00987                                                 thisRoi.y1 = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( name, 1 );
<a name="l00988"></a>00988                                                 thisRoi.x2 = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( name, 2 );
<a name="l00989"></a>00989                                                 thisRoi.y2 = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( name, 3 );
<a name="l00990"></a>00990 
<a name="l00991"></a>00991                                                 <span class="comment">// clamp it to the clip&#39;s rod</span>
<a name="l00992"></a>00992                                                 thisRoi          = <a class="code" href="../../d9/dec/namespacetuttle_1_1ofx.html#add5dd38c00eb82cd1dfed32e022af1cb" title="clamp the value">clamp</a>( thisRoi, inputsRodIntersection );
<a name="l00993"></a>00993                                                 rois[clip.second] = thisRoi;
<a name="l00994"></a>00994                                         }
<a name="l00995"></a>00995                                         <span class="keywordflow">else</span>
<a name="l00996"></a>00996                                         {<span class="comment"></span>
<a name="l00997"></a>00997 <span class="comment">                                                /// not supporting tiles on this input, so set it to the rod</span>
<a name="l00998"></a>00998 <span class="comment"></span>                                                rois[clip.second] = inputsRodIntersection;
<a name="l00999"></a>00999                                         }
<a name="l01000"></a>01000                                 }
<a name="l01001"></a>01001                         }
<a name="l01002"></a>01002                 }
<a name="l01003"></a>01003         }
<a name="l01004"></a>01004 }
<a name="l01005"></a>01005 <span class="comment"></span>
<a name="l01006"></a>01006 <span class="comment">/**</span>
<a name="l01007"></a>01007 <span class="comment"> * see how many frames are needed from each clip to render the indicated frame</span>
<a name="l01008"></a>01008 <span class="comment"> */</span>
<a name="l01009"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a73d1fdf4560f307c2752ca3e9966694f">01009</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a73d1fdf4560f307c2752ca3e9966694f">OfxhImageEffectNode::getFramesNeededAction</a>( OfxTime   <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>,
<a name="l01010"></a>01010                                                 <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a6d5f27ab7d5a35887b5b28584b79072b" title="a map used to specify needed frame ranges on set of clips">ClipRangeMap</a>&amp; rangeMap ) <span class="keyword">const</span> <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l01011"></a>01011 {
<a name="l01012"></a>01012         OfxStatus status = kOfxStatReplyDefault;
<a name="l01013"></a>01013         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> outArgs;
<a name="l01014"></a>01014         std::list&lt;std::string&gt; keepPropNamesOwnership;
<a name="l01015"></a>01015 
<a name="l01016"></a>01016         <span class="keywordflow">if</span>( temporalAccess() )
<a name="l01017"></a>01017         {
<a name="l01018"></a>01018                 <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> inStuff[] = {
<a name="l01019"></a>01019                         { kOfxPropTime, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l01020"></a>01020                         { 0 }
<a name="l01021"></a>01021                 };
<a name="l01022"></a>01022                 <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( inStuff );
<a name="l01023"></a>01023                 inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxPropTime, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l01024"></a>01024 
<a name="l01025"></a>01025                 <span class="keywordflow">for</span>( ClipImageMap::const_iterator it = _clipImages.begin(), itEnd = _clipImages.end();
<a name="l01026"></a>01026                      it != itEnd;
<a name="l01027"></a>01027                      ++it )
<a name="l01028"></a>01028                 {
<a name="l01029"></a>01029                         <span class="keywordflow">if</span>( !it-&gt;second-&gt;isOutput() )
<a name="l01030"></a>01030                         {
<a name="l01031"></a>01031                                 keepPropNamesOwnership.push_back( <span class="stringliteral">&quot;OfxImageClipPropFrameRange_&quot;</span> + it-&gt;first );
<a name="l01032"></a>01032                                 <span class="keyword">const</span> std::string&amp; name = keepPropNamesOwnership.back();
<a name="l01033"></a>01033 
<a name="l01034"></a>01034                                 <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> s;
<a name="l01035"></a>01035                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#a021c01e9ec9e82c88e122faca33575f6" title="name of the property">name</a>         = name.c_str();
<a name="l01036"></a>01036                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#aa3ed56d1968fd8856a78e922673077bc" title="type">type</a>         = <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>;
<a name="l01037"></a>01037                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#a0750e526585dbf32975d56933488a970" title="fixed dimension of the property, set to zero if variable dimension">dimension</a>    = 0;
<a name="l01038"></a>01038                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#a3d9c9bda001f8bfbb5f77acd2837eefc" title="is the property plug-in read only">readonly</a>     = <span class="keyword">false</span>;
<a name="l01039"></a>01039                                 s.<a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html#aa92c1446638d36666ff4aaef7a6058df" title="Default value as a string. Pointers are ignored and always null.">defaultValue</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01040"></a>01040                                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a6c87c959bb4175ec30daadfe0d44da11" title="add one new property">createProperty</a>( s );<span class="comment"></span>
<a name="l01041"></a>01041 <span class="comment">                                /// intialise it to the current frame</span>
<a name="l01042"></a>01042 <span class="comment"></span>                                outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( name, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>, 0 );
<a name="l01043"></a>01043                                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( name, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>, 1 );
<a name="l01044"></a>01044                         }
<a name="l01045"></a>01045                 }
<a name="l01046"></a>01046 
<a name="l01047"></a>01047                 status = mainEntry( kOfxImageEffectActionGetFramesNeeded,
<a name="l01048"></a>01048                                     this-&gt;getHandle(),
<a name="l01049"></a>01049                                     &amp;inArgs,
<a name="l01050"></a>01050                                     &amp;outArgs );
<a name="l01051"></a>01051 
<a name="l01052"></a>01052                 <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l01053"></a>01053                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l01054"></a>01054         }
<a name="l01055"></a>01055 
<a name="l01056"></a>01056         OfxRangeD defaultRange;
<a name="l01057"></a>01057         defaultRange.min = defaultRange.max = <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>;
<a name="l01058"></a>01058 
<a name="l01059"></a>01059         <span class="keywordflow">for</span>( ClipImageMap::const_iterator it = _clipImages.begin(), itEnd = _clipImages.end();
<a name="l01060"></a>01060              it != itEnd;
<a name="l01061"></a>01061              ++it )
<a name="l01062"></a>01062         {
<a name="l01063"></a>01063                 <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>* clip = it-&gt;second;
<a name="l01064"></a>01064 
<a name="l01065"></a>01065                 <span class="keywordflow">if</span>( !clip-&gt;<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() )
<a name="l01066"></a>01066                 {
<a name="l01067"></a>01067                         <span class="keywordflow">if</span>( status == kOfxStatReplyDefault )
<a name="l01068"></a>01068                         {
<a name="l01069"></a>01069                                 rangeMap[clip].push_back( defaultRange );
<a name="l01070"></a>01070                         }
<a name="l01071"></a>01071                         <span class="keywordflow">else</span>
<a name="l01072"></a>01072                         {
<a name="l01073"></a>01073                                 <span class="keyword">const</span> std::string name = <span class="stringliteral">&quot;OfxImageClipPropFrameRange_&quot;</span> + it-&gt;first;
<a name="l01074"></a>01074 
<a name="l01075"></a>01075                                 <span class="keywordtype">int</span> nRanges = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a28303829c305482437c8e12cb1b8c996" title="get the dimension of a particular property">getDimension</a>( name );
<a name="l01076"></a>01076                                 <span class="keywordflow">if</span>( nRanges % 2 != 0 )
<a name="l01077"></a>01077                                         BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( kOfxStatErrValue, <span class="stringliteral">&quot;Frame range needs to be divisible by 2.&quot;</span> ) );
<a name="l01078"></a>01078 
<a name="l01079"></a>01079                                 <span class="keywordflow">if</span>( nRanges == 0 )
<a name="l01080"></a>01080                                 {
<a name="l01081"></a>01081                                         rangeMap[clip].push_back( defaultRange );
<a name="l01082"></a>01082                                 }
<a name="l01083"></a>01083                                 <span class="keywordflow">else</span>
<a name="l01084"></a>01084                                 {
<a name="l01085"></a>01085                                         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> r = 0; r &lt; nRanges; )
<a name="l01086"></a>01086                                         {
<a name="l01087"></a>01087                                                 <span class="keywordtype">double</span> <a class="code" href="../../d2/d7f/namespacetuttle.html#afbd150ec02af9b6e21b9d758f8aae158">min</a> = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( name, r );
<a name="l01088"></a>01088                                                 <span class="keywordtype">double</span> <a class="code" href="../../d2/d7f/namespacetuttle.html#ae47d39ffbfd26c4920c2b25e8c0da3cc">max</a> = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( name, r + 1 );
<a name="l01089"></a>01089                                                 r += 2;
<a name="l01090"></a>01090 
<a name="l01091"></a>01091                                                 OfxRangeD range;
<a name="l01092"></a>01092                                                 range.min = <a class="code" href="../../d2/d7f/namespacetuttle.html#afbd150ec02af9b6e21b9d758f8aae158">min</a>;
<a name="l01093"></a>01093                                                 range.max = <a class="code" href="../../d2/d7f/namespacetuttle.html#ae47d39ffbfd26c4920c2b25e8c0da3cc">max</a>;
<a name="l01094"></a>01094                                                 rangeMap[clip].push_back( range );
<a name="l01095"></a>01095                                         }
<a name="l01096"></a>01096                                 }
<a name="l01097"></a>01097                         }
<a name="l01098"></a>01098                 }
<a name="l01099"></a>01099         }
<a name="l01100"></a>01100 }
<a name="l01101"></a>01101 
<a name="l01102"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ab3c8e61ff84d18024f0f7f0aa3e2d8d4">01102</a> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aa2863bf5cb35df0529acb3f61f0f326c">OfxhImageEffectNode::ClipTimesSetMap</a> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#ab3c8e61ff84d18024f0f7f0aa3e2d8d4">OfxhImageEffectNode::getFramesNeeded</a>( <span class="keyword">const</span> OfxTime <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> )<span class="keyword"> const</span>
<a name="l01103"></a>01103 <span class="keyword"></span>{
<a name="l01104"></a>01104         <span class="keyword">const</span> <span class="keywordtype">bool</span> temporalClipAccess = this-&gt;<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ae5aece28ee4518c45899d38181a1008d">getProperties</a>().<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a4b0fe52185a630d6a17cff17fb6c494c">fetchIntProperty</a>( kOfxImageEffectPropTemporalClipAccess ).getValue();
<a name="l01105"></a>01105         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aa2863bf5cb35df0529acb3f61f0f326c">ClipTimesSetMap</a> result;
<a name="l01106"></a>01106         <span class="keywordflow">if</span>( temporalClipAccess )
<a name="l01107"></a>01107         {
<a name="l01108"></a>01108                 <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a6d5f27ab7d5a35887b5b28584b79072b" title="a map used to specify needed frame ranges on set of clips">ClipRangeMap</a> clipMap;
<a name="l01109"></a>01109                 <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a73d1fdf4560f307c2752ca3e9966694f">getFramesNeededAction</a>( time, clipMap );
<a name="l01110"></a>01110                 BOOST_FOREACH( <span class="keyword">const</span> ClipRangeMap::value_type&amp; v, clipMap )
<a name="l01111"></a>01111                 {
<a name="l01112"></a>01112                         BOOST_FOREACH( <span class="keyword">const</span> ClipRangeMap::value_type::second_type::value_type&amp; range, v.second )
<a name="l01113"></a>01113                         {
<a name="l01114"></a>01114                                 <span class="keywordflow">for</span>( OfxTime t = range.min; t &lt;= range.max; t += 1.0 )
<a name="l01115"></a>01115                                 {
<a name="l01116"></a>01116                                         result[ v.first-&gt;getName() ].insert(t);
<a name="l01117"></a>01117                                 }
<a name="l01118"></a>01118                         }
<a name="l01119"></a>01119                 }
<a name="l01120"></a>01120         }
<a name="l01121"></a>01121         <span class="keywordflow">else</span>
<a name="l01122"></a>01122         {
<a name="l01123"></a>01123                 BOOST_FOREACH( ClipImageVector::const_reference v, <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#ac3cea9f7b5e3f92b61c96773298015a7" title="clips list (data owner)">_clipsByOrder</a> )
<a name="l01124"></a>01124                 {
<a name="l01125"></a>01125                         result[v.getName()].insert(time);
<a name="l01126"></a>01126                 }
<a name="l01127"></a>01127         }
<a name="l01128"></a>01128         <span class="keywordflow">return</span> result;
<a name="l01129"></a>01129 }
<a name="l01130"></a>01130 
<a name="l01131"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aa71e5aaa4c384f1fd69dc75cd4c9ca3e">01131</a> <span class="keywordtype">bool</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aa71e5aaa4c384f1fd69dc75cd4c9ca3e">OfxhImageEffectNode::isIdentityAction</a>( OfxTime&amp;           <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a>,
<a name="l01132"></a>01132                                             <span class="keyword">const</span> std::string&amp; field,
<a name="l01133"></a>01133                                             <span class="keyword">const</span> OfxRectI&amp;    renderWindow,
<a name="l01134"></a>01134                                             OfxPointD          renderScale,
<a name="l01135"></a>01135                                             std::string&amp;       clip ) <span class="keyword">const</span> <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l01136"></a>01136 {
<a name="l01137"></a>01137         <span class="keyword">static</span> <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> inStuff[] = {
<a name="l01138"></a>01138                 { kOfxPropTime, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l01139"></a>01139                 { kOfxImageEffectPropFieldToRender, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">true</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l01140"></a>01140                 { kOfxImageEffectPropRenderWindow, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad11c9ca0c013713d6c2bcc029586c61c">property::ePropTypeInt</a>, 4, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l01141"></a>01141                 { kOfxImageEffectPropRenderScale, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">true</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l01142"></a>01142                 { 0 }
<a name="l01143"></a>01143         };
<a name="l01144"></a>01144 
<a name="l01145"></a>01145         <span class="keyword">static</span> <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> outStuff[] = {
<a name="l01146"></a>01146                 { kOfxPropTime, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;0.0&quot;</span> },
<a name="l01147"></a>01147                 { kOfxPropName, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l01148"></a>01148                 { 0 }
<a name="l01149"></a>01149         };
<a name="l01150"></a>01150 
<a name="l01151"></a>01151         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> inArgs( inStuff );
<a name="l01152"></a>01152 
<a name="l01153"></a>01153         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a32654a6d0ff3bebe697b2836c255f940" title="set a particular string property without fetching via a get hook, useful for notifies">setStringProperty</a>( kOfxImageEffectPropFieldToRender, field );
<a name="l01154"></a>01154         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxPropTime, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l01155"></a>01155         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a179cf4809adbc62771b7404e31ef69c9" title="set a particular double property">setIntPropertyN</a>( kOfxImageEffectPropRenderWindow, &amp;renderWindow.x1, 4 );
<a name="l01156"></a>01156         inArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a2bb46a5f5d914e0fae46ad75ef4a6ddf" title="get a particular double property">setDoublePropertyN</a>( kOfxImageEffectPropRenderScale, &amp;renderScale.x, 2 );
<a name="l01157"></a>01157 
<a name="l01158"></a>01158         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> outArgs( outStuff );
<a name="l01159"></a>01159 
<a name="l01160"></a>01160         outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxPropTime, <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> );
<a name="l01161"></a>01161 
<a name="l01162"></a>01162         OfxStatus status = mainEntry( kOfxImageEffectActionIsIdentity,
<a name="l01163"></a>01163                                       this-&gt;getHandle(),
<a name="l01164"></a>01164                                       &amp;inArgs,
<a name="l01165"></a>01165                                       &amp;outArgs );
<a name="l01166"></a>01166 
<a name="l01167"></a>01167         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l01168"></a>01168                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l01169"></a>01169 
<a name="l01170"></a>01170         <a class="code" href="../../dd/d00/namespacetuttle_1_1exception.html#a40155c671ace8c2604bcfc9cf7f5b1d5" title="Time.">time</a> = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( kOfxPropTime );
<a name="l01171"></a>01171         clip = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#ad3455a816a53f81c7382f2a755f9f2c5" title="get the value of a particular string property">getStringProperty</a>( kOfxPropName );
<a name="l01172"></a>01172 
<a name="l01173"></a>01173         <span class="keywordflow">return</span> status == kOfxStatOK;
<a name="l01174"></a>01174 }
<a name="l01175"></a>01175 <span class="comment"></span>
<a name="l01176"></a>01176 <span class="comment">/**</span>
<a name="l01177"></a>01177 <span class="comment"> * Get whether the component is a supported &#39;chromatic&#39; component (RGBA or alpha) in</span>
<a name="l01178"></a>01178 <span class="comment"> * the base API.</span>
<a name="l01179"></a>01179 <span class="comment"> * Override this if you have extended your chromatic colour types (eg RGB) and want</span>
<a name="l01180"></a>01180 <span class="comment"> * the clip preferences logic to still work</span>
<a name="l01181"></a>01181 <span class="comment"> */</span>
<a name="l01182"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a459575013565b82284cf686f42b7c670">01182</a> <span class="keywordtype">bool</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a459575013565b82284cf686f42b7c670">OfxhImageEffectNode::isChromaticComponent</a>( <span class="keyword">const</span> std::string&amp; str )<span class="keyword"> const</span>
<a name="l01183"></a>01183 <span class="keyword"></span>{
<a name="l01184"></a>01184         <span class="keywordflow">if</span>( str == kOfxImageComponentRGBA )
<a name="l01185"></a>01185                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01186"></a>01186         <span class="keywordflow">if</span>( str == kOfxImageComponentRGB )
<a name="l01187"></a>01187                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01188"></a>01188         <span class="keywordflow">if</span>( str == kOfxImageComponentAlpha )
<a name="l01189"></a>01189                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01190"></a>01190         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01191"></a>01191 }
<a name="l01192"></a>01192 <span class="comment"></span>
<a name="l01193"></a>01193 <span class="comment">/**</span>
<a name="l01194"></a>01194 <span class="comment"> * function to check for multiple bit depth support</span>
<a name="l01195"></a>01195 <span class="comment"> * The answer will depend on host, plugin and context</span>
<a name="l01196"></a>01196 <span class="comment"> */</span>
<a name="l01197"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aff6e4a2a95c82bc137c2bdc94115014d">01197</a> <span class="keywordtype">bool</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aff6e4a2a95c82bc137c2bdc94115014d">OfxhImageEffectNode::canCurrentlyHandleMultipleClipDepths</a>()<span class="keyword"> const</span>
<a name="l01198"></a>01198 <span class="keyword"></span>{<span class="comment"></span>
<a name="l01199"></a>01199 <span class="comment">        /// does the host support &#39;em</span>
<a name="l01200"></a>01200 <span class="comment"></span>        <span class="keywordtype">bool</span> hostSupports = <a class="code" href="../../d0/d0f/namespacetuttle_1_1host.html#a746fb95bca42f3df0271cb413f04804e">tuttle::host::core</a>().<a class="code" href="../../d2/d07/classtuttle_1_1host_1_1Core.html#a34488c40cba24a8df5b50bf411081da8">getHost</a>().<a class="code" href="../../dc/df2/classtuttle_1_1host_1_1ofx_1_1OfxhHost.html#a10892a114622bef4e2b5274723b53d50" title="get the props on this host">getProperties</a>().<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a93aa0eb3c85c46638935cd97331ed87f" title="get the value of a particular int property">getIntProperty</a>( kOfxImageEffectPropSupportsMultipleClipDepths ) != 0;
<a name="l01201"></a>01201 <span class="comment"></span>
<a name="l01202"></a>01202 <span class="comment">        /// does the plug-in support &#39;em</span>
<a name="l01203"></a>01203 <span class="comment"></span>        <span class="keywordtype">bool</span> pluginSupports = <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a16c1882860a2d436b5715138f410c7fe" title="does the effect support multiple clip depths">supportsMultipleClipDepths</a>();
<a name="l01204"></a>01204 <span class="comment"></span>
<a name="l01205"></a>01205 <span class="comment">        /// no support, so no</span>
<a name="l01206"></a>01206 <span class="comment"></span>        <span class="keywordflow">if</span>( !hostSupports || !pluginSupports )
<a name="l01207"></a>01207                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01208"></a>01208 
<a name="l01209"></a>01209         <span class="comment">// in the standard, it&#39;s written that only general context can handle multiple clip depth...</span>
<a name="l01210"></a>01210         <span class="comment">// but we remove this restriction for filters and generators (to allow input bitdepth != output bitdepth)</span>
<a name="l01211"></a>01211         <span class="comment">//      if( _context == kOfxImageEffectContextFilter || _context == kOfxImageEffectContextGenerator )</span>
<a name="l01212"></a>01212         <span class="comment">//              return false;</span>
<a name="l01213"></a>01213         <span class="keywordflow">if</span>(
<a name="l01214"></a>01214             <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextTransition ||
<a name="l01215"></a>01215             <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextPaint ||
<a name="l01216"></a>01216             <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5ab992dc966c2a47e7a5b7941c296c33">_context</a> == kOfxImageEffectContextRetimer )
<a name="l01217"></a>01217                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01218"></a>01218 
<a name="l01219"></a>01219         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01220"></a>01220 }
<a name="l01221"></a>01221 <span class="comment"></span>
<a name="l01222"></a>01222 <span class="comment">/**</span>
<a name="l01223"></a>01223 <span class="comment"> * Setup the default clip preferences on the clips</span>
<a name="l01224"></a>01224 <span class="comment"> */</span>
<a name="l01225"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a3ceb03aa1cda3f9bd6abef0a31a82f15">01225</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a3ceb03aa1cda3f9bd6abef0a31a82f15" title="Setup the default clip preferences on the clips.">OfxhImageEffectNode::setDefaultClipPreferences</a>()
<a name="l01226"></a>01226 {<span class="comment"></span>
<a name="l01227"></a>01227 <span class="comment">        /// is there multiple bit depth support? Depends on host, plugin and context</span>
<a name="l01228"></a>01228 <span class="comment"></span>        <span class="keywordtype">bool</span> multiBitDepth = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aff6e4a2a95c82bc137c2bdc94115014d">canCurrentlyHandleMultipleClipDepths</a>();
<a name="l01229"></a>01229 <span class="comment"></span>
<a name="l01230"></a>01230 <span class="comment">        /// OK find the deepest chromatic component on our input clips and the one with the</span>
<a name="l01231"></a>01231 <span class="comment">        /// most components</span>
<a name="l01232"></a>01232 <span class="comment"></span>        std::string deepestBitDepth = kOfxBitDepthNone;
<a name="l01233"></a>01233         std::string mostComponents  = kOfxImageComponentNone;
<a name="l01234"></a>01234         <span class="keywordtype">double</span> frameRate            = 0.0;
<a name="l01235"></a>01235         <span class="keywordtype">double</span> defaultPixelAspectRatio = 0.0;
<a name="l01236"></a>01236         std::string premult         = kOfxImageOpaque;
<a name="l01237"></a>01237 
<a name="l01238"></a>01238         <span class="keywordflow">for</span>( std::map&lt;std::string, attribute::OfxhClipImage*&gt;::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l01239"></a>01239              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l01240"></a>01240              it++ )
<a name="l01241"></a>01241         {
<a name="l01242"></a>01242                 <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>* clip = it-&gt;second;
<a name="l01243"></a>01243 
<a name="l01244"></a>01244                 <span class="comment">// If input clip</span>
<a name="l01245"></a>01245                 <span class="keywordflow">if</span>( !clip-&gt;<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() )
<a name="l01246"></a>01246                 {
<a name="l01247"></a>01247                         <span class="keywordflow">if</span>( clip-&gt;<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l01248"></a>01248                         {
<a name="l01249"></a>01249                                 frameRate = <a class="code" href="../../d9/dec/namespacetuttle_1_1ofx.html#ab863ae190c348e6e89a9868bfa51b063" title="get the max value">maximum</a>( frameRate, clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa86ef56c58f1997343fc68c26dd3e328">getFrameRate</a>() );
<a name="l01250"></a>01250                         }
<a name="l01251"></a>01251                         defaultPixelAspectRatio = <a class="code" href="../../d2/d7f/namespacetuttle.html#ae47d39ffbfd26c4920c2b25e8c0da3cc">std::max</a>( defaultPixelAspectRatio, clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa19baad5f5233a353400fb7b9a630d8e">getPixelAspectRatio</a>() );
<a name="l01252"></a>01252 
<a name="l01253"></a>01253                         std::string rawComp = clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a679ac6134382c9418e64102709cc46f7">getUnmappedComponents</a>();
<a name="l01254"></a>01254                         rawComp = clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a9a338ae670c5e2fd7e1c3f83d6c9a1b4" title="given the colour component, find the nearest set of supported colour components">findSupportedComp</a>( rawComp ); <span class="comment">// turn that into a comp the plugin expects on that clip</span>
<a name="l01255"></a>01255 
<a name="l01256"></a>01256                         <span class="keyword">const</span> std::string&amp; rawDepth   = clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa2fd8e028416be7722a21ee6b910f6a0">getUnmappedBitDepth</a>();
<a name="l01257"></a>01257                         <span class="keyword">const</span> std::string&amp; rawPreMult = clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a66aea213fabd9ccde502807015c3a8f7">getPremult</a>();
<a name="l01258"></a>01258 
<a name="l01259"></a>01259                         <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a459575013565b82284cf686f42b7c670">isChromaticComponent</a>( rawComp ) )
<a name="l01260"></a>01260                         {
<a name="l01261"></a>01261                                 <span class="keywordflow">if</span>( rawPreMult == kOfxImagePreMultiplied )
<a name="l01262"></a>01262                                         premult = kOfxImagePreMultiplied;
<a name="l01263"></a>01263                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rawPreMult == kOfxImageUnPreMultiplied &amp;&amp; premult != kOfxImagePreMultiplied )
<a name="l01264"></a>01264                                         premult = kOfxImageUnPreMultiplied;
<a name="l01265"></a>01265                                 deepestBitDepth = <a class="code" href="../../dd/d48/namespacetuttle_1_1ofx_1_1imageEffect.html#abf1fc85c8c7a5b066e29a43097a41291" title="turns a premultiplication string into and enum">findDeepestBitDepth</a>( deepestBitDepth, rawDepth );
<a name="l01266"></a>01266                                 mostComponents  = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#afc6a4857258c3423593779b3c7cc0a1b">findMostChromaticComponents</a>( mostComponents, rawComp );
<a name="l01267"></a>01267                         }
<a name="l01268"></a>01268                 }
<a name="l01269"></a>01269         }
<a name="l01270"></a>01270 
<a name="l01271"></a>01271         <span class="comment">// default value if the generator don&#39;t set the framerate</span>
<a name="l01272"></a>01272         <span class="keywordflow">if</span>( frameRate == 0.0 )
<a name="l01273"></a>01273                 frameRate = 25.0;
<a name="l01274"></a>01274         <span class="keywordflow">if</span>( defaultPixelAspectRatio == 0.0 )
<a name="l01275"></a>01275                 defaultPixelAspectRatio = 1.0;
<a name="l01276"></a>01276         <span class="comment"></span>
<a name="l01277"></a>01277 <span class="comment">        /// set some stuff up</span>
<a name="l01278"></a>01278 <span class="comment"></span>        <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a83273c27eb9841734d25dcfd60bc24db" title="set by clip prefs">_outputFrameRate</a>         = frameRate;
<a name="l01279"></a>01279         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a442ef3db155f438234020b4ea101a1d8" title="set by clip prefs">_outputFielding</a>          = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aefe8a925ab0f36defc729329a8438a94">getDefaultOutputFielding</a>();
<a name="l01280"></a>01280         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a134ed907ef9852c2d3e67d9f76552d84" title="set by clip prefs">_outputPreMultiplication</a> = premult;
<a name="l01281"></a>01281         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a8c8622eb94c55ec1f141be8340e386a4" title="set by clip prefs">_continuousSamples</a>       = <span class="keyword">false</span>;
<a name="l01282"></a>01282         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a980d2f582e89d0e2629ba31041df99df" title="set by clip prefs">_frameVarying</a>            = <span class="keyword">false</span>;
<a name="l01283"></a>01283         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a9a33579f26a474220c650678705e6a51">getOutputOfxhClip</a>().<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a287d29798be183b39be3257c6549cde0">setPixelAspectRatio</a>( defaultPixelAspectRatio, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a68bf16e0306494ab1e18f077ebde33b4a9e91cea1eba8824616a9d9abd01d8100">property::eModifiedByHost</a> );
<a name="l01284"></a>01284 <span class="comment"></span>
<a name="l01285"></a>01285 <span class="comment">        /// now find the best depth that the plugin supports</span>
<a name="l01286"></a>01286 <span class="comment"></span>        deepestBitDepth = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a39911bc83d36bc074752b9e77753bfca">bestSupportedBitDepth</a>( deepestBitDepth );
<a name="l01287"></a>01287 <span class="comment"></span>
<a name="l01288"></a>01288 <span class="comment">        /// now add the clip gubbins to the out args</span>
<a name="l01289"></a>01289 <span class="comment"></span>        <span class="keywordflow">for</span>( std::map&lt;std::string, attribute::OfxhClipImage*&gt;::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l01290"></a>01290              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l01291"></a>01291              ++it )
<a name="l01292"></a>01292         {
<a name="l01293"></a>01293                 <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>* clip = it-&gt;second;
<a name="l01294"></a>01294 
<a name="l01295"></a>01295                 std::string rawComp = clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a679ac6134382c9418e64102709cc46f7">getUnmappedComponents</a>();
<a name="l01296"></a>01296                 rawComp = clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a9a338ae670c5e2fd7e1c3f83d6c9a1b4" title="given the colour component, find the nearest set of supported colour components">findSupportedComp</a>( rawComp ); <span class="comment">// turn that into a comp the plugin expects on that clip</span>
<a name="l01297"></a>01297                 <span class="keyword">const</span> std::string&amp; rawDepth = clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa2fd8e028416be7722a21ee6b910f6a0">getUnmappedBitDepth</a>();
<a name="l01298"></a>01298                 <span class="keywordflow">if</span>( <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a459575013565b82284cf686f42b7c670">isChromaticComponent</a>( rawComp ) )
<a name="l01299"></a>01299                 {
<a name="l01300"></a>01300                         <span class="keywordflow">if</span>( clip-&gt;<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() )
<a name="l01301"></a>01301                         {
<a name="l01302"></a>01302                                 std::string depth = deepestBitDepth;
<a name="l01303"></a>01303                                 std::string comp  = clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a9a338ae670c5e2fd7e1c3f83d6c9a1b4" title="given the colour component, find the nearest set of supported colour components">findSupportedComp</a>( mostComponents );
<a name="l01304"></a>01304                                 clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aace82377ea87e56417a5ee27f0e05e2f">setBitDepthString</a>( depth );
<a name="l01305"></a>01305                                 clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa0c2672670656b55987c4e61dc4955be">setComponentsString</a>( comp );
<a name="l01306"></a>01306                         }
<a name="l01307"></a>01307                         <span class="keywordflow">else</span>
<a name="l01308"></a>01308                         {
<a name="l01309"></a>01309                                 std::string comp  = rawComp;
<a name="l01310"></a>01310                                 std::string depth = multiBitDepth ? <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a39911bc83d36bc074752b9e77753bfca">bestSupportedBitDepth</a>( rawDepth ) : deepestBitDepth;
<a name="l01311"></a>01311 
<a name="l01312"></a>01312                                 clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aace82377ea87e56417a5ee27f0e05e2f">setBitDepthString</a>( depth );
<a name="l01313"></a>01313                                 clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa0c2672670656b55987c4e61dc4955be">setComponentsString</a>( comp );
<a name="l01314"></a>01314                         }
<a name="l01315"></a>01315                 }
<a name="l01316"></a>01316                 <span class="keywordflow">else</span>
<a name="l01317"></a>01317                 {<span class="comment"></span>
<a name="l01318"></a>01318 <span class="comment">                        /// hmm custom component type, don&#39;t touch it and pass it through</span>
<a name="l01319"></a>01319 <span class="comment"></span>                        clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aace82377ea87e56417a5ee27f0e05e2f">setBitDepthString</a>( rawDepth );
<a name="l01320"></a>01320                         clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa0c2672670656b55987c4e61dc4955be">setComponentsString</a>( rawComp );
<a name="l01321"></a>01321                 }
<a name="l01322"></a>01322         }
<a name="l01323"></a>01323 }
<a name="l01324"></a>01324 <span class="comment"></span>
<a name="l01325"></a>01325 <span class="comment">/**</span>
<a name="l01326"></a>01326 <span class="comment"> * Initialise the clip preferences arguments, override this to do</span>
<a name="l01327"></a>01327 <span class="comment"> * stuff with wierd components etc...</span>
<a name="l01328"></a>01328 <span class="comment"> */</span>
<a name="l01329"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a598d1bb034efa7f19efb7fd1ee7cc83b">01329</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a598d1bb034efa7f19efb7fd1ee7cc83b">OfxhImageEffectNode::setupClipPreferencesArgs</a>( <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a>&amp; outArgs, std::list&lt;std::string&gt;&amp; outKeepPropNamesOwnership )
<a name="l01330"></a>01330 {
<a name="l01331"></a>01331         <span class="comment">// http://openfx.sourceforge.net/Documentation/1.3/ofxProgrammingReference.html#ImageEffectClipPreferences</span>
<a name="l01332"></a>01332         <span class="comment"></span>
<a name="l01333"></a>01333 <span class="comment">        /// reset all the clip prefs stuff to their defaults</span>
<a name="l01334"></a>01334 <span class="comment"></span>        <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a3ceb03aa1cda3f9bd6abef0a31a82f15" title="Setup the default clip preferences on the clips.">setDefaultClipPreferences</a>();
<a name="l01335"></a>01335 
<a name="l01336"></a>01336         <span class="keyword">static</span> <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> clipPrefsStuffs [] = {
<a name="l01337"></a>01337                 { kOfxImageEffectPropFrameRate, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;1&quot;</span> },
<a name="l01338"></a>01338                 { kOfxImageEffectPropPreMultiplication, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l01339"></a>01339                 { kOfxImageClipPropFieldOrder, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;&quot;</span> },
<a name="l01340"></a>01340                 { kOfxImageClipPropContinuousSamples, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad11c9ca0c013713d6c2bcc029586c61c">property::ePropTypeInt</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l01341"></a>01341                 { kOfxImageEffectFrameVarying, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad11c9ca0c013713d6c2bcc029586c61c">property::ePropTypeInt</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;0&quot;</span> },
<a name="l01342"></a>01342                 { 0 }
<a name="l01343"></a>01343         };
<a name="l01344"></a>01344 
<a name="l01345"></a>01345         outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#ae4f6e8aadabf45e1bf55dfced998989e" title="adds a bunch of properties from PropSpec">addProperties</a>( clipPrefsStuffs );
<a name="l01346"></a>01346 <span class="comment"></span>
<a name="l01347"></a>01347 <span class="comment">        /// set the default for those</span>
<a name="l01348"></a>01348 <span class="comment"></span><span class="comment"></span>
<a name="l01349"></a>01349 <span class="comment">        /// is there multiple bit depth support? Depends on host, plugin and context</span>
<a name="l01350"></a>01350 <span class="comment"></span>        <span class="keywordtype">bool</span> multiBitDepth = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aff6e4a2a95c82bc137c2bdc94115014d">canCurrentlyHandleMultipleClipDepths</a>();
<a name="l01351"></a>01351 
<a name="l01352"></a>01352         outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a32654a6d0ff3bebe697b2836c255f940" title="set a particular string property without fetching via a get hook, useful for notifies">setStringProperty</a>( kOfxImageClipPropFieldOrder, <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a442ef3db155f438234020b4ea101a1d8" title="set by clip prefs">_outputFielding</a> );
<a name="l01353"></a>01353         outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a32654a6d0ff3bebe697b2836c255f940" title="set a particular string property without fetching via a get hook, useful for notifies">setStringProperty</a>( kOfxImageEffectPropPreMultiplication, <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a134ed907ef9852c2d3e67d9f76552d84" title="set by clip prefs">_outputPreMultiplication</a> );
<a name="l01354"></a>01354         outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxImageEffectPropFrameRate, <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a83273c27eb9841734d25dcfd60bc24db" title="set by clip prefs">_outputFrameRate</a> );
<a name="l01355"></a>01355 <span class="comment"></span>
<a name="l01356"></a>01356 <span class="comment">        /// now add the clip gubbins to the out args</span>
<a name="l01357"></a>01357 <span class="comment"></span>        <span class="keywordflow">for</span>( std::map&lt;std::string, attribute::OfxhClipImage*&gt;::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l01358"></a>01358              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l01359"></a>01359              ++it )
<a name="l01360"></a>01360         {
<a name="l01361"></a>01361                 <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>* clip = it-&gt;second;
<a name="l01362"></a>01362 
<a name="l01363"></a>01363                 outKeepPropNamesOwnership.push_back( <span class="stringliteral">&quot;OfxImageClipPropComponents_&quot;</span> + it-&gt;first );
<a name="l01364"></a>01364                 <span class="keyword">const</span> std::string&amp; componentParamName = outKeepPropNamesOwnership.back();
<a name="l01365"></a>01365                 <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> specComp = { componentParamName.c_str(), <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 0, <span class="keyword">false</span>, <span class="stringliteral">&quot;&quot;</span> }; <span class="comment">// note the support for multi-planar clips</span>
<a name="l01366"></a>01366                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a6c87c959bb4175ec30daadfe0d44da11" title="add one new property">createProperty</a>( specComp );
<a name="l01367"></a>01367                 <span class="comment">// as it is variable dimension, there is no default value, so we have to set it explicitly</span>
<a name="l01368"></a>01368                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a32654a6d0ff3bebe697b2836c255f940" title="set a particular string property without fetching via a get hook, useful for notifies">setStringProperty</a>( componentParamName, clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a70eb90732a88e79264ba4db8967d1fe4">getComponentsString</a>() );
<a name="l01369"></a>01369 
<a name="l01370"></a>01370                 outKeepPropNamesOwnership.push_back( <span class="stringliteral">&quot;OfxImageClipPropDepth_&quot;</span> + it-&gt;first );
<a name="l01371"></a>01371                 <span class="keyword">const</span> std::string&amp; depthParamName = outKeepPropNamesOwnership.back();
<a name="l01372"></a>01372                 <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> specDep = { depthParamName.c_str(), <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38cad237b8fbeee2b78207ed6693749baca3">property::ePropTypeString</a>, 1, !multiBitDepth, clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#ac97ed9b44fdf6d037d688b61efce79f8" title="fetch depth of all chromatic component in this clip">getBitDepthString</a>().c_str() };
<a name="l01373"></a>01373                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a6c87c959bb4175ec30daadfe0d44da11" title="add one new property">createProperty</a>( specDep );
<a name="l01374"></a>01374                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a32654a6d0ff3bebe697b2836c255f940" title="set a particular string property without fetching via a get hook, useful for notifies">setStringProperty</a>( depthParamName, clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#ac97ed9b44fdf6d037d688b61efce79f8" title="fetch depth of all chromatic component in this clip">getBitDepthString</a>() );
<a name="l01375"></a>01375 
<a name="l01376"></a>01376                 outKeepPropNamesOwnership.push_back( <span class="stringliteral">&quot;OfxImageClipPropPAR_&quot;</span> + it-&gt;first );
<a name="l01377"></a>01377                 <span class="keyword">const</span> std::string&amp; parParamName = outKeepPropNamesOwnership.back();
<a name="l01378"></a>01378                 <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> specPAR = { parParamName.c_str(), <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 1, <span class="keyword">false</span>, <span class="stringliteral">&quot;1&quot;</span> };
<a name="l01379"></a>01379                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a6c87c959bb4175ec30daadfe0d44da11" title="add one new property">createProperty</a>( specPAR );
<a name="l01380"></a>01380                 outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( parParamName, clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa19baad5f5233a353400fb7b9a630d8e">getPixelAspectRatio</a>() );
<a name="l01381"></a>01381         }
<a name="l01382"></a>01382 }
<a name="l01383"></a>01383 
<a name="l01384"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a70ada223da0263d28e223aea24755c5e">01384</a> <span class="keywordtype">bool</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a70ada223da0263d28e223aea24755c5e" title="Check if the node is a leaf in the graph. If there is no input clip connected.">OfxhImageEffectNode::isLeafNode</a>()<span class="keyword"> const</span>
<a name="l01385"></a>01385 <span class="keyword"></span>{
<a name="l01386"></a>01386         <span class="keywordflow">for</span>( ClipImageMap::const_iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l01387"></a>01387              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l01388"></a>01388              ++it )
<a name="l01389"></a>01389         {
<a name="l01390"></a>01390                 <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>* clip = it-&gt;second;
<a name="l01391"></a>01391 
<a name="l01392"></a>01392                 <span class="keywordflow">if</span>( ! clip-&gt;<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a9a7f6fa9ba00352e303f162f11ca6540" title="is the clip an output clip">isOutput</a>() &amp;&amp; clip-&gt;<a class="code" href="../../dd/dc2/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipAccessor.html#a4cfa0f7d859e260cb216c8b3745fe749">isConnected</a>() )
<a name="l01393"></a>01393                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01394"></a>01394         }
<a name="l01395"></a>01395         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01396"></a>01396 }
<a name="l01397"></a>01397 
<a name="l01398"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#acb547ddb883decd09c014a36cef90a70">01398</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#acb547ddb883decd09c014a36cef90a70" title="Setup the default host clip instance members data retrieved from the plugin instance.">OfxhImageEffectNode::setupClipInstancePreferences</a>( <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a>&amp; outArgs )
<a name="l01399"></a>01399 {
<a name="l01400"></a>01400         <span class="keyword">const</span> <span class="keywordtype">bool</span> isLeaf = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a70ada223da0263d28e223aea24755c5e" title="Check if the node is a leaf in the graph. If there is no input clip connected.">isLeafNode</a>();
<a name="l01401"></a>01401 
<a name="l01402"></a>01402         <span class="keywordflow">for</span>( ClipImageMap::iterator it = <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.begin();
<a name="l01403"></a>01403              it != <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a626f59436e2bb92d4e0fcae693faa902" title="clips by name (link to datas)">_clipImages</a>.end();
<a name="l01404"></a>01404              ++it )
<a name="l01405"></a>01405         {
<a name="l01406"></a>01406                 <a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html" title="a clip image instance">attribute::OfxhClipImage</a>* clip = it-&gt;second;
<a name="l01407"></a>01407 
<a name="l01408"></a>01408                 <span class="comment">// Properties setup</span>
<a name="l01409"></a>01409                 <span class="keyword">const</span> std::string componentParamName = <span class="stringliteral">&quot;OfxImageClipPropComponents_&quot;</span> + it-&gt;first;
<a name="l01410"></a>01410                 <span class="keyword">const</span> std::string depthParamName     = <span class="stringliteral">&quot;OfxImageClipPropDepth_&quot;</span> + it-&gt;first;
<a name="l01411"></a>01411                 <span class="keyword">const</span> std::string parParamName       = <span class="stringliteral">&quot;OfxImageClipPropPAR_&quot;</span> + it-&gt;first;
<a name="l01412"></a>01412 
<a name="l01413"></a>01413                 <span class="keyword">const</span> <a class="code" href="../../d6/d97/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropertyTemplate.html">property::String</a>&amp; propPixelDepth = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a9f3fd29a1648cbf77bd0b69c79ac986c">fetchStringProperty</a>( depthParamName );
<a name="l01414"></a>01414                 clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aace82377ea87e56417a5ee27f0e05e2f">setBitDepthString</a>( propPixelDepth.<a class="code" href="../../d6/d97/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropertyTemplate.html#a006edf3a21375c275737ee0741ff0f3b" title="get one value">getValue</a>(), propPixelDepth.<a class="code" href="../../db/d1f/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhProperty.html#a6809028d595604d9f069606823858ac3">getModifiedBy</a>() );
<a name="l01415"></a>01415 
<a name="l01416"></a>01416                 <span class="keyword">const</span> <a class="code" href="../../d6/d97/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropertyTemplate.html">property::String</a>&amp; propComponent = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a9f3fd29a1648cbf77bd0b69c79ac986c">fetchStringProperty</a>( componentParamName );
<a name="l01417"></a>01417                 clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aa0c2672670656b55987c4e61dc4955be">setComponentsString</a>( propComponent.<a class="code" href="../../d6/d97/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropertyTemplate.html#a006edf3a21375c275737ee0741ff0f3b" title="get one value">getValue</a>(), propComponent.<a class="code" href="../../db/d1f/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhProperty.html#a6809028d595604d9f069606823858ac3">getModifiedBy</a>() );
<a name="l01418"></a>01418 
<a name="l01419"></a>01419                 <span class="keyword">const</span> <a class="code" href="../../d6/d97/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropertyTemplate.html">property::Double</a>&amp; propPixelAspectRatio = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#ab79329b75a6959cf5b2aaf2c3beda698">fetchDoubleProperty</a>( parParamName );
<a name="l01420"></a>01420                 clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#a287d29798be183b39be3257c6549cde0">setPixelAspectRatio</a>( propPixelAspectRatio.<a class="code" href="../../d6/d97/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropertyTemplate.html#a006edf3a21375c275737ee0741ff0f3b" title="get one value">getValue</a>(), propPixelAspectRatio.<a class="code" href="../../db/d1f/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhProperty.html#a6809028d595604d9f069606823858ac3">getModifiedBy</a>() );
<a name="l01421"></a>01421 
<a name="l01422"></a>01422                 <span class="keywordflow">if</span>( isLeaf &amp;&amp;
<a name="l01423"></a>01423                         it-&gt;first == kOfxImageEffectOutputClipName &amp;&amp;
<a name="l01424"></a>01424                         propPixelDepth.<a class="code" href="../../db/d1f/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhProperty.html#a6809028d595604d9f069606823858ac3">getModifiedBy</a>() != <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a68bf16e0306494ab1e18f077ebde33b4ac94bcb010e2d6c3f0d10cae41edfff26">property::eModifiedByPlugin</a> &amp;&amp;
<a name="l01425"></a>01425                         propPixelDepth.<a class="code" href="../../d6/d97/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropertyTemplate.html#a006edf3a21375c275737ee0741ff0f3b" title="get one value">getValue</a>() == kOfxBitDepthNone
<a name="l01426"></a>01426                   )
<a name="l01427"></a>01427                 {
<a name="l01428"></a>01428                         <span class="comment">// If a generator node (even if declared in the general context) don&#39;t set the</span>
<a name="l01429"></a>01429                         <span class="comment">// bitdepth... we set an arbitrary default value.</span>
<a name="l01430"></a>01430                         clip-&gt;<a class="code" href="../../d1/dab/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImage.html#aace82377ea87e56417a5ee27f0e05e2f">setBitDepthString</a>( kOfxBitDepthFloat, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a68bf16e0306494ab1e18f077ebde33b4a9e91cea1eba8824616a9d9abd01d8100">property::eModifiedByHost</a> );
<a name="l01431"></a>01431                 }
<a name="l01432"></a>01432         }
<a name="l01433"></a>01433         
<a name="l01434"></a>01434         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a83273c27eb9841734d25dcfd60bc24db" title="set by clip prefs">_outputFrameRate</a>         = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( kOfxImageEffectPropFrameRate );
<a name="l01435"></a>01435         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a442ef3db155f438234020b4ea101a1d8" title="set by clip prefs">_outputFielding</a>          = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#ad3455a816a53f81c7382f2a755f9f2c5" title="get the value of a particular string property">getStringProperty</a>( kOfxImageClipPropFieldOrder );
<a name="l01436"></a>01436         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a134ed907ef9852c2d3e67d9f76552d84" title="set by clip prefs">_outputPreMultiplication</a> = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#ad3455a816a53f81c7382f2a755f9f2c5" title="get the value of a particular string property">getStringProperty</a>( kOfxImageEffectPropPreMultiplication );
<a name="l01437"></a>01437         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a8c8622eb94c55ec1f141be8340e386a4" title="set by clip prefs">_continuousSamples</a>       = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a93aa0eb3c85c46638935cd97331ed87f" title="get the value of a particular int property">getIntProperty</a>( kOfxImageClipPropContinuousSamples ) != 0;
<a name="l01438"></a>01438         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a980d2f582e89d0e2629ba31041df99df" title="set by clip prefs">_frameVarying</a>            = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a93aa0eb3c85c46638935cd97331ed87f" title="get the value of a particular int property">getIntProperty</a>( kOfxImageEffectFrameVarying ) != 0;
<a name="l01439"></a>01439 }
<a name="l01440"></a>01440 <span class="comment"></span>
<a name="l01441"></a>01441 <span class="comment">/**</span>
<a name="l01442"></a>01442 <span class="comment"> * the idea here is the clip prefs live as active props on the effect</span>
<a name="l01443"></a>01443 <span class="comment"> * and are set up by clip preferences. The action manages the clip</span>
<a name="l01444"></a>01444 <span class="comment"> * preferences bits. We also monitor clip and param changes and</span>
<a name="l01445"></a>01445 <span class="comment"> * flag when clip prefs is dirty.</span>
<a name="l01446"></a>01446 <span class="comment"> * call the clip preferences action</span>
<a name="l01447"></a>01447 <span class="comment"> */</span>
<a name="l01448"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#abfda6e346e828bba376a072e9d66d075">01448</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#abfda6e346e828bba376a072e9d66d075">OfxhImageEffectNode::getClipPreferencesAction</a>() <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l01449"></a>01449 {<span class="comment"></span>
<a name="l01450"></a>01450 <span class="comment">        /// create the out args with the stuff that does not depend on individual clips</span>
<a name="l01451"></a>01451 <span class="comment"></span>        <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> outArgs;
<a name="l01452"></a>01452         std::list&lt;std::string&gt; keepPropNamesOwnership;
<a name="l01453"></a>01453 
<a name="l01454"></a>01454         
<a name="l01455"></a>01455         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a598d1bb034efa7f19efb7fd1ee7cc83b">setupClipPreferencesArgs</a>( outArgs, keepPropNamesOwnership );
<a name="l01456"></a>01456 
<a name="l01457"></a>01457         <span class="keyword">const</span> OfxStatus status = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a708164924c07c6be4497abf6a041d26e" title="call the effect entry point">mainEntry</a>( kOfxImageEffectActionGetClipPreferences,
<a name="l01458"></a>01458                                       this-&gt;<a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#ad6367e1a19cd55a662af140aaadb1eff" title="obtain a handle on this for passing to the C api">getHandle</a>(),
<a name="l01459"></a>01459                                       0,
<a name="l01460"></a>01460                                       &amp;outArgs );
<a name="l01461"></a>01461 
<a name="l01462"></a>01462         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp;
<a name="l01463"></a>01463             status != kOfxStatReplyDefault )
<a name="l01464"></a>01464         {
<a name="l01465"></a>01465                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l01466"></a>01466         }
<a name="l01467"></a>01467         
<a name="l01468"></a>01468         <span class="comment">// Setup members data from loaded properties</span>
<a name="l01469"></a>01469         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#acb547ddb883decd09c014a36cef90a70" title="Setup the default host clip instance members data retrieved from the plugin instance.">setupClipInstancePreferences</a>( outArgs );
<a name="l01470"></a>01470 
<a name="l01471"></a>01471         <a class="code" href="../../d5/d4f/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhClipImageSet.html#a8b99cf7d6754d9d2999b4ff9bbb33d67" title="do we need to re-run the clip prefs action">_clipPrefsDirty</a> = <span class="keyword">false</span>;
<a name="l01472"></a>01472 }
<a name="l01473"></a>01473 <span class="comment"></span>
<a name="l01474"></a>01474 <span class="comment">/**</span>
<a name="l01475"></a>01475 <span class="comment"> * find the most chromatic components out of the two. Override this if you define</span>
<a name="l01476"></a>01476 <span class="comment"> * more chromatic components</span>
<a name="l01477"></a>01477 <span class="comment"> */</span>
<a name="l01478"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#afc6a4857258c3423593779b3c7cc0a1b">01478</a> <span class="keyword">const</span> std::string&amp; <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#afc6a4857258c3423593779b3c7cc0a1b">OfxhImageEffectNode::findMostChromaticComponents</a>( <span class="keyword">const</span> std::string&amp; a, <span class="keyword">const</span> std::string&amp; b )<span class="keyword"> const</span>
<a name="l01479"></a>01479 <span class="keyword"></span>{
<a name="l01480"></a>01480         <span class="keywordflow">if</span>( a == kOfxImageComponentNone )
<a name="l01481"></a>01481                 <span class="keywordflow">return</span> b;
<a name="l01482"></a>01482         <span class="keywordflow">if</span>( a == kOfxImageComponentRGBA )
<a name="l01483"></a>01483                 <span class="keywordflow">return</span> a;
<a name="l01484"></a>01484         <span class="keywordflow">if</span>( b == kOfxImageComponentRGBA )
<a name="l01485"></a>01485                 <span class="keywordflow">return</span> b;
<a name="l01486"></a>01486         <span class="keywordflow">if</span>( a == kOfxImageComponentRGB )
<a name="l01487"></a>01487                 <span class="keywordflow">return</span> a;
<a name="l01488"></a>01488         <span class="keywordflow">if</span>( b == kOfxImageComponentRGB )
<a name="l01489"></a>01489                 <span class="keywordflow">return</span> b;
<a name="l01490"></a>01490         <span class="keywordflow">return</span> a;
<a name="l01491"></a>01491 }
<a name="l01492"></a>01492 <span class="comment"></span>
<a name="l01493"></a>01493 <span class="comment">/**</span>
<a name="l01494"></a>01494 <span class="comment"> * given the bit depth, find the best match for it.</span>
<a name="l01495"></a>01495 <span class="comment"> */</span>
<a name="l01496"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a39911bc83d36bc074752b9e77753bfca">01496</a> <span class="keyword">const</span> std::string&amp; <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a39911bc83d36bc074752b9e77753bfca">OfxhImageEffectNode::bestSupportedBitDepth</a>( <span class="keyword">const</span> std::string&amp; depth )<span class="keyword"> const</span>
<a name="l01497"></a>01497 <span class="keyword"></span>{
<a name="l01498"></a>01498         <span class="keyword">static</span> <span class="keyword">const</span> std::string none( kOfxBitDepthNone );
<a name="l01499"></a>01499         <span class="keyword">static</span> <span class="keyword">const</span> std::string bytes( kOfxBitDepthByte );
<a name="l01500"></a>01500         <span class="keyword">static</span> <span class="keyword">const</span> std::string shorts( kOfxBitDepthShort );
<a name="l01501"></a>01501         <span class="keyword">static</span> <span class="keyword">const</span> std::string floats( kOfxBitDepthFloat );
<a name="l01502"></a>01502 
<a name="l01503"></a>01503         <span class="keywordflow">if</span>( depth == none )
<a name="l01504"></a>01504                 <span class="keywordflow">return</span> none;
<a name="l01505"></a>01505 
<a name="l01506"></a>01506         <span class="keywordflow">if</span>( <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6be9826e09ac36f0f7e1d20dcde8aec6" title="is the given bit depth supported by the effect">isBitDepthSupported</a>( depth ) )
<a name="l01507"></a>01507                 <span class="keywordflow">return</span> depth;
<a name="l01508"></a>01508 
<a name="l01509"></a>01509         <span class="keywordflow">if</span>( depth == floats )
<a name="l01510"></a>01510         {
<a name="l01511"></a>01511                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6be9826e09ac36f0f7e1d20dcde8aec6" title="is the given bit depth supported by the effect">isBitDepthSupported</a>( shorts ) )
<a name="l01512"></a>01512                         <span class="keywordflow">return</span> shorts;
<a name="l01513"></a>01513                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6be9826e09ac36f0f7e1d20dcde8aec6" title="is the given bit depth supported by the effect">isBitDepthSupported</a>( bytes ) )
<a name="l01514"></a>01514                         <span class="keywordflow">return</span> bytes;
<a name="l01515"></a>01515         }
<a name="l01516"></a>01516 
<a name="l01517"></a>01517         <span class="keywordflow">if</span>( depth == shorts )
<a name="l01518"></a>01518         {
<a name="l01519"></a>01519                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6be9826e09ac36f0f7e1d20dcde8aec6" title="is the given bit depth supported by the effect">isBitDepthSupported</a>( floats ) )
<a name="l01520"></a>01520                         <span class="keywordflow">return</span> floats;
<a name="l01521"></a>01521                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6be9826e09ac36f0f7e1d20dcde8aec6" title="is the given bit depth supported by the effect">isBitDepthSupported</a>( bytes ) )
<a name="l01522"></a>01522                         <span class="keywordflow">return</span> bytes;
<a name="l01523"></a>01523         }
<a name="l01524"></a>01524 
<a name="l01525"></a>01525         <span class="keywordflow">if</span>( depth == bytes )
<a name="l01526"></a>01526         {
<a name="l01527"></a>01527                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6be9826e09ac36f0f7e1d20dcde8aec6" title="is the given bit depth supported by the effect">isBitDepthSupported</a>( shorts ) )
<a name="l01528"></a>01528                         <span class="keywordflow">return</span> shorts;
<a name="l01529"></a>01529                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d1e/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNodeBase.html#a6be9826e09ac36f0f7e1d20dcde8aec6" title="is the given bit depth supported by the effect">isBitDepthSupported</a>( floats ) )
<a name="l01530"></a>01530                         <span class="keywordflow">return</span> floats;
<a name="l01531"></a>01531         }
<a name="l01532"></a>01532 <span class="comment"></span>
<a name="l01533"></a>01533 <span class="comment">        /// Something wrong here</span>
<a name="l01534"></a>01534 <span class="comment"></span>        <span class="keywordflow">return</span> none;
<a name="l01535"></a>01535 }
<a name="l01536"></a>01536 
<a name="l01537"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a90b0bed9f73b8938a4a0ef68c1ec4d7d">01537</a> <span class="keywordtype">bool</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a90b0bed9f73b8938a4a0ef68c1ec4d7d">OfxhImageEffectNode::getTimeDomainAction</a>( OfxRangeD&amp; range ) <span class="keyword">const</span> <a class="code" href="../../d3/d48/OfxhException_8hpp.html#af367a5d20cfc8c242d69a179a75a855a">OFX_EXCEPTION_SPEC</a>
<a name="l01538"></a>01538 {
<a name="l01539"></a>01539         <a class="code" href="../../d9/d5c/structtuttle_1_1host_1_1ofx_1_1property_1_1OfxhPropSpec.html">property::OfxhPropSpec</a> outStuff[] = {
<a name="l01540"></a>01540                 { kOfxImageEffectPropFrameRange, <a class="code" href="../../dc/dd4/namespacetuttle_1_1host_1_1ofx_1_1property.html#a722394f10411a6e1ebf7c1e3668eb38ca50441aacb0b2b82c93353444753d980f">property::ePropTypeDouble</a>, 2, <span class="keyword">false</span>, <span class="stringliteral">&quot;0.0&quot;</span> },
<a name="l01541"></a>01541                 { 0 }
<a name="l01542"></a>01542         };
<a name="l01543"></a>01543 
<a name="l01544"></a>01544         <a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html">property::OfxhSet</a> outArgs( outStuff );
<a name="l01545"></a>01545         outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxImageEffectPropFrameRange, range.min, 0 );
<a name="l01546"></a>01546         outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#a0531611320fc76e6fbe1dab5658b2cec" title="get a particular double property">setDoubleProperty</a>( kOfxImageEffectPropFrameRange, range.max, 1 );
<a name="l01547"></a>01547 
<a name="l01548"></a>01548         OfxStatus status = mainEntry( kOfxImageEffectActionGetTimeDomain,
<a name="l01549"></a>01549                                       this-&gt;getHandle(),
<a name="l01550"></a>01550                                       0,
<a name="l01551"></a>01551                                       &amp;outArgs );
<a name="l01552"></a>01552 
<a name="l01553"></a>01553         <span class="keywordflow">if</span>( status != kOfxStatOK &amp;&amp; status != kOfxStatReplyDefault )
<a name="l01554"></a>01554                 BOOST_THROW_EXCEPTION( <a class="code" href="../../d3/d6a/classtuttle_1_1host_1_1ofx_1_1OfxhException.html">OfxhException</a>( status ) );
<a name="l01555"></a>01555 
<a name="l01556"></a>01556         range.min = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( kOfxImageEffectPropFrameRange, 0 );
<a name="l01557"></a>01557         range.max = outArgs.<a class="code" href="../../db/dc8/classtuttle_1_1host_1_1ofx_1_1property_1_1OfxhSet.html#afc064add87802be3add9630ae70e7b7c" title="get the value of a particular double property">getDoubleProperty</a>( kOfxImageEffectPropFrameRange, 1 );
<a name="l01558"></a>01558 
<a name="l01559"></a>01559         <span class="keywordflow">if</span>( status == kOfxStatOK )
<a name="l01560"></a>01560                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01561"></a>01561 
<a name="l01562"></a>01562         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01563"></a>01563 }
<a name="l01564"></a>01564 <span class="comment"></span>
<a name="l01565"></a>01565 <span class="comment">/**</span>
<a name="l01566"></a>01566 <span class="comment"> * implemented for Param::SetInstance</span>
<a name="l01567"></a>01567 <span class="comment"> */</span>
<a name="l01568"></a><a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a9a1ac5714ef13ea73d3d4b0d6123d2ad">01568</a> <span class="keywordtype">void</span> <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a9a1ac5714ef13ea73d3d4b0d6123d2ad" title="implemented for Param::SetInstance">OfxhImageEffectNode::paramChanged</a>( <span class="keyword">const</span> <a class="code" href="../../d1/dfc/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhParam.html" title="plugin parameter instance">attribute::OfxhParam</a>&amp; param, <span class="keyword">const</span> <a class="code" href="../../d2/dd3/namespacetuttle_1_1host_1_1ofx_1_1attribute.html#a5565adead66902f779cd9fd58f896e6b">attribute::EChange</a> change )
<a name="l01569"></a>01569 {
<a name="l01570"></a>01570         <span class="keywordflow">if</span>( change == <a class="code" href="../../d2/dd3/namespacetuttle_1_1host_1_1ofx_1_1attribute.html#a5565adead66902f779cd9fd58f896e6ba191bfc548fdef9891c45e487260dd7d2">attribute::eChangeNone</a> )
<a name="l01571"></a>01571                 <span class="keywordflow">return</span>;
<a name="l01572"></a>01572 
<a name="l01573"></a>01573         <span class="keyword">const</span> std::string changeStr = <a class="code" href="../../d2/dd3/namespacetuttle_1_1host_1_1ofx_1_1attribute.html#af167b73e6cf3c3c8b7c2d0bba43c093d">attribute::mapChangeEnumToString</a>( change );
<a name="l01574"></a>01574         <span class="keyword">const</span> <span class="keywordtype">double</span> frame          = <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#aebfb77fb0222533643a6f2acb9f038de">getFrameRecursive</a>();
<a name="l01575"></a>01575         OfxPointD renderScale;
<a name="l01576"></a>01576 
<a name="l01577"></a>01577         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a70b2f80985de084f4cf4f7afc495ea99">getRenderScaleRecursive</a>( renderScale.x, renderScale.y );
<a name="l01578"></a>01578 
<a name="l01579"></a>01579         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a0e74ac40373eebd8fdf70609836e9ab7">beginInstanceChangedAction</a>( changeStr );
<a name="l01580"></a>01580         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a580416c50bf369c9a220a41010b64f40">paramInstanceChangedAction</a>( param.<a class="code" href="../../d1/dbd/classtuttle_1_1host_1_1ofx_1_1attribute_1_1OfxhAttributeAccessor.html#a5dd0b6a71e059db4f3eaa1bf23b208d8">getName</a>(), changeStr, frame, renderScale );
<a name="l01581"></a>01581         <a class="code" href="../../de/d55/classtuttle_1_1host_1_1ofx_1_1imageEffect_1_1OfxhImageEffectNode.html#a5211ad5d7906840efc77a08908066f7d">endInstanceChangedAction</a>( changeStr );
<a name="l01582"></a>01582 }
<a name="l01583"></a>01583 
<a name="l01584"></a>01584 }
<a name="l01585"></a>01585 }
<a name="l01586"></a>01586 }
<a name="l01587"></a>01587 }
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../dc/d91/OfxhImageEffectNode_8cpp.html">OfxhImageEffectNode.cpp</a>      </li>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
